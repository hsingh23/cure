{% load static %}
<html>
<head>
</head>
<body>
<script type="text/javascript" src="/static/js/formatjson.js"></script>
{% if test_form %}
<p>Choose a method and a database to get example json. Press enter to run your json.</p>

	<form action="/test/" method="post">
		<textarea id="input" name="q" cols="80" rows ="30" wrap="virtual"></textarea>
		<input type="submit" value="enter">
	</form>
	<select id="functions" onchange="setText()">
	<option value=-1 selected="selected">-----</option>
	<option value=0>create</option>
	<option value=1>change</option>
	<option value=2>get</option>
	<option value=3>get_history</option>
	<option value=4>search</option>
	<option value=5>search_history</option>
	<option value=6>revert</option>
	<option value=7>remove</option>
	</select>
	<select id="databases" onchange="setText()">
	<option value=-1 selected="selected">-----</option>
	<option value=0>Person</option>
	<option value=1>Column</option>
	<option value=2>Group</option>
	<option value=3>Cell</option>
	<option value=4>Course</option>
	<option value=5>Section</option>
	<option value=6>Person Tag</option>
	<option value=7>Column Tag</option>
	</select>

	<script type="text/javascript">

	<!--TODO: add other example json blobs and their buttons.-->
	var example_JSON = new Array()
	for(var i=0; i<8; i++){
		example_JSON.push([{},{},{},{},{},{},{},{}])
	}

	example_JSON[0][0] = {
		"method": "create",
		"table": "Person",
		"id": 1,
		"params": [
			{
				"netid": "zfrank1",
				"group": "Student",
				"first_name": "Ze",
				"last_name": "Frank",
				"person_tags": ["awesome"],
				"sections": ["AL2", "AD5"]
			},
			{
				"netid": "zfrank2",
				"group": "Student",
				"sections": ["AL1", "AD5"]
			},
			{
				"netid": "zinstr3",
				"group": "Instructor",
				"first_name": "Ze",
				"last_name": "Instr",
				"uin": 987654321,
				"person_tags": ["staff", "awesome"]
			}
		]
	};
	example_JSON[0][1] = {
		"method": "create",
		"table": "Column",
		"id": 2,
		"params": [
			{
				"name": "problem 1",
				"out_of": 100,
				"column_tags": ["hw", "fun"],
				"read_access": ["Instructor"],
				"write_access": ["Instructor"]
			},
			{
				"name": "problem 2",
				"out_of": 100,
				"column_tags": ["hw"],
				"read_access": ["Instructor"],
				"write_access": ["Instructor"]
			},
			{
				"name": "Lab 1",
				"out_of": 25,
				"column_tags": ["lab", "fun", "linked list"],
				"read_access": ["Student", "Instructor"],
				"write_access": ["Instructor"]
			},
			{
				"name": "Lab 2",
				"out_of": 25,
				"column_tags": ["lab"],
				"read_access": ["Student", "Instructor"],
				"write_access": ["Instructor"]
			}
		]
	};

	example_JSON[0][2] = {
		"method": "create",
		"table": "Group",
		"id": 1,
		"params": [
			{
				"name": "Student"
			},
			{
				"name": "TA",
				"person_access": true,
				"column_access": true,
				"group_access": false
			},
			{
				"name": "Instructor",
				"person_access": true,
				"column_access": true,
				"group_access": true
			}
		]
	};

	example_JSON[0][3] = {
		"method": "create",
		"table": "Cell",
		"id": 2,
		"params": [
			{
				"score": 87,
				"column": "problem 1",
				"person": "zfrank1",
			},
			{
				"score": 100,
				"column": "problem 1",
				"person": "zfrank2",

			},
			{
				"score": 94,
				"column": "Lab 1",
				"person": "zfrank1",

			},
			{
				"score": 83,
				"column": "Lab 2",
				"person": "zfrank2",

			}
		]
	};

	example_JSON[0][4] = {
		"method": "create",
		"table": "Course",
		"id": 3,
		"params": [
			{
				"handle": 0,
				"course_name": "CS225",
				"semester": "Summer 2012"
			}
		]
	};

	example_JSON[0][5] = {
		"method": "create",
		"table": "Section",
		"id": 2,
		"params": [
			{
				"name": "AD4"
			},
			{
				"name": "AL2"
			},
			{
				"name": "AD1"
			}
		]
	};

	example_JSON[0][6] = {
		"method": "create",
		"table": "Person_Tag",
		"id": 1,
		"params": [
			{
				"name": "awesome"
			},
			{
				"name": "staff"
			}
		]
	};

	example_JSON[0][7] = {
		"method": "create",
		"table": "Column_Tag",
		"id": 2,
		"params": [
			{
				"name": "fun",
			},
			{
				"name": "hw"
			}
		]
	};

	example_JSON[1][0] = {
		"method": "change",
		"table": "Person",
		"id": 1,
		"params": [
			{
				"identifiers": {
					"netid": "zfrank1"
				},
				"specific_changes": {
					"enrolled": false
				}
			},
			{
				"identifiers": {
					"netid": "zfrank2"
				},
				"specific_changes": {
					"first_name": "Ze",
					"last_name": "Frankle",
					"sections": ["AL1", "AD4"],
					"uin": 132435465
				}
			}
		]
	};

	example_JSON[1][1] = {
		"method": "change",
		"table": "Column",
		"id": 1,
		"params": [
			{
				"identifiers": {
					"name": "problem 1"
				},
				"specific_changes": {
					"out_of": 50,
				}
			},
			{
				"identifiers": {
					"name": "Lab 1"
				},
				"specific_changes": {
					"column_tags": ["hw"]
				}
			}
		]
	};

	example_JSON[1][2] = {
		"method": "change",
		"table": "Group",
		"id": 1,
		"params": [
			{
				"identifiers": {
					"name": "Instructor"
				},
				"specific_changes": {
					"name": "Instructor"
				}
			},
			{
				"identifiers": {
					"name": "Student"
				},
				"specific_changes": {
					"name": "Student"
				}
			}
		]
	};

	example_JSON[1][3] = {
		"method": "change",
		"table": "Cell",
		"id": 3,
		"params": [
			{
				"identifiers": {
					"column": "problem 1",
					"person": "zfrank1"
				},
				"specific_changes": {
					"score": 94,
				}
			}
		]
	};

	example_JSON[2][0] = {
		"method": "get",
		"table": "Person",
		"id": 1,
		"params": [
			{
				"netid": "zfrank1"
			},
			{
				"netid": "zfrank2"
			},
			{
				"netid": "zinstr3"
			}
		]
	};

	example_JSON[2][1] = {
		"method": "get",
		"table": "Column",
		"id": 1,
		"params": [
			{
				"name": "problem 1"
			},
			{
				"name": "Lab 1"
			}
		]
	};

	example_JSON[2][2] = {
		"method": "get",
		"table": "Group",
		"id": 1,
		"params": [
			{
				"name": "Student"
			},
			{
				"name": "Instructor"
			}
		]
	};

	example_JSON[2][3] = {
		"method": "get",
		"table": "Cell",
		"id": 1,
		"params": [
			{
				"column": "problem 1",
				"person": "zfrank1"
			}
		]
	};
	example_JSON[3][0] = {
		"method": "get_history",
		"table": "Person",
		"id": 1,
		"params": [
		        {
		            "netid": "zfrank1"
		        },
		        {
		            "netid": "zfrank2"
		        },
		        {
		            "netid": "zinstr3"
			}
		]
	};

	example_JSON[3][1] = {
		"method": "get_history",
		"table": "Column",
		"id": 1,
		"params": [
			{
				"name": "problem 1"
			},
			{
				"name": "Lab 1"
			}
		]
	};
	example_JSON[3][3] = {
		"method": "get_history",
		"table": "Cell",
		"id": 1,
		"params": [
			{
				"person": "zfrank1",
				"column": "problem 1"
			},
			{
				"person": "zfrank1",
				"column": "Lab 1"
			},
			{
				"person": "zfrank2",
				"column": "problem 1"
			}
		]
	};
	example_JSON[4][0] = {
		"method": "search",
		"table": "Person",
		"id": 1,
		"params": {
			"enrolled": true,
			"sections": ["AD5"]
		}
	};

	example_JSON[4][1] = {
		"method": "search",
		"table": "Column",
		"id": 1,
		"params": {
			"column_tags": ["lab", "hw"]
		}
	};
    
	example_JSON[4][2] = {
		"method": "search",
		"table": "Group",
		"id": 1,
		"params": {
			"name": "Student"
		}
	};
    
	example_JSON[4][3] = {
		"method": "search",
		"table": "Cell",
		"id": 1,
		"params": {
			"score": "87"
		}
	};

   	 example_JSON[4][6] = {
    		"method": "search",
    		"table": "Person_Tag",
		"id": 1,
    		"params": {
			
    		}
   	 };

    	example_JSON[4][7] = {
    		"method": "search",
    		"table": "Column_Tag",
		"id": 1,
	    	"params": {

    		}
    	};
	
	example_JSON[5][0] = {
		"method": "search_history",
		"table": "Person",
		"id": 1,
		"params": {
			"enrolled": true,
			"sections": ["AD5"]
		}
	};
    
	example_JSON[5][1] = {
		"method": "search_history",
		"table": "Column",
		"id": 1,
		"params": {
			"column_tags": ["fun"]
		}
	};
    
	example_JSON[5][2] = {
		"method": "search_history",
		"table": "Group",
		"id": 1,
		"params": {
			"name": "TA"
		}
  	  };
    
	example_JSON[5][3] = {
		"method": "search_history",
		"table": "Cell",
		"id": 1,
		"params": {
			"score": "87"
		}
   	 };

  	example_JSON[5][6] = {
   	 	"method": "search_hisory",
    		"table": "Person_Tag",
		"id": 1,
    		"params": {

    		}
    	};

    	example_JSON[5][7] = {
    		"method": "search_history",
	    	"table": "Column_Tag",
		"id": 1,
    		"params": {

    		}
    	};

	example_JSON[6][0] = {
		"method": "revert",
		"table": "Person",
		"id": 1,
		"params": [
			{
				"identifiers": {
					"netid": "zfrank1"
				},
				"date": {
					"year": 2012,
					"month": 6,
					"day": 22,
					"hour": 15,
					"minute": 30,
					"second": 27,
					"millisecond": 20
				}
			}
		]
	};

	example_JSON[6][1] = {
		"method": "revert",
		"table": "Column",
		"id": 1,
		"params": [
			{
				"identifiers": {
					"name": "problem 1"
				},
				"date": {
					"year": 2012,
					"month": 6,
					"day": 22,
					"hour": 15
				}
			}
		]
	};

	example_JSON[6][2] = {
		"method": "revert",
		"table": "Group",
		"id": 1,
		"params": [
			{
				"identifiers": {
					"name": "Student"
				},
				"date": {
					"year": 2012,
					"month": 6,
					"day": 22,
					"hour": 15
				}
			}
		]
	};

	example_JSON[6][3] = {
		"method": "revert",
		"table": "Cell",
		"id": 1,
		"params": [
			{
				"identifiers": {
					"person": "zfrank1",
					"column": "Lab 1"
				},
				"date": {
					"year": 2012,
					"month": 6,
					"day": 22,
					"hour": 15
				}
			}
		]
	};

	example_JSON[7][0] = {
		"method": "remove",
		"table": "Person",
		"id": 1,
		"params": [
			{
				"netid": "zfrank1"
			},
			{
				"netid": "zfrank2"
			}
		]
	};

	example_JSON[7][1] = {
		"method": "remove",
		"table": "Column",
		"id": 1,
		"params": [
			{
				"name": "problem 1"
			},
			{
				"name": "problem 2"
			}
		]
	};

	example_JSON[7][2] = {
		"method": "remove",
		"table": "Group",
		"id": 1,
		"params": [
			{
				"name": "Student"
			},
			{
				"name": "Instructor"
			}
		]
	};

	example_JSON[7][3] = {
		"method": "remove",
		"table": "Cell",
		"id": 1,
		"params": [
			{
				"person": "zfrank1",
				"column": "Lab 1"
			},
			{
				"person": "zfrank1",
				"column": "problem 1"
			}
		]
	};


	var input = document.getElementById("input");

	function setText(){
		var function_name = document.getElementById("functions").value;
		var database_name = document.getElementById("databases").value;
		input.value = formatJson(JSON.stringify(example_JSON[function_name][database_name]));
	}

	</script>
{% else %}
<textarea id="input" name="q" cols="80" rows ="30" wrap="virtual"></textarea>
<p>
<script type="text/javascript">

document.getElementById("input").value = formatJson("{{response}}".replace(/\&quot;/g, "\""));

</script>
</p>
{% endif %}
</body>
</html>