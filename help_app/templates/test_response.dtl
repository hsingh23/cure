{% load staticfiles %}
<html>
<head>
</head>
<body>
<script type="text/javascript" src="/static/formatjson.js"></script>
{% if test_form %}
<p>Choose a method and a database to get example json. Press enter to run your json.</p>

	<form action="/test/" method="post">
		<textarea id="input" name="q" cols="80" rows ="30" wrap="virtual"></textarea>
		<input type="submit" value="enter">
	</form>
	<select id="functions" onchange="setText()">
	<option value=0>add</option>
	<option value=1>change</option>
	<option value=2>get</option>
	<option value=3>get_all</option>
	<option value=4>search</option>
	<option value=5>search_all</option>
	</select>
	<select id="databases" onchange="setText()">
	<option value=0>Person</option>
	<option value=1>Column</option>
	<option value=2>Group</option>
	<option value=3>Cell</option>
	</select>

	<script type="text/javascript">

	<!--TODO: add other example json blobs and their buttons.-->
	var example_JSON = new Array()
	for(var i=0; i<6; i++){
		example_JSON.push([{},{},{},{}])
	}

	example_JSON[0][0] = {
		"function": "add",
		"table": "Person",
		"values": [
			{
				"netid": "zfrank1",
				"group_id": 0,
				"first_name": "Ze",
				"last_name": "Frank",
				"section": "AD7"
			},
			{
				"netid": "zfrank2",
				"group_id": 0
			},
			{
				"netid": "zinstr3",
				"group_id": 3,
				"first_name": "Ze",
				"last_name": "Instr",
				"uin": 987654321
			}
		]
	};
	example_JSON[0][1] = {
		"function": "add",
		"table": "Column",
		"values": [
			{
				"column_id": 0,
				"name": "problem 1",
				"min": 0,
				"max": 100,
				"who": "Jesus"
			},
			{
				"column_id": 1,
				"name": "problem 2",
				"min": 0,
				"max": 100,
				"who": "Buddah"
			},
		]
	};

	example_JSON[0][2] = {
		"function": "add",
		"table": "Group",
		"values": [
			{
				"group_id": 0,
				"name": "Student"
			},
			{
				"group_id": 1,
				"name": "TA"
			},
			{
				"group_id": 2,
				"name": "Instructer"
			}
		]
	};

	example_JSON[0][3] = {
		"function": "add",
		"table": "Cell",
		"values": [
			{
				"column_id": 0,
				"netid": "frankie1",
				"score": 87,
				"who": "Jesus"
			}
		]
	};




	example_JSON[1][0] = {
		"function": "change",
		"table": "Person",
		"changes": [
			{
				"identifier": {
					"netid": "zfrank1"
				},
				"specific_changes": {
					"enrolled": false
				}
			},
			{
				"identifier": {
					"netid": "zfrank2"
				},
				"specific_changes": {
					"first_name": "Ze",
					"last_name": "Frankle",
					"section": "AD3",
					"uin": 132435465
				}
			}
		]
	};

	example_JSON[1][1] = {
		"function": "change",
		"table": "Column",
		"changes": [
			{
				"identifier": {
					"column_id": 0
				},
				"specific_changes": {
					"name": "HW10",
					"who": "Zuess"
				}
			},
			{
				"identifier": {
					"column_id": 1
				},
				"specific_changes": {
					"name": "MP17",
					"max": 10000,
					"who": "Zuess"
				}
			}

		]
	};

	example_JSON[2][0] = {
		"function": "get",
		"table": "Person",
		"identifiers": [
			{
				"netid": "zfrank1"
			},
			{
				"netid": "zfrank2"
			},
			{
				"netid": "zinstr3"
			}
		]
	};
	example_JSON[3][2] = {
		"function": "get_all",
		"table": "Cell",
		"identifiers": [
			{
				"netid": "zfrank1",
				"column_id": 0
			},
			{
				"netid": "zfrank1",
				"column_id": 1
			},
			{
				"netid": "zfrank2",
				"column_id": 1
			}
		]
	};
	example_JSON[4][1] = {
		"function": "search",
		"table": "Column",
		"query": {
			"tag": "MP"
		}
	};
	
	example_JSON[5][0] = {
		"function": "search_all",
		"table": "Person",
		"query": {
			"section": "AD7",
			"enrolled": true
		}
	};

	var input = document.getElementById("input");

	function setText(){
		var function_name = document.getElementById("functions").value;
		var database_name = document.getElementById("databases").value;
		input.value = formatJson(JSON.stringify(example_JSON[function_name][database_name]));
	}
    setText()

	</script>
{% else %}
<script type="text/javascript">
document.write(formatJson({{response}}));
</script>
{% endif %}
</body>
</html>
