<!doctype html>
<!-- manifest="jsonlint.manifest" -->
<html lang="en">
    <head>
        {% load staticfiles %}
        <meta charset="utf-8">
        <meta name="description" content="JSON Lint is a web based validator and reformatter for JSON, a lightweight data-interchange format.">
        <title>
            What's for dinner?
        </title>
        <script type="text/javascript">
            if (typeof JSON === 'undefined') {
                // TODO add static
                document.write('<scr' + 'ipt type="te'+'xt/javascript" src="{% static "js/json2.j" %}"></sc' + 'ript>');
            }
        </script>
        <script src="{% static 'js/jquery.js' %}" type="text/javascript"></script>
        <script src="{% static 'js/jquery-linedtextarea.js' %}" type="text/javascript"></script>
        <link href="{% static 'css/jquery-linedtextarea.css' %}" type="text/css" rel="stylesheet">
        <script type="text/javascript" src="{% static 'js/jsl.parser.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/jsl.format.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/jsl.interactions_0001.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/bootstrap-modal.js' %}"></script>

  <link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet"/>
    <style type="text/css">
body {
padding-top: 60px;
padding-bottom: 20px;
}
.success {
background: #E6EFC2;
color: #529214;
border-color: #C6D880;
}
.error, .notice, .success {
margin-bottom: 1em;
border: 2px solid;
padding: .8em;
}
.error {
background: #FBE3E4;
color: #D12F19;
border-color: #FBC2C4;
}
    </style>
  <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

    </head>
    <body>
<div class="navbar navbar-fixed-top">
  <div class="navbar-inner">
    <div class="container">
      <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>
      <a class="brand" href="#">Submit Initial Data</a>
      <div class="nav-collapse">
        <ul class="nav">
          <li><a href="/make-help-url/">Url</a></li>
          <li class="active"><a href="/make-help-json-lint/">JSON</a></li>
        </ul>
      </div>
    </div>
  </div>
</div>
<div class="container">
    <h1 id="headerText">
        Enter Keyword - Load Sample - Modify JSON - Submit - Profit???
    </h1>
    <form class="well form-search" onsubmit="load_json($('#in-field').val()); return false;">
        <input type="text" class="input search-query" placeholder='Keyword' name="keyword" id='in-field'/>
        <button type="submit" class="btn" id="load">Load initial</button>
    </form>

    <form class="well" id="JSONValidate" method="post" action="." name="JSONValidate">
        {% csrf_token %}
        <input type="hidden" id="reformat" value="1" />
        <input type="hidden" id="compress" value="0" />
        <textarea id="json_input" name="json_input" class="span11 json_input" rows="15" cols="100" spellcheck="false" placeholder="Enter JSON to validate." value=""></textarea>
        <br/><br/>
        <button name="validate" id="validate" value="Validate" class="btn btn-large btn-success">Validate</button>
        <a href="#" id="faqButton" class="bold" name="faqButton">FAQ</a>
        <button onclick="send_request(); return false;" id="submit" value="Submit" class="btn btn-large btn-primary">Submit</button>
    </form>

    <div id="results_header" class="hide">
        <h3>
            Results <img title="Loading..." class="reset" alt="Loading" src="{% static 'img/loadspinner.gif' %}" id="loadSpinner" name="loadSpinner">
        </h3>
    </div>
    <pre id="results"></pre>
    <div id="faq" class="hide">
        <h3>
            FAQ
        </h3>
        <hr>
        <div id="faqAccordion">
            <h5>
                What is JSONLint?
            </h5>
            <div>
                <p>
                    JSONLint is a validator and reformatter for <a href="http://www.json.org/">JSON</a>, a lightweight data-interchange format.
                </p>
            </div>
            <h5>
                What are some common errors?
            </h5>
            <div>
                <dl>
                    <dt>
                        <code>Expecting 'STRING'</code>
                    </dt>
                    <dd>
                        You probably have an extra comma at the end of your collection. Something like: <code>{ "a": "b"<span class="highlight">,</span> }</code>
                    </dd>
                    <dt>
                        <code>Expecting 'STRING', 'NUMBER', 'NULL', 'TRUE', 'FALSE', '{', '['</code>
                    </dt>
                    <dd>
                        You probably have an extra comma at the end of your list. Something like: <code>[ "a", "b"<span class="highlight">,</span> ]</code>
                        <br />
                        You also may have not enclosed your collection keys in quotes. Proper format for a collection is: <code>{ "key": "value" }</code>
                    </dd>
                </dl>
                <p>
                    Be sure to follow <a href="http://www.json.org/">JSON's syntax</a> properly. For example, <strong>always use double quotes, always quotify your keys, and remove all callback functions</strong>.
                </p>
            </div>
            <h5>
                A friend and I pasted the same JSON in and got different results. Wat do?
            </h5>
            <div>
                <p>
                    If you and your friend are on different systems (Win/Unix), this is possible due to the way windows handles newlines. Essentially, if you have just newline characters (\n) in your JSON and paste it into JSONLint from a windows machine, it can validate it as valid erroneously since Windows may need a carriage return (\r) as well to detect newlines properly.
                </p>
                <p>
                    The solution: Either use direct URL input, or make sure your content's newlines match the architecture your system expects!
                </p>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
    $(function() {
        $('#in-field').focus();
        $('#submit').hide();
    });
    function send_request(){
        $.post("/post-submit-json/",
            { keyword: $("#in-field").val(), json: $('#json_input').val(),csrfmiddlewaretoken: $('[name=csrfmiddlewaretoken]').val()},
            function(data) {
                alert(data);
            });
    }
    function load_json(val){
        $('#json_input').val("");
        $.getJSON('/get-initial/?search='+val+'&callback=?', function(data) {
            if (data.type && data.type === "url"){
                $.getJSON(data.url, function(data) {
                    $('#json_input').val(JSON.stringify(data));
                }).done(function(){$("#validate").click();});
            }
            else{
                $('#json_input').val(JSON.stringify(data));
            }
        }).fail(function(){load_sample();}).done(function(){$("#validate").click();});
    }
    function load_sample(){
        $.getJSON('http://get-json.herokuapp.com/?resource=http://statics.site50.net/json/init_0002.json&callback=?', function(data) {
            $('#json_input').val(JSON.stringify(data));
        }).done(function(){$("#validate").click();});

    }
</script>
</body>
</html>
