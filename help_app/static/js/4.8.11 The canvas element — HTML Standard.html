<!DOCTYPE html>
<!-- saved from url=(0083)http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html -->
<html lang="en-US-x-hixie" class="split chapter"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>4.8.11 The canvas element — HTML Standard</title><script>
   var loadTimer = new Date();
   var current_revision = "r" + "$Revision: 7221 $".substr(11);
   current_revision = current_revision.substr(0, current_revision.length - 2);
   var last_known_revision = current_revision;
   function getCookie(name) {
     var params = location.search.substr(1).split("&");
     for (var index = 0; index < params.length; index++) {
       if (params[index] == name)
         return "1";
       var data = params[index].split("=");
       if (data[0] == name)
         return unescape(data[1]);
     }
     var cookies = document.cookie.split("; ");
     for (var index = 0; index < cookies.length; index++) {
       var data = cookies[index].split("=");
       if (data[0] == name)
         return unescape(data[1]);
     }
     return null;
   }
   var currentAlert;
   var currentAlertTimeout;
   function showAlert(s, href) {
     if (!currentAlert) {
       currentAlert = document.createElement('div');
       currentAlert.id = 'alert';
       var x = document.createElement('button');
       x.textContent = '\u2573';
       x.onclick = closeAlert2;
       currentAlert.appendChild(x);
       currentAlert.appendChild(document.createElement('span'));
       currentAlert.onmousemove = function () {
         clearTimeout(currentAlertTimeout);
         currentAlert.className = '';
         currentAlertTimeout = setTimeout(closeAlert, 10000);
       }
       document.body.appendChild(currentAlert);
     } else {
       clearTimeout(currentAlertTimeout);
       currentAlert.className = '';
     }
     currentAlert.lastChild.textContent = s + ' ';
     if (href) {
       var link = document.createElement('a');
       link.href = href;
       link.textContent = href;
       currentAlert.lastChild.appendChild(link);
     }
     currentAlertTimeout = setTimeout(closeAlert, 10000);
   }
   function closeAlert() {
     clearTimeout(currentAlertTimeout);
     if (currentAlert) {
       currentAlert.className = 'closed';
       currentAlertTimeout = setTimeout(closeAlert2, 3000);
     }
   }
   function closeAlert2() {
     clearTimeout(currentAlertTimeout);
     if (currentAlert) {
       currentAlert.parentNode.removeChild(currentAlert);
       currentAlert = null;
     }
   }
   window.addEventListener('keydown', function (event) {
     if (event.keyCode == 27) {
       if (currentAlert)
         closeAlert2();
     } else {
       closeAlert();
     }
   }, false);
   window.addEventListener('scroll', function (event) {
     closeAlert();
   }, false);
   function load(script) {
     var e = document.createElement('script');
     e.setAttribute('src', 'http://www.whatwg.org/specs/web-apps/current-work/' + script + '?' + encodeURIComponent(location) + '&' + encodeURIComponent(document.referrer));
     document.body.appendChild(e);
   }
  </script><link href="http://www.whatwg.org/style/specification" rel="stylesheet"><link href="http://www.whatwg.org/images/icon" rel="icon"><style>
   .proposal { border: blue solid; padding: 1em; }
   .bad, .bad *:not(.XXX) { color: gray; border-color: gray; background: transparent; }
   #updatesStatus { display: none; }
   #updatesStatus.relevant { display: block; position: fixed; right: 1em; top: 1em; padding: 0.5em; font: bold small sans-serif; min-width: 25em; width: 30%; max-width: 40em; height: auto; border: ridge 4px gray; background: #EEEEEE; color: black; }
   div.head .logo { width: 11em; margin-bottom: 20em; }
   #configUI { position: absolute; z-index: 20; top: 10em; right: 0; width: 11em; padding: 0 0.5em 0 0.5em; font-size: small; background: gray; background: rgba(32,32,32,0.9); color: white; border-radius: 1em 0 0 1em; -moz-border-radius: 1em 0 0 1em; }
   #configUI p { margin: 0.75em 0; padding: 0.3em; }
   #configUI p label { display: block; }
   #configUI #updateUI, #configUI .loginUI { text-align: center; }
   #configUI input[type=button] { display: block; margin: auto; }
   #configUI :link, #configUI :visited { color: white; }
   #configUI :link:hover, #configUI :visited:hover { background: transparent; }
   #reviewer { position: fixed; bottom: 0; right: 0; padding: 0.15em 0.25em 0em 0.5em; white-space: nowrap; overflow: hidden; z-index: 30; background: gray; background: rgba(32,32,32,0.9); color: white; border-radius: 1em 0 0 0; -moz-border-radius: 1em 0 0 0; max-width: 90%; }
   #reviewer input { max-width: 50%; }
   #reviewer * { font-size: small; }
   #reviewer.off > :not(:first-child) { display: none; }
   #alert { position: fixed; top: 20%; left: 20%; right: 20%; font-size: 2em; padding: 0.5em; z-index: 40; background: gray; background: rgba(32,32,32,0.9); color: white; border-radius: 1em; -moz-border-radius: 1em; -webkit-transition: opacity 1s linear; }
   #alert.closed { opacity: 0; }
   #alert button { position: absolute; top: -1em; right: 2em; border-radius: 1em 1em 0 0; border: none; line-height: 0.9; color: white; background: rgb(64,64,64); font-size: 0.6em; font-weight: 900; cursor: pointer; }
   #alert :link, #alert :visited { color: white; }
   #alert :link:hover, #alert :visited:hover { background: transparent; }
   @media print { #configUI { display: none; } }
   .rfc2119 { font-variant: small-caps; text-shadow: 0 0 0.5em yellow; position: static; }
   .rfc2119::after { position: absolute; left: 0; width: 25px; text-align: center; color: yellow; text-shadow: 0.075em 0.075em 0.2em black; }
   .rfc2119.m\ust::after { content: '\2605'; }
   .rfc2119.s\hould::after { content: '\2606'; }
   [hidden] { display: none; }
  </style><style type="text/css">

   .fingerprint { float: right; }

   .applies thead th > * { display: block; }
   .applies thead code { display: block; }
   .applies tbody th { whitespace: nowrap; }
   .applies td { text-align: center; }
   .applies .yes { background: yellow; }

   .matrix, .matrix td { border: hidden; text-align: right; }
   .matrix { margin-left: 2em; }

   .dice-example { border-collapse: collapse; border-style: hidden solid solid hidden; border-width: thin; margin-left: 3em; }
   .dice-example caption { width: 30em; font-size: smaller; font-style: italic; padding: 0.75em 0; text-align: left; }
   .dice-example td, .dice-example th { border: solid thin; width: 1.35em; height: 1.05em; text-align: center; padding: 0; }

   td.eg { border-width: thin; text-align: center; }

   #table-example-1 { border: solid thin; border-collapse: collapse; margin-left: 3em; }
   #table-example-1 * { font-family: "Essays1743", serif; line-height: 1.01em; }
   #table-example-1 caption { padding-bottom: 0.5em; }
   #table-example-1 thead, #table-example-1 tbody { border: none; }
   #table-example-1 th, #table-example-1 td { border: solid thin; }
   #table-example-1 th { font-weight: normal; }
   #table-example-1 td { border-style: none solid; vertical-align: top; }
   #table-example-1 th { padding: 0.5em; vertical-align: middle; text-align: center; }
   #table-example-1 tbody tr:first-child td { padding-top: 0.5em; }
   #table-example-1 tbody tr:last-child td { padding-bottom: 1.5em; }
   #table-example-1 tbody td:first-child { padding-left: 2.5em; padding-right: 0; width: 9em; }
   #table-example-1 tbody td:first-child::after { content: leader(". "); }
   #table-example-1 tbody td { padding-left: 2em; padding-right: 2em; }
   #table-example-1 tbody td:first-child + td { width: 10em; }
   #table-example-1 tbody td:first-child + td ~ td { width: 2.5em; }
   #table-example-1 tbody td:first-child + td + td + td ~ td { width: 1.25em; }

   .apple-table-examples { border: none; border-collapse: separate; border-spacing: 1.5em 0em; width: 40em; margin-left: 3em; }
   .apple-table-examples * { font-family: "Times", serif; }
   .apple-table-examples td, .apple-table-examples th { border: none; white-space: nowrap; padding-top: 0; padding-bottom: 0; }
   .apple-table-examples tbody th:first-child { border-left: none; width: 100%; }
   .apple-table-examples thead th:first-child ~ th { font-size: smaller; font-weight: bolder; border-bottom: solid 2px; text-align: center; }
   .apple-table-examples tbody th::after, .apple-table-examples tfoot th::after { content: leader(". ") }
   .apple-table-examples tbody th, .apple-table-examples tfoot th { font: inherit; text-align: left; }
   .apple-table-examples td { text-align: right; vertical-align: top; }
   .apple-table-examples.e1 tbody tr:last-child td { border-bottom: solid 1px; }
   .apple-table-examples.e1 tbody + tbody tr:last-child td { border-bottom: double 3px; }
   .apple-table-examples.e2 th[scope=row] { padding-left: 1em; }
   .apple-table-examples sup { line-height: 0; }

   .three-column-nowrap tr > td:first-child,
   .three-column-nowrap tr > td:first-child + td,
   .three-column-nowrap tr > td:first-child + td + td { white-space: nowrap; }

   .details-example img { vertical-align: top; }

   #base64-table {
     white-space: nowrap;
     font-size: 0.6em;
     column-width: 6em;
     column-count: 5;
     column-gap: 1em;
     -moz-column-width: 6em;
     -moz-column-count: 5;
     -moz-column-gap: 1em;
     -webkit-column-width: 6em;
     -webkit-column-count: 5;
     -webkit-column-gap: 1em;
   }
   #base64-table thead { display: none; }
   #base64-table * { border: none; }
   #base64-table tbody td:first-child:after { content: ':'; }
   #base64-table tbody td:last-child { text-align: right; }

   #named-character-references-table {
     white-space: nowrap;
     font-size: 0.6em;
     column-width: 30em;
     column-gap: 1em;
     -moz-column-width: 30em;
     -moz-column-gap: 1em;
     -webkit-column-width: 30em;
     -webkit-column-gap: 1em;
   }
   #named-character-references-table > table > tbody > tr > td:first-child + td,
   #named-character-references-table > table > tbody > tr > td:last-child { text-align: center; }
   #named-character-references-table > table > tbody > tr > td:last-child:hover > span { position: absolute; top: auto; left: auto; margin-left: 0.5em; line-height: 1.2; font-size: 5em; border: outset; padding: 0.25em 0.5em; background: white; width: 1.25em; height: auto; text-align: center; }
   #named-character-references-table > table > tbody > tr#entity-CounterClockwiseContourIntegral > td:first-child { font-size: 0.5em; }

   .glyph.control { color: red; }

   @font-face {
     font-family: 'Essays1743';
     src: url('http://www.whatwg.org/specs/web-apps/current-work/fonts/Essays1743.ttf');
   }
   @font-face {
     font-family: 'Essays1743';
     font-weight: bold;
     src: url('http://www.whatwg.org/specs/web-apps/current-work/fonts/Essays1743-Bold.ttf');
   }
   @font-face {
     font-family: 'Essays1743';
     font-style: italic;
     src: url('http://www.whatwg.org/specs/web-apps/current-work/fonts/Essays1743-Italic.ttf');
   }
   @font-face {
     font-family: 'Essays1743';
     font-style: italic;
     font-weight: bold;
     src: url('http://www.whatwg.org/specs/web-apps/current-work/fonts/Essays1743-BoldItalic.ttf');
   }

  </style><link href="data:text/css," rel="stylesheet" title="Normal"><link href="data:text/css,.impl%20%7B%20background:%20pink;%20%7D" rel="stylesheet alternate" title="Highlight implementation-only prose"><link href="http://www.whatwg.org/specs/web-apps/current-work/multipage/status.css" rel="stylesheet"><script>
   var startedInit = 0;
   function init() {
     startedInit = 1;
     if (location.search == '?slow-browser')
       return;
     var configUI = document.createElement('div');
     configUI.id = 'configUI';
     document.body.appendChild(configUI);
     load('reviewer.js');
     if (document.documentElement.className == "" || document.documentElement.className == "split index")
       load('toc.js');
     load('updater.js');
     load('dfn.js');
     load('status.js');
     if (getCookie('profile') == '1')
       document.getElementsByTagName('h2')[0].textContent += '; load: ' + (new Date() - loadTimer) + 'ms';
   }
   if (document.documentElement.className == "")
     setTimeout(function () {
       if (!startedInit)
         showAlert("Too slow? Try reading the multipage copy of the spec instead:", "http://whatwg.org/html");
     }, 6000);
  </script>
  <script src="./4.8.11 The canvas element — HTML Standard_files/link-fixup.js"></script>
  <link href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html" title="4.8.6 The video element" rel="prev">
  <link href="http://www.whatwg.org/specs/web-apps/current-work/multipage/index.html#contents" title="Table of contents" rel="index">
  <link href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-map-element.html" title="4.8.12 The map element" rel="next">
  <link type="text/css" rel="stylesheet" href="chrome-extension://cpngackimfmofbokmjmljamhdncknpmg/style.css"><script type="text/javascript" charset="utf-8" src="chrome-extension://cpngackimfmofbokmjmljamhdncknpmg/page_context.js"></script></head><link rel="stylesheet" type="text/css" href="data:text/css,"><body onload="fixBrokenLink(); init()" screen_capture_injected="true" class=" dfnEnabled statusEnabled"><header class="head" id="head"><p><a class="logo" href="http://www.whatwg.org/"><img alt="WHATWG" height="101" src="./4.8.11 The canvas element — HTML Standard_files/logo" width="101"></a></p>
   <hgroup><h1 class="allcaps">HTML</h1>
    <h2 class="no-num no-toc">Living Standard — Last Updated 27 July 2012</h2>
   </hgroup></header><nav>
   <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html">← 4.8.6 The video element</a> –
   <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/index.html#contents">Table of contents</a> –
   <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-map-element.html">4.8.12 The map element →</a>
  <ol class="toc"><li><ol><li><ol><li><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element"><span class="secno">4.8.11 </span>The <code>canvas</code> element</a>
      <ol><li><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#2dcontext"><span class="secno">4.8.11.1 </span>The 2D context</a>
        <ol><li><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#resolution"><span class="secno">4.8.11.1.1 </span>Resolution</a></li><li><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-state"><span class="secno">4.8.11.1.2 </span>The canvas state</a></li><li><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#drawingstyle-objects"><span class="secno">4.8.11.1.3 </span><code>DrawingStyle</code> objects</a></li><li><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#line-styles"><span class="secno">4.8.11.1.4 </span>Line styles</a></li><li><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#text-styles"><span class="secno">4.8.11.1.5 </span>Text styles</a></li><li><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#building-paths"><span class="secno">4.8.11.1.6 </span>Building paths</a></li><li><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path-objects"><span class="secno">4.8.11.1.7 </span><code>Path</code> objects</a></li><li><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#transformations"><span class="secno">4.8.11.1.8 </span>Transformations</a></li><li><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#fill-and-stroke-styles"><span class="secno">4.8.11.1.9 </span>Fill and stroke styles</a></li><li><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#drawing-rectangles-to-the-canvas"><span class="secno">4.8.11.1.10 </span>Drawing rectangles to the canvas</a></li><li><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#drawing-text-to-the-canvas"><span class="secno">4.8.11.1.11 </span>Drawing text to the canvas</a></li><li><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#drawing-paths-to-the-canvas"><span class="secno">4.8.11.1.12 </span>Drawing paths to the canvas</a></li><li><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#drawing-images-to-the-canvas"><span class="secno">4.8.11.1.13 </span>Drawing images to the canvas</a></li><li><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-regions"><span class="secno">4.8.11.1.14 </span>Hit regions</a></li><li><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#pixel-manipulation"><span class="secno">4.8.11.1.15 </span>Pixel manipulation</a></li><li><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#compositing"><span class="secno">4.8.11.1.16 </span>Compositing</a></li><li><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#image-smoothing"><span class="secno">4.8.11.1.17 </span>Image smoothing</a></li><li><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#shadows"><span class="secno">4.8.11.1.18 </span>Shadows</a></li><li><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#drawing-model"><span class="secno">4.8.11.1.19 </span>Drawing model</a></li><li><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#best-practices"><span class="secno">4.8.11.1.20 </span>Best practices</a></li><li><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#examples"><span class="secno">4.8.11.1.21 </span>Examples</a></li></ol></li><li><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#color-spaces-and-color-correction"><span class="secno">4.8.11.2 </span>Color spaces and color correction</a></li><li><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#security-with-canvas-elements"><span class="secno">4.8.11.3 </span>Security with <code>canvas</code> elements</a></li></ol></li></ol></li></ol></li></ol></nav>

  <h4 id="the-canvas-element"><span class="secno">4.8.11 </span>The <dfn id="canvas"><code>canvas</code></dfn> element</h4><div class="status REC"><p><strong>Implemented and widely deployed</strong></p><p class="idref"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">#the-canvas-element</a></p><p>Tests: 4 — <a href="http://www.whatwg.org/specs/web-apps/current-work/show-tests.html?section=the-canvas-element">View...</a></p><p>Demos: 1 — <a href="http://www.whatwg.org/specs/web-apps/current-work/show-demos.html?section=the-canvas-element">View...</a></p><div class="implementations"><p class="IE NONE" title="Latest Internet Explorer beta: does not support this feature">Latest Internet Explorer beta: unknown</p><p class="Firefox BUG" title="Latest Firefox trunk nightly build: has nearly complete support for this feature, but does not yet pass all the relevant test cases">Latest Firefox trunk nightly build: complete but buggy support</p><p class="Safari BUG" title="Latest WebKit or Chromium trunk build: has nearly complete support for this feature, but does not yet pass all the relevant test cases">Latest WebKit or Chromium trunk build: complete but buggy support</p><p class="Opera BUG" title="Latest Opera beta or preview build: has nearly complete support for this feature, but does not yet pass all the relevant test cases">Latest Opera beta or preview build: complete but buggy support</p><p class="Shims PARTIAL" title="JavaScript libraries, plugins, etc: has partial support for this feature, but might have bugs and certainly doesn&#39;t support all aspects of this feature">JavaScript libraries, plugins, etc: incomplete support</p></div><p class="last-edit"><a>2012-07-17</a> <a>Ms2ger</a></p><p class="edit-link"><a href="http://www.whatwg.org/specs/web-apps/current-work/edit-section.html?section=the-canvas-element">Edit this information...</a></p></div>

  <dl class="element"><dt><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/elements.html#element-dfn-categories" title="element-dfn-categories">Categories</a>:</dt>
   <dd><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/elements.html#flow-content">Flow content</a>.</dd>
   <dd><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/elements.html#phrasing-content">Phrasing content</a>.</dd>
   <dd><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/elements.html#embedded-content">Embedded content</a>.</dd>
   <dd><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/elements.html#palpable-content">Palpable content</a>.</dd>
   <dt><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/elements.html#element-dfn-contexts" title="element-dfn-contexts">Contexts in which this element can be used</a>:</dt>
   <dd>Where <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/elements.html#embedded-content">embedded content</a> is expected.</dd>
   <dt><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/elements.html#element-dfn-content-model" title="element-dfn-content-model">Content model</a>:</dt>
   <dd><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/elements.html#transparent">Transparent</a><!--
--><!--FORK--><!--
-->, but with no <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/elements.html#interactive-content">interactive content</a> descendants except for <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/text-level-semantics.html#the-a-element">a</a></code> elements, <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-button-element.html#the-button-element">button</a></code> elements, <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-input-element.html#the-input-element">input</a></code> elements whose <code title="attr-input-type"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-input-element.html#attr-input-type">type</a></code> attribute are in the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/states-of-the-type-attribute.html#checkbox-state-(type=checkbox)" title="attr-input-type-checkbox">Checkbox</a> or <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/states-of-the-type-attribute.html#radio-button-state-(type=radio)" title="attr-input-type-radio">Radio Button</a> states, and <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-input-element.html#the-input-element">input</a></code> elements that are <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/forms.html#concept-button" title="concept-button">buttons</a><!--
--><!--FORK--><!--
-->.</dd> <!-- and maybe <select>, I guess? I've left it our for now, since I guess authors might make accessible selects if they're simple enough, and it's not obvious how to distinguish the simple ones from the complex ones... -->
   <dt><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/elements.html#element-dfn-attributes" title="element-dfn-attributes">Content attributes</a>:</dt>
   <dd><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/elements.html#global-attributes">Global attributes</a></dd>
   <dd><code title="attr-canvas-width"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#attr-canvas-width">width</a></code></dd>
   <dd><code title="attr-canvas-height"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#attr-canvas-height">height</a></code></dd>
   <dt><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/elements.html#element-dfn-dom" title="element-dfn-dom">DOM interface</a>:</dt><!--ADD-TOPIC:DOM APIs-->
   <dd>
    <pre class="idl">interface <dfn id="htmlcanvaselement">HTMLCanvasElement</dfn> : <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/elements.html#htmlelement">HTMLElement</a> {
           attribute unsigned long <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-canvas-width" title="dom-canvas-width">width</a>;
           attribute unsigned long <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-canvas-height" title="dom-canvas-height">height</a>;

  DOMString <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-canvas-todataurl" title="dom-canvas-toDataURL">toDataURL</a>(optional DOMString type, any... args);
  DOMString <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-canvas-todataurlhd" title="dom-canvas-toDataURLHD">toDataURLHD</a>(optional DOMString type, any... args);
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-canvas-toblob" title="dom-canvas-toBlob">toBlob</a>(<a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#filecallback">FileCallback</a>? _callback, optional DOMString type, any... args);
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-canvas-toblobhd" title="dom-canvas-toBlobHD">toBlobHD</a>(<a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#filecallback">FileCallback</a>? _callback, optional DOMString type, any... args);

  object? <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-canvas-getcontext" title="dom-canvas-getContext">getContext</a>(DOMString contextId, any... args);
};</pre>
   </dd>
  </dl><!--REMOVE-TOPIC:DOM APIs--><p>The <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element provides scripts with a
  resolution-dependent bitmap canvas, which can be used for rendering
  graphs, game graphics, or other visual images on the fly.</p>

  <p>Authors should not use the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element in a
  document when a more suitable element is available. For example, it
  is inappropriate to use a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element to render a
  page heading: if the desired presentation of the heading is
  graphically intense, it should be marked up using appropriate
  elements (typically <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/sections.html#the-h1,-h2,-h3,-h4,-h5,-and-h6-elements">h1</a></code>) and then styled using CSS and
  supporting technologies such as XBL.</p>

  <p>When authors use the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element, they must also
  provide content that, when presented to the user, conveys
  essentially the same function or purpose as the bitmap canvas. This
  content may be placed as content of the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code>
  element. The contents of the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element, if any,
  are the element's <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/elements.html#fallback-content">fallback content</a>.</p>

  <p>In interactive visual media, if <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#concept-n-script" title="concept-n-script">scripting is enabled</a> for the
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element, and if support for <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code>
  elements has been enabled, the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/rendering.html#represents">represents</a> <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/elements.html#embedded-content">embedded content</a> consisting of
  a dynamically created image.</p>

  <p>In non-interactive, static, visual media, if the
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element has been previously painted on (e.g. if
  the page was viewed in an interactive visual medium and is now being
  printed, or if some script that ran during the page layout process
  painted on the element), then the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/rendering.html#represents">represents</a> <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/elements.html#embedded-content">embedded content</a> with the
  current image and size. Otherwise, the element represents its
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/elements.html#fallback-content">fallback content</a> instead.</p>

  <p>In non-visual media, and in visual media if <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#concept-n-noscript" title="concept-n-noscript">scripting is disabled</a> for the
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element or if support for <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code>
  elements has been disabled, the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/rendering.html#represents">represents</a> its <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/elements.html#fallback-content">fallback content</a>
  instead.</p>

  <!-- CANVAS-FOCUS-FALLBACK -->
  <p>When a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/rendering.html#represents">represents</a>
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/elements.html#embedded-content">embedded content</a>, the user can still focus descendants
  of the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element (in the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/elements.html#fallback-content">fallback
  content</a>). When an element is focused, it is the target of
  keyboard interaction events (even though the element itself is not
  visible). This allows authors to make an interactive canvas
  keyboard-accessible: authors should have a one-to-one mapping of
  interactive regions to focusable elements in the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/elements.html#fallback-content">fallback
  content</a>. (Focus has no effect on mouse interaction
  events.) <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/references.html#refsDOMEVENTS">[DOMEVENTS]</a></p>

  <p>The <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element has two attributes to control the
  size of the coordinate space: <dfn id="attr-canvas-width" title="attr-canvas-width"><code>width</code></dfn> and <dfn id="attr-canvas-height" title="attr-canvas-height"><code>height</code></dfn>. These
  attributes, when specified, must have values that are <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/common-microsyntaxes.html#valid-non-negative-integer" title="valid non-negative integer">valid non-negative
  integers</a>. <span class="impl">The <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/common-microsyntaxes.html#rules-for-parsing-non-negative-integers">rules for parsing
  non-negative integers</a> must be used to obtain their numeric
  values. If an attribute is missing, or if parsing its value returns
  an error, then the default value must be used instead.</span> The
  <code title="attr-canvas-width"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#attr-canvas-width">width</a></code> attribute defaults to
  300, and the <code title="attr-canvas-height"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#attr-canvas-height">height</a></code>
  attribute defaults to 150.</p>

  <p>The intrinsic dimensions of the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element equal
  the size of the coordinate space, with the numbers interpreted in
  CSS pixels. However, the element can be sized arbitrarily by a
  style sheet. During rendering, the image is scaled to fit this layout
  size.</p>

  <div class="impl">

  <p>The size of the coordinate space does not necessarily represent
  the size of the actual bitmap that the user agent will use
  internally or during rendering. On high-definition displays, for
  instance, the user agent may internally use a bitmap with two device
  pixels per unit in the coordinate space, so that the rendering
  remains at high quality throughout.</p>

  <p>When the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element is created, and subsequently
  whenever the <code title="attr-canvas-width"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#attr-canvas-width">width</a></code> and <code title="attr-canvas-height"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#attr-canvas-height">height</a></code> attributes are set (whether
  to a new value or to the previous value), the bitmap and any
  associated contexts must be cleared back to their initial state and
  reinitialized with the newly specified coordinate space
  dimensions.</p>

  <p>When the canvas is initialized, its bitmap must be cleared to
  transparent black.</p>

  <p>When a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element does not represent its
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/elements.html#fallback-content">fallback content</a>, it <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#provides-a-paint-source">provides a paint
  source</a> whose width is the element's intrinsic width, whose
  height is the element's intrinsic height, and whose appearance is
  the element's bitmap.</p>

  <p>The <dfn id="dom-canvas-width" title="dom-canvas-width"><code>width</code></dfn> and
  <dfn id="dom-canvas-height" title="dom-canvas-height"><code>height</code></dfn> IDL
  attributes must <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/common-dom-interfaces.html#reflect">reflect</a> the respective content
  attributes of the same name, with the same defaults.</p>

  </div>

  <div class="example">
   <p>Only one square appears to be drawn in the following example:</p>
   <pre>  // canvas is a reference to a &lt;canvas&gt; element
  var context = canvas.getContext('2d');
  context.fillRect(0,0,50,50);
  canvas.setAttribute('width', '300'); // clears the canvas
  context.fillRect(0,100,50,50);
  canvas.width = canvas.width; // clears the canvas
  context.fillRect(100,0,50,50); // only this square remains</pre>
  </div>

  <hr><!--ADD-TOPIC:DOM APIs--><dl class="domintro"><dt><var title="">context</var> = <var title="">canvas</var> . <code title="dom-canvas-getContext"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-canvas-getcontext">getContext</a></code>(<var title="">contextId</var> [, ... ])</dt>

   <dd>

    <p>Returns an object that exposes an API for drawing on the
    canvas. The first argument specifies the desired API. Subsequent
    arguments are handled by that API.</p>

<!--2DCONTEXT-->

    <p>This specification defines the "<code title="canvas-context-2d"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvas-context-2d">2d</a></code>" context below. There is also
    a specification that defines a "<code title="canvas-context-webgl">webgl</code>" context. <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/references.html#refsWEBGL">[WEBGL]</a></p>

<!--2DCONTEXT-->

    <p>The list of defined contexts is given on the <a href="http://wiki.whatwg.org/wiki/CanvasContexts">WHATWG Wiki
    CanvasContexts page</a>. <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/references.html#refsWHATWGWIKI">[WHATWGWIKI]</a>

    </p><p>Returns null if the given context ID is not supported or if the
    canvas has already been initialized with some other (incompatible)
    context type (e.g. trying to get a "<code title="canvas-context-2d"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvas-context-2d">2d</a></code>" context after getting a
    "<code title="canvas-context-webgl">webgl</code>" context).</p>

   </dd>

  </dl><div class="impl">

  <p>A <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element can have a <dfn id="primary-context">primary
  context</dfn>, which is the first context to have been obtained for
  that element. When created, a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element must not
  have a <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#primary-context">primary context</a>.</p>


  <p>The <dfn id="dom-canvas-getcontext" title="dom-canvas-getContext"><code>getContext(<var title="">contextId</var>, <var title="">args...</var>)</code></dfn>
  method of the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element, when invoked, must run
  the following steps:</p>

  <ol><li><p>Let <var title="">contextId</var> be the first argument to
   the method.</p></li>

   <li>

    <p>If <var title="">contextId</var> is not the name of a context
    supported by the user agent, return null and abort these
    steps.</p>

    <p class="note">An example of this would be a user agent that
    theoretically supports the "<code title="canvas-context-webgl">webgl</code>" 3D context, in the case
    where the platform does not have hardware support for OpenGL and
    the user agent does not have a software OpenGL implementation.
    Despite the user agent recognising the "<code title="canvas-context-webgl">webgl</code>" name, it would return
    null at this step because that context is not, in practice,
    supported at the time of the call.</p>

   </li>

   <li><p>If the element has a <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#primary-context">primary context</a> and that
   context's entry in the <a href="http://wiki.whatwg.org/wiki/CanvasContexts">WHATWG Wiki
   CanvasContexts page</a> does not list <var title="">contextId</var>
   as a context with which it is compatible, return null and abort
   these steps. <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/references.html#refsWHATWGWIKI">[WHATWGWIKI]</a></p></li>

   <li><p>If the element does not have a <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#primary-context">primary context</a>,
   let the element's <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#primary-context">primary context</a> be <var title="">contextId</var>.</p></li>

   <li><p>If the <code title="dom-canvas-getContext"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-canvas-getcontext">getContext()</a></code> method has
   already been invoked on this element for the same <var title="">contextId</var>, return the same object as was returned
   that time, and abort these steps. The additional arguments are
   ignored.</p></li>

   <li><p><dfn id="getcontext-return" title="getContext-return">Return a new object for <var title="">contextId</var></dfn>, as defined by the specification
   given for <var title="">contextId</var>'s entry in the <a href="http://wiki.whatwg.org/wiki/CanvasContexts">WHATWG Wiki
   CanvasContexts page</a>. <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/references.html#refsWHATWGWIKI">[WHATWGWIKI]</a></p></li>

  </ol><p>New context types may be registered in the <a href="http://wiki.whatwg.org/wiki/CanvasContexts">WHATWG Wiki
  CanvasContexts page</a>. <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/references.html#refsWHATWGWIKI">[WHATWGWIKI]</a></p>

  <p>Anyone is free to edit the WHATWG Wiki CanvasContexts page at any
  time to add a new context type. These new context types must be
  specified with the following information:</p>

  <dl><dt>Keyword</dt>

   <dd><p>The value of <var title="">contextID</var> that will return
   the object for the new API.</p></dd>


   <dt>Specification</dt>

   <dd><p>A link to a formal specification of the context type's
   API. It could be another page on the Wiki, or a link to an external
   page. If the type does not have a formal specification, an informal
   description can be substituted until such time as a formal
   specification is available.</p></dd>


   <dt>Compatible with</dt>

   <dd><p>The list of context types that are compatible with this one
   (i.e. that operate on the same underlying bitmap). This list must
   be transitive and symmetric; if one context type is defined as
   compatible with another, then all types it is compatible with must
   be compatible with all types the other is compatible with.</p></dd>

  </dl><p>Vendors may also define experimental contexts using the syntax
  <code><var title="">vendorname</var>-<var title="">context</var></code>, for example,
  <code>moz-3d</code>. Such contexts should be registered in the
  WHATWG Wiki CanvasContexts page.</p>

  </div>

  <hr><dl class="domintro"><dt><var title="">url</var> = <var title="">canvas</var> . <code title="dom-canvas-toDataURL"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-canvas-todataurl">toDataURL</a></code>( [ <var title="">type</var>, ... ] )</dt>
   <dt><var title="">url</var> = <var title="">canvas</var> . <code title="dom-canvas-toDataURLHD"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-canvas-todataurlhd">toDataURLHD</a></code>( [ <var title="">type</var>, ... ] )</dt>

   <dd>

    <p>Returns a <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#data-protocol" title="data protocol"><code title="">data:</code> URL</a> for the image in the canvas.</p>

    <p>The first argument, if provided, controls the type of the image
    to be returned (e.g. PNG or JPEG). The default is <code title="">image/png</code>; that type is also used if the given
    type isn't supported. The other arguments are specific to the
    type, and control the way that the image is generated, as given in
    the table below.</p>

    <p>When trying to use types other than "<code>image/png</code>",
    authors can check if the image was really returned in the
    requested format by checking to see if the returned string starts
    with one of the exact strings "<code title="">data:image/png,</code>" or "<code title="">data:image/png;</code>". If it does, the image is PNG,
    and thus the requested type was not supported. (The one exception
    to this is if the canvas has either no height or no width, in
    which case the result might simply be "<code title="">data:,</code>".)</p>

    <p>The <code title="dom-canvas-toDataURL"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-canvas-todataurl">toDataURL()</a></code>
    method returns the data at a resolution of 96dpi. The <code title="dom-canvas-toDataURLHD"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-canvas-todataurlhd">toDataURLHD()</a></code> method returns
    it at the native canvas bitmap resolution.</p>

   </dd>

   <dt><var title="">canvas</var> . <code title="dom-canvas-toBlob"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-canvas-toblob">toBlob</a></code>(<var title="">callback</var> [, <var title="">type</var>, ... ])</dt>
   <dt><var title="">canvas</var> . <code title="dom-canvas-toBlobHD"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-canvas-toblobhd">toBlobHD</a></code>(<var title="">callback</var> [, <var title="">type</var>, ... ])</dt>

   <dd>

    <p>Creates a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#blob">Blob</a></code> object representing a file
    containing the image in the canvas, and invokes a callback with a
    handle to that object.</p>

    <p>The second argument, if provided, controls the type of the
    image to be returned (e.g. PNG or JPEG). The default is <code title="">image/png</code>; that type is also used if the given
    type isn't supported. The other arguments are specific to the
    type, and control the way that the image is generated, as given in
    the table below.</p>

    <p>The <code title="dom-canvas-toBlob"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-canvas-toblob">toBlob()</a></code> method
    provides the data at a resolution of 96dpi. The <code title="dom-canvas-toBlobHD"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-canvas-toblobhd">toBlobHD()</a></code> method provides it
    at the native canvas bitmap resolution.</p>

   </dd>

  </dl><div class="impl">

  <p>The <dfn id="dom-canvas-todataurl" title="dom-canvas-toDataURL"><code>toDataURL()</code></dfn> and <dfn id="dom-canvas-todataurlhd" title="dom-canvas-toDataURLHD"><code>toDataURLHD()</code></dfn>
  methods must run the following steps:</p>

  <ol><!--ADD-TOPIC:Security--><li><p>If the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element's <i>origin-clean</i>
   flag is set to false, throw a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#securityerror">SecurityError</a></code> exception
   and abort these steps.</p>
<!--REMOVE-TOPIC:Security-->

   </li><li><p>If the canvas has no pixels (i.e. either its horizontal
   dimension or its vertical dimension is zero) then return the string
   "<code title="">data:,</code>" and abort these steps. (This is the
   shortest <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#data-protocol" title="data protocol"><code title="">data:</code>
   URL</a>; it represents the empty string in a <code title="">text/plain</code> resource.)</p></li>

   <li><p>Let <var title="">file</var> be <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#a-serialization-of-the-image-as-a-file">a serialization of the
   image as a file</a>, using the method's arguments (if any) as
   the <var title="">arguments</var>, and with the <var title="">native</var> flag set if the method is the <code title="dom-canvas-toDataURLHD"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-canvas-todataurlhd">toDataURLHD()</a></code> method, and not
   otherwise.</p></li>

   <li><p>Return a <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#data-protocol" title="data protocol"><code title="">data:</code> URL</a> representing <var title="">file</var>. <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/references.html#refsRFC2397">[RFC2397]</a></p>

   <!-- should we explicitly require the URL to be base64-encoded and
   not have any parameters, to ensure the same exact URL is generated
   in each browser? -->

  </li></ol><p>The <dfn id="dom-canvas-toblob" title="dom-canvas-toBlob"><code>toBlob()</code></dfn>
  and <dfn id="dom-canvas-toblobhd" title="dom-canvas-toBlobHD"><code>toBlobHD()</code></dfn>
  methods must run the following steps:</p>

  <ol><!--ADD-TOPIC:Security--><li><p>If the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element's <i>origin-clean</i>
   flag is set to false, throw a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#securityerror">SecurityError</a></code> exception
   and abort these steps.</p>
<!--REMOVE-TOPIC:Security-->

   </li><li><p>Let <var title="">callback</var> be the first
   argument.</p></li>

   <li><p>Let <var title="">arguments</var> be the second and
   subsequent arguments to the method, if any.</p></li>

   <li>

    <p>If the canvas has no pixels (i.e. either its horizontal
    dimension or its vertical dimension is zero) then let <var title="">result</var> be null.</p>

    <p>Otherwise, let <var title="">result</var> be a
    <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#blob">Blob</a></code> object representing <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#a-serialization-of-the-image-as-a-file">a serialization of the
    image as a file</a>, using <var title="">arguments</var>, and
    with the <var title="">native</var> flag set if the method is the
    <code title="dom-canvas-toBlobHD"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-canvas-toblobhd">toBlobHD()</a></code> method, and
    not otherwise. <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/references.html#refsFILEAPI">[FILEAPI]</a> </p>

   </li>

   <li><p>Return, but continue running these steps
   asynchronously.</p></li>

   <li><p>If <var title="">callback</var> is null, abort these
   steps.</p></li>

   <li><p><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#queue-a-task">Queue a task</a> to invoke the
   <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#filecallback">FileCallback</a></code> <var title="">callback</var> with <var title="">result</var> as its argument. The <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#task-source">task source</a>
   for this task is the <dfn id="canvas-blob-serialization-task-source">canvas blob serialization task
   source</dfn>. <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/references.html#refsFILESYSTEMAPI">[FILESYSTEMAPI]</a></p></li>

  </ol><p>When a user agent is to create <dfn id="a-serialization-of-the-image-as-a-file">a serialization of the image
  as a file</dfn>, optionally with some given <var title="">arguments</var>, and optionally with a <var title="">native</var> flag set, it must create an image file in the
  format given by the first value of <var title="">arguments</var>,
  or, if there are no <var title="">arguments</var>, in the PNG
  format. <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/references.html#refsPNG">[PNG]</a></p>

  <p>If the <var title="">native</var> flag is set, or if the canvas
  bitmap has one pixel per coordinate space unit, then the image file
  must have the same pixel data (before compression, if applicable) as
  the canvas bitmap, and if the file format used supports encoding
  resolution metadata, the resolution of the bitmap (device pixels per
  coordinate space units being interpreted as image pixels per CSS
  pixel) must be given as well.</p>

  <p>Otherwise, the image file's pixel data must be the canvas
  bitmap's pixel data scaled to one image pixel per coordinate space
  unitl, and if the file format used supports encoding resolution
  metadata, the resolution must be given as 96dpi (one image pixel per
  CSS pixel).</p>

  <p>If <var title="">arguments</var> is not empty, the first value
  must be interpreted as a <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#mime-type" title="MIME type">MIME type</a>
  giving the format to use. If the type has any parameters, it must be
  treated as not supported.</p>

  <p class="example">For example, the value "<code>image/png</code>"
  would mean to generate a PNG image, the value
  "<code>image/jpeg</code>" would mean to generate a JPEG image, and
  the value "<code>image/svg+xml</code>" would mean to generate an SVG
  image (which would probably require that the implementation actually
  keep enough information to reliably render an SVG image from the
  canvas).</p>

  <p>User agents must support PNG ("<code>image/png</code>"). User
  agents may support other types. If the user agent does not support
  the requested type, it must create the file using the PNG format. <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/references.html#refsPNG">[PNG]</a></p>

  <p>User agents must <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#converted-to-ascii-lowercase" title="converted to ASCII
  lowercase">convert the provided type to ASCII lowercase</a>
  before establishing if they support that type.</p>

  <p>For image types that do not support an alpha channel, the
  serialized image must be the canvas image composited onto a solid
  black background using the source-over operator.</p>

  <p>If the first argument in <var title="">arguments</var> gives a
  type corresponding to one of the types given in the first column of
  the following table, and the user agent supports that type, then the
  subsequent arguments, if any, must be treated as described in the
  second cell of that row.</p>

  </div>

  <table><thead><tr><th> Type </th><th> Other arguments </th><th> Reference
   </th></tr></thead><tbody><tr><td> <code>image/jpeg</code>
     </td><td> The second argument<span class="impl">, if it</span> is a
     number in the range 0.0 to 1.0 inclusive<span class="impl">, must
     be</span> treated as the desired quality level. <span class="impl">If it is not a number or is outside that range, the
     user agent must use its default value, as if the argument had
     been omitted.</span>
     </td><td> <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/references.html#refsJPEG">[JPEG]</a>
  </td></tr></tbody></table><div class="impl">

  <p>For the purposes of these rules, an argument is considered to be
  a number if it is converted to an IDL double value by the rules for
  handling arguments of type <code title="">any</code> in the Web IDL
  specification. <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/references.html#refsWEBIDL">[WEBIDL]</a></p>

  <p>Other arguments must be ignored and must not cause the user agent
  to throw an exception. A future version of this specification will
  probably define other parameters to be passed to these methods to
  allow authors to more carefully control compression settings, image
  metadata, etc.</p>

  </div>
  <!--REMOVE-TOPIC:DOM APIs-->


  <!--2DCONTEXT-->

  <div data-component="HTML Canvas 2D Context (editor: Ian Hickson)">

  <h5 id="2dcontext"><span class="secno">4.8.11.1 </span>The 2D context</h5><div class="status REC"><p><strong>Implemented and widely deployed</strong></p><p class="idref"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#2dcontext">#2dcontext</a></p><p>Tests: 1 — <a href="http://www.whatwg.org/specs/web-apps/current-work/show-tests.html?section=2dcontext">View...</a></p><div class="implementations"><p class="IE BUG" title="Latest Internet Explorer beta: has nearly complete support for this feature, but does not yet pass all the relevant test cases">Latest Internet Explorer beta: complete but buggy support</p><p class="Firefox BUG" title="Latest Firefox trunk nightly build: has nearly complete support for this feature, but does not yet pass all the relevant test cases">Latest Firefox trunk nightly build: complete but buggy support</p><p class="Safari BUG" title="Latest WebKit or Chromium trunk build: has nearly complete support for this feature, but does not yet pass all the relevant test cases">Latest WebKit or Chromium trunk build: complete but buggy support</p><p class="Opera BUG" title="Latest Opera beta or preview build: has nearly complete support for this feature, but does not yet pass all the relevant test cases">Latest Opera beta or preview build: complete but buggy support</p><p class="Shims NONE" title="JavaScript libraries, plugins, etc: does not support this feature">JavaScript libraries, plugins, etc: unknown</p></div><p class="last-edit"><a>2012-06-06</a> <a>jay2002</a></p><p class="edit-link"><a href="http://www.whatwg.org/specs/web-apps/current-work/edit-section.html?section=2dcontext">Edit this information...</a></p></div>

  <!-- v2: we're on v5. suggestions for subsequent versions are marked v6, v7. -->

  

  <p>This specification defines the <dfn id="canvas-context-2d" title="canvas-context-2d"><code>2d</code></dfn> context type, whose
  API is implemented using the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasrenderingcontext2d">CanvasRenderingContext2D</a></code>
  interface.</p>

  <div class="impl">

  <p>When the <code title="dom-canvas-getContext"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-canvas-getcontext">getContext()</a></code>
  method of a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element is to <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#getcontext-return" title="getContext-return">return a new object for the <var title="">contextId</var></a> <code title="canvas-context-2d"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvas-context-2d">2d</a></code>, the user agent must return a
  new <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasrenderingcontext2d">CanvasRenderingContext2D</a></code> object. Any additional
  arguments are ignored.</p>

  </div>

  <p>The 2D context represents a flat Cartesian surface whose origin
  (0,0) is at the top left corner, with the coordinate space having
  <var title="">x</var> values increasing when going right, and <var title="">y</var> values increasing when going down.</p>

  <pre class="idl">interface <dfn id="canvasrenderingcontext2d">CanvasRenderingContext2D</dfn> {

  // back-reference to the canvas
  readonly attribute <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#htmlcanvaselement">HTMLCanvasElement</a> <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-canvas" title="dom-context-2d-canvas">canvas</a>;

  // state
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-save" title="dom-context-2d-save">save</a>(); // push state on state stack
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-restore" title="dom-context-2d-restore">restore</a>(); // pop state stack and restore state
<!--
  // v7 we've also received requests for:
          attribute boolean <span title="dom-context-2d-forceHighQuality">forceHighQuality</span> // (default false)
  // when enabled, it would prevent the UA from falling back on lower-quality but faster rendering routines
  // useful e.g. for when an image manipulation app uses <canvas> both for UI previews and the actual work

-->
  // transformations (default transform is the identity matrix)
           attribute <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#svgmatrix">SVGMatrix</a> <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-currenttransform" title="dom-context-2d-currentTransform">currentTransform</a>;
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-scale" title="dom-context-2d-scale">scale</a>(unrestricted double x, unrestricted double y);
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-rotate" title="dom-context-2d-rotate">rotate</a>(unrestricted double angle);
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-translate" title="dom-context-2d-translate">translate</a>(unrestricted double x, unrestricted double y);
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-transform" title="dom-context-2d-transform">transform</a>(unrestricted double a, unrestricted double b, unrestricted double c, unrestricted double d, unrestricted double e, unrestricted double f);
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-settransform" title="dom-context-2d-setTransform">setTransform</a>(unrestricted double a, unrestricted double b, unrestricted double c, unrestricted double d, unrestricted double e, unrestricted double f);
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-resettransform" title="dom-context-2d-resetTransform">resetTransform</a>();
<!--
  // v7 we've also received requests (though not many so far) for:
  void skew(...);                             // is this common enough that one can't just use setTransform()?
  void reflect(...);  and  void mirror(...);  // aren't negative values in scale() sufficient for these?

-->
  // compositing
           attribute unrestricted double <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-globalalpha" title="dom-context-2d-globalAlpha">globalAlpha</a>; // (default 1.0)
           attribute DOMString <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-globalcompositeoperation" title="dom-context-2d-globalCompositeOperation">globalCompositeOperation</a>; // (default source-over)

  // image smoothing
           attribute boolean <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-imagesmoothingenabled" title="dom-context-2d-imageSmoothingEnabled">imageSmoothingEnabled</a>; // (default true)
<!--
  // v7 we've also received requests for:
  - turning off antialiasing to avoid seams when patterns are painted next to each other
    - might be better to overdraw?
    - might be better to just draw at a higher res then downsample, like for 3d?
  - nested layers
    - the ability to composite an entire set of drawing operations with one shadow all at once
      http://lists.whatwg.org/pipermail/whatwg-whatwg.org/2008-August/015567.html

-->
  // colors and styles (see also the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasdrawingstyles">CanvasDrawingStyles</a> interface)
           attribute any <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-strokestyle" title="dom-context-2d-strokeStyle">strokeStyle</a>; // (default black)
           attribute any <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-fillstyle" title="dom-context-2d-fillStyle">fillStyle</a>; // (default black)
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasgradient">CanvasGradient</a> <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-createlineargradient" title="dom-context-2d-createLinearGradient">createLinearGradient</a>(unrestricted double x0, unrestricted double y0, unrestricted double x1, unrestricted double y1);
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasgradient">CanvasGradient</a> <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-createradialgradient" title="dom-context-2d-createRadialGradient">createRadialGradient</a>(unrestricted double x0, unrestricted double y0, unrestricted double r0, unrestricted double x1, unrestricted double y1, unrestricted double r1);
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvaspattern">CanvasPattern</a> <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-createpattern" title="dom-context-2d-createPattern">createPattern</a>((<a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/embedded-content-1.html#htmlimageelement">HTMLImageElement</a> or <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#htmlcanvaselement">HTMLCanvasElement</a> or <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#htmlvideoelement">HTMLVideoElement</a>) image, DOMString repetition);

  // shadows
           attribute unrestricted double <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-shadowoffsetx" title="dom-context-2d-shadowOffsetX">shadowOffsetX</a>; // (default 0)
           attribute unrestricted double <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-shadowoffsety" title="dom-context-2d-shadowOffsetY">shadowOffsetY</a>; // (default 0)
           attribute unrestricted double <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-shadowblur" title="dom-context-2d-shadowBlur">shadowBlur</a>; // (default 0)
           attribute DOMString <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-shadowcolor" title="dom-context-2d-shadowColor">shadowColor</a>; // (default transparent black)

  // rects
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-clearrect" title="dom-context-2d-clearRect">clearRect</a>(unrestricted double x, unrestricted double y, unrestricted double w, unrestricted double h);
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-fillrect" title="dom-context-2d-fillRect">fillRect</a>(unrestricted double x, unrestricted double y, unrestricted double w, unrestricted double h);
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-strokerect" title="dom-context-2d-strokeRect">strokeRect</a>(unrestricted double x, unrestricted double y, unrestricted double w, unrestricted double h);

  // path API (see also <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvaspathmethods">CanvasPathMethods</a>)
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-beginpath" title="dom-context-2d-beginPath">beginPath</a>();
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-fill" title="dom-context-2d-fill">fill</a>();
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-fill" title="dom-context-2d-fill">fill</a>(<a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a> path);
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-stroke" title="dom-context-2d-stroke">stroke</a>();
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-stroke" title="dom-context-2d-stroke">stroke</a>(<a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a> path);
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-drawsystemfocusring" title="dom-context-2d-drawSystemFocusRing">drawSystemFocusRing</a>(<a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#element">Element</a> element);
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-drawsystemfocusring" title="dom-context-2d-drawSystemFocusRing">drawSystemFocusRing</a>(<a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a> path, <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#element">Element</a> element);
  boolean <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-drawcustomfocusring" title="dom-context-2d-drawCustomFocusRing">drawCustomFocusRing</a>(<a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#element">Element</a> element);
  boolean <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-drawcustomfocusring" title="dom-context-2d-drawCustomFocusRing">drawCustomFocusRing</a>(<a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a> path, <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#element">Element</a> element);
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-scrollpathintoview" title="dom-context-2d-scrollPathIntoView">scrollPathIntoView</a>();
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-scrollpathintoview" title="dom-context-2d-scrollPathIntoView">scrollPathIntoView</a>(<a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a> path);
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-clip" title="dom-context-2d-clip">clip</a>();
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-clip" title="dom-context-2d-clip">clip</a>(<a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a> path);
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-resetclip" title="dom-context-2d-resetClip">resetClip</a>();
  boolean <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-ispointinpath" title="dom-context-2d-isPointInPath">isPointInPath</a>(unrestricted double x, unrestricted double y);
  boolean <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-ispointinpath" title="dom-context-2d-isPointInPath">isPointInPath</a>(<a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a> path, unrestricted double x, unrestricted double y);

  // text (see also the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasdrawingstyles">CanvasDrawingStyles</a> interface)
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-filltext" title="dom-context-2d-fillText">fillText</a>(DOMString text, unrestricted double x, unrestricted double y, optional unrestricted double maxWidth);
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-stroketext" title="dom-context-2d-strokeText">strokeText</a>(DOMString text, unrestricted double x, unrestricted double y, optional unrestricted double maxWidth);<!-- v6DVT
  void <span title="dom-context-2d-fillVerticalText">fillVerticalText</span>(DOMString text, unrestricted double x, unrestricted double y, optional unrestricted double maxHeight);
  void <span title="dom-context-2d-strokeVerticalText">strokeVerticalText</span>(DOMString text, unrestricted double x, unrestricted double y, optional unrestricted double maxHeight); -->
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#textmetrics">TextMetrics</a> <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-measuretext" title="dom-context-2d-measureText">measureText</a>(DOMString text);

  // drawing images
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-drawimage" title="dom-context-2d-drawImage">drawImage</a>((<a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/embedded-content-1.html#htmlimageelement">HTMLImageElement</a> or <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#htmlcanvaselement">HTMLCanvasElement</a> or <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#htmlvideoelement">HTMLVideoElement</a>) image, unrestricted double dx, unrestricted double dy);
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-drawimage" title="dom-context-2d-drawImage">drawImage</a>((<a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/embedded-content-1.html#htmlimageelement">HTMLImageElement</a> or <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#htmlcanvaselement">HTMLCanvasElement</a> or <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#htmlvideoelement">HTMLVideoElement</a>) image, unrestricted double dx, unrestricted double dy, unrestricted double dw, unrestricted double dh);
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-drawimage" title="dom-context-2d-drawImage">drawImage</a>((<a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/embedded-content-1.html#htmlimageelement">HTMLImageElement</a> or <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#htmlcanvaselement">HTMLCanvasElement</a> or <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#htmlvideoelement">HTMLVideoElement</a>) image, unrestricted double sx, unrestricted double sy, unrestricted double sw, unrestricted double sh, unrestricted double dx, unrestricted double dy, unrestricted double dw, unrestricted double dh);

  // hit regions
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-addhitregion" title="dom-context-2d-addHitRegion">addHitRegion</a>(<a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hitregionoptions">HitRegionOptions</a> options);
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-removehitregion" title="dom-context-2d-removeHitRegion">removeHitRegion</a>(<a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hitregionoptions">HitRegionOptions</a> options);

  // pixel manipulation
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#imagedata">ImageData</a> <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-createimagedata" title="dom-context-2d-createImageData">createImageData</a>(double sw, double sh);
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#imagedata">ImageData</a> <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-createimagedata" title="dom-context-2d-createImageData">createImageData</a>(<a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#imagedata">ImageData</a> imagedata);
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#imagedata">ImageData</a> <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-createimagedatahd" title="dom-context-2d-createImageDataHD">createImageDataHD</a>(double sw, double sh);
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#imagedata">ImageData</a> <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-getimagedata" title="dom-context-2d-getImageData">getImageData</a>(double sx, double sy, double sw, double sh);
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#imagedata">ImageData</a> <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-getimagedatahd" title="dom-context-2d-getImageDataHD">getImageDataHD</a>(double sx, double sy, double sw, double sh);
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-putimagedata" title="dom-context-2d-putImageData">putImageData</a>(<a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#imagedata">ImageData</a> imagedata, double dx, double dy);
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-putimagedatahd" title="dom-context-2d-putImageDataHD">putImageDataHD</a>(<a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#imagedata">ImageData</a> imagedata, double dx, double dy, double dirtyX, double dirtyY, double dirtyWidth, double dirtyHeight);
};
<a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasrenderingcontext2d">CanvasRenderingContext2D</a> implements <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasdrawingstyles">CanvasDrawingStyles</a>;
<a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasrenderingcontext2d">CanvasRenderingContext2D</a> implements <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvaspathmethods">CanvasPathMethods</a>;

[NoInterfaceObject]
interface <dfn id="canvasdrawingstyles">CanvasDrawingStyles</dfn> {
  // line caps/joins
           attribute unrestricted double <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-linewidth" title="dom-context-2d-lineWidth">lineWidth</a>; // (default 1)
           attribute DOMString <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-linecap" title="dom-context-2d-lineCap">lineCap</a>; // "butt", "round", "square" (default "butt")
           attribute DOMString <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-linejoin" title="dom-context-2d-lineJoin">lineJoin</a>; // "round", "bevel", "miter" (default "miter")
           attribute unrestricted double <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-miterlimit" title="dom-context-2d-miterLimit">miterLimit</a>; // (default 10)

  // dashed lines
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-setlinedash" title="dom-context-2d-setLineDash">setLineDash</a>(sequence&lt;unrestricted double&gt; segments); // default empty
  sequence&lt;unrestricted double&gt; <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-getlinedash" title="dom-context-2d-getLineDash">getLineDash</a>();
           attribute unrestricted double <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-linedashoffset" title="dom-context-2d-lineDashOffset">lineDashOffset</a>;

  // text
           attribute DOMString <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-font" title="dom-context-2d-font">font</a>; // (default 10px sans-serif)
           attribute DOMString <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textalign" title="dom-context-2d-textAlign">textAlign</a>; // "start", "end", "left", "right", "center" (default: "start")
           attribute DOMString <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textbaseline" title="dom-context-2d-textBaseline">textBaseline</a>; // "top", "hanging", "middle", "alphabetic", "ideographic", "bottom" (default: "alphabetic")
};

[NoInterfaceObject]
interface <dfn id="canvaspathmethods">CanvasPathMethods</dfn> {
  // shared path API methods
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-closepath" title="dom-context-2d-closePath">closePath</a>();
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-moveto" title="dom-context-2d-moveTo">moveTo</a>(unrestricted double x, unrestricted double y);
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-lineto" title="dom-context-2d-lineTo">lineTo</a>(unrestricted double x, unrestricted double y);
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-quadraticcurveto" title="dom-context-2d-quadraticCurveTo">quadraticCurveTo</a>(unrestricted double cpx, unrestricted double cpy, unrestricted double x, unrestricted double y);
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-beziercurveto" title="dom-context-2d-bezierCurveTo">bezierCurveTo</a>(unrestricted double cp1x, unrestricted double cp1y, unrestricted double cp2x, unrestricted double cp2y, unrestricted double x, unrestricted double y);
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-arcto" title="dom-context-2d-arcTo">arcTo</a>(unrestricted double x1, unrestricted double y1, unrestricted double x2, unrestricted double y2, unrestricted double radius); <!-- see ARC-ORDER note below -->
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-arcto" title="dom-context-2d-arcTo">arcTo</a>(unrestricted double x1, unrestricted double y1, unrestricted double x2, unrestricted double y2, unrestricted double radiusX, unrestricted double radiusY, unrestricted double rotation); <!-- see ARC-ORDER note below -->
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-rect" title="dom-context-2d-rect">rect</a>(unrestricted double x, unrestricted double y, unrestricted double w, unrestricted double h);
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-arc" title="dom-context-2d-arc">arc</a>(unrestricted double x, unrestricted double y, unrestricted double radius, unrestricted double startAngle, unrestricted double endAngle, optional boolean anticlockwise = false); <!-- see ARC-ORDER note below -->
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-ellipse" title="dom-context-2d-ellipse">ellipse</a>(unrestricted double x, unrestricted double y, unrestricted double radiusX, unrestricted double radiusY, unrestricted double rotation, unrestricted double startAngle, unrestricted double endAngle, boolean anticlockwise); <!-- see ARC-ORDER note below -->
};

interface <dfn id="canvasgradient">CanvasGradient</dfn> {
  // opaque object
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-canvasgradient-addcolorstop" title="dom-canvasgradient-addColorStop">addColorStop</a>(unrestricted double offset, DOMString color);
};

interface <dfn id="canvaspattern">CanvasPattern</dfn> {
  // opaque object
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-canvaspattern-settransform" title="dom-canvaspattern-setTransform">setTransform</a>(<a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#svgmatrix">SVGMatrix</a> transform);
};

interface <dfn id="textmetrics">TextMetrics</dfn> {
  // x-direction
  readonly attribute double <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-textmetrics-width" title="dom-textmetrics-width">width</a>; // advance width
  readonly attribute double <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-textmetrics-actualboundingboxleft" title="dom-textmetrics-actualBoundingBoxLeft">actualBoundingBoxLeft</a>;
  readonly attribute double <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-textmetrics-actualboundingboxright" title="dom-textmetrics-actualBoundingBoxRight">actualBoundingBoxRight</a>;

  // y-direction
  readonly attribute double <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-textmetrics-fontboundingboxascent" title="dom-textmetrics-fontBoundingBoxAscent">fontBoundingBoxAscent</a>;
  readonly attribute double <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-textmetrics-fontboundingboxdescent" title="dom-textmetrics-fontBoundingBoxDescent">fontBoundingBoxDescent</a>;
  readonly attribute double <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-textmetrics-actualboundingboxascent" title="dom-textmetrics-actualBoundingBoxAscent">actualBoundingBoxAscent</a>;
  readonly attribute double <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-textmetrics-actualboundingboxdescent" title="dom-textmetrics-actualBoundingBoxDescent">actualBoundingBoxDescent</a>;
  readonly attribute double <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-textmetrics-emheightascent" title="dom-textmetrics-emHeightAscent">emHeightAscent</a>;
  readonly attribute double <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-textmetrics-emheightdescent" title="dom-textmetrics-emHeightDescent">emHeightDescent</a>;
  readonly attribute double <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-textmetrics-hangingbaseline" title="dom-textmetrics-hangingBaseline">hangingBaseline</a>;
  readonly attribute double <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-textmetrics-alphabeticbaseline" title="dom-textmetrics-alphabeticBaseline">alphabeticBaseline</a>;
  readonly attribute double <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-textmetrics-ideographicbaseline" title="dom-textmetrics-ideographicBaseline">ideographicBaseline</a>;
};

dictionary <dfn id="hitregionoptions">HitRegionOptions</dfn> {
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a>? <span title="dom-HitRegionOptions-path">path</span> = null;
<!--  <span>SVGMatrix</span>? <span title="dom-HitRegionOptions-transform">transform</span> = null;
-->  <span>DOMString</span> <span title="dom-HitRegionOptions-id">id</span> = '';
  <span>DOMString</span>? <span title="dom-HitRegionOptions-parentID">parentID</span> = null;
  <span>DOMString</span> <span title="dom-HitRegionOptions-cursor">cursor</span> = 'inherit';
  // for control-backed regions:
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#element">Element</a>? <span title="dom-HitRegionOptions-control">control</span> = null;
  // for unbacked regions:
  <span>DOMString</span>? <span title="dom-HitRegionOptions-label">label</span> = null;
  <span>DOMString</span>? <span title="dom-HitRegionOptions-role">role</span> = null;
};

interface <dfn id="imagedata">ImageData</dfn> {
  readonly attribute unsigned long <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-imagedata-width" title="dom-imagedata-width">width</a>;
  readonly attribute unsigned long <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-imagedata-height" title="dom-imagedata-height">height</a>;
  readonly attribute <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#uint8clampedarray">Uint8ClampedArray</a> <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-imagedata-data" title="dom-imagedata-data">data</a>;
};

[<a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-drawingstyle" title="dom-DrawingStyle">Constructor</a>(optional <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#element">Element</a> scope)]
interface <dfn id="drawingstyle">DrawingStyle</dfn> { };
<a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#drawingstyle">DrawingStyle</a> implements <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasdrawingstyles">CanvasDrawingStyles</a>;

[<a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-path" title="dom-Path">Constructor</a>,
 <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-path-copy" title="dom-Path-copy">Constructor</a>(<a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a> path),
 <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-path-withdata" title="dom-Path-withdata">Constructor</a>(DOMString d)]
interface <dfn id="path">Path</dfn> {
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-path-addpath" title="dom-path-addPath">addPath</a>(<a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a> path, <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#svgmatrix">SVGMatrix</a>? transformation);
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-path-addpathbystrokingpath" title="dom-path-addPathByStrokingPath">addPathByStrokingPath</a>(<a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a> path, <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasdrawingstyles">CanvasDrawingStyles</a> styles, <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#svgmatrix">SVGMatrix</a>? transformation);
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-path-addtext" title="dom-path-addText">addText</a>(DOMString text, <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasdrawingstyles">CanvasDrawingStyles</a> styles, <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#svgmatrix">SVGMatrix</a>? transformation, unrestricted double x, unrestricted double y, optional unrestricted double maxWidth);
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-path-addpathbystrokingtext" title="dom-path-addPathByStrokingText">addPathByStrokingText</a>(DOMString text, <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasdrawingstyles">CanvasDrawingStyles</a> styles, <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#svgmatrix">SVGMatrix</a>? transformation, unrestricted double x, unrestricted double y, optional unrestricted double maxWidth);
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-path-addtext" title="dom-path-addText">addText</a>(DOMString text, <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasdrawingstyles">CanvasDrawingStyles</a> styles, <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#svgmatrix">SVGMatrix</a>? transformation, <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a> path, optional unrestricted double maxWidth);
  void <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-path-addpathbystrokingtext" title="dom-path-addPathByStrokingText">addPathByStrokingText</a>(DOMString text, <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasdrawingstyles">CanvasDrawingStyles</a> styles, <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#svgmatrix">SVGMatrix</a>? transformation, <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a> path, optional unrestricted double maxWidth);
};
<a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a> implements <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvaspathmethods">CanvasPathMethods</a>;</pre>

 <!-- ARC-ORDER note (see above):
      some demos rely on the precise order of the arc() and arcTo()
      methods, see https://bugzilla.mozilla.org/show_bug.cgi?id=623437
      for an example, and its duplicates for more -->

  <dl class="domintro"><dt><var title="">context</var> . <code title="dom-context-2d-canvas"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-canvas">canvas</a></code></dt>

   <dd>

    <p>Returns the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element.</p>

   </dd>

  </dl><div class="impl">

  <p>The <dfn id="dom-context-2d-canvas" title="dom-context-2d-canvas"><code>canvas</code></dfn>
  attribute must return the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element that the
  context paints on.</p>

  <p>Except where otherwise specified, for the 2D context interface,
  <strong>any method call with a numeric argument whose value is
  infinite or a NaN value must be ignored</strong>.</p>

  <!--
   Philip Taylor wrote:
   > My experience with some 3d canvas code is that infinities come up in
   > naturally harmless places, e.g. having a function that scales by x then
   > translates by 1/x and wanting it to work when x=0 (which ought to draw
   > nothing, since anything it draws is zero pixels wide), and it's a bit
   > annoying to track down and fix those issues, so I'd probably like it if
   > they were harmless in canvas methods. Opera appears to silently not draw
   > anything if the transformation matrix is not finite, but Firefox throws
   > exceptions when passing in non-finite arguments.
  -->

  <p>Whenever the CSS value <code title="">currentColor</code> is used
  as a color in this API, the "computed value of the 'color' property"
  for the purposes of determining the computed value of the <code title="">currentColor</code> keyword is the computed value of the
  'color' property on the element in question at the time that the
  color is specified (e.g. when the appropriate attribute is set, or
  when the method is called; not when the color is rendered or
  otherwise used). If the computed value of the 'color' property is
  undefined for a particular case (e.g. because the element is not
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#in-a-document">in a <code>Document</code></a>), then the "computed value
  of the 'color' property" for the purposes of determining the
  computed value of the <code title="">currentColor</code> keyword is
  fully opaque black. <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/references.html#refsCSSCOLOR">[CSSCOLOR]</a></p>

  <p>In the case of <code title="dom-canvasgradient-addColorStop"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-canvasgradient-addcolorstop">addColorStop()</a></code> on
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasgradient">CanvasGradient</a></code>, the "computed value of the 'color'
  property" for the purposes of determining the computed value of the
  <code title="">currentColor</code> keyword is always fully opaque
  black (there is no associated element). <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/references.html#refsCSSCOLOR">[CSSCOLOR]</a></p>

  <p class="note">This is because <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasgradient">CanvasGradient</a></code> objects
  are <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code>-neutral — a
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasgradient">CanvasGradient</a></code> object created by one
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> can be used by another, and there is therefore
  no way to know which is the "element in question" at the time that
  the color is specified.</p>

  <p class="note">Similar concerns exist with font-related properties;
  the rules for those are described in detail in the relevant section
  below.</p>

  </div>


  <h6 id="resolution"><span class="secno">4.8.11.1.1 </span>Resolution</h6>

  <p>The user agent may use a bitmap of any square resolution as the
  backing store for a canvas that uses the 2D context. Once a canvas
  has a bitmap, that canvas must keep its resolution for its
  lifetime.</p>

  <p class="note">In general, user agents are encouraged to use a
  resolution equal to the screen resolution. Ideally, the number of
  device pixels per CSS pixel would be a multiple of two. Several
  factors can affect the screen resolution: most prominently the
  actual display resolution, but also important is the current zoom
  level.</p>

  <p>All the bitmaps created during a single <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#concept-task" title="concept-task">task</a> for canvases that use 2D contexts
  must have the same resolution.
  <a class="fingerprint" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/introduction.html#fingerprint"><img alt="(This is a fingerprinting vector.)" src="./4.8.11 The canvas element — HTML Standard_files/fingerprint.png"></a>
  </p>

  <pre class="idl">partial interface <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#screen">Screen</a> {
  readonly attribute double <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-screen-canvasresolution" title="dom-screen-canvasResolution">canvasResolution</a>;
};</pre>

  <dl class="domintro"><dt><var title="">window</var> . <code title="dom-Window-screen">screen</code> . <code title="dom-screen-canvasResolution"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-screen-canvasresolution">canvasResolution</a></code></dt>

   <dd>

    <p>Returns the resolution that has been, or will be, used for bitmaps during this <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#concept-task" title="concept-task">task</a>.</p>

   </dd>

  </dl><div class="impl">

  <p>The <dfn id="dom-screen-canvasresolution" title="dom-screen-canvasResolution"><code>canvasResolution</code></dfn>
  attribute of the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#screen">Screen</a></code> object must return the
  resolution, in image pixels per coordinate space units, that any
  canvas bitmaps created during this <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#concept-task" title="concept-task">task</a> will use (or have used). <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/references.html#refsCSSOMVIEW">[CSSOMVIEW]</a></p>

  </div>



  <h6 id="the-canvas-state"><span class="secno">4.8.11.1.2 </span>The canvas state</h6><div class="status LC"><p><strong>Ready for first implementations</strong></p><p class="idref"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-state">#the-canvas-state</a></p><div class="implementations"><p class="IE NONE" title="Latest Internet Explorer beta: does not support this feature">Latest Internet Explorer beta: unknown</p><p class="Firefox NONE" title="Latest Firefox trunk nightly build: does not support this feature">Latest Firefox trunk nightly build: unknown</p><p class="Safari NONE" title="Latest WebKit or Chromium trunk build: does not support this feature">Latest WebKit or Chromium trunk build: unknown</p><p class="Opera NONE" title="Latest Opera beta or preview build: does not support this feature">Latest Opera beta or preview build: unknown</p><p class="Shims NONE" title="JavaScript libraries, plugins, etc: does not support this feature">JavaScript libraries, plugins, etc: unknown</p></div><p class="last-edit"><a>2009-10-23</a> <a>Hixie</a></p><p class="edit-link"><a href="http://www.whatwg.org/specs/web-apps/current-work/edit-section.html?section=the-canvas-state">Edit this information...</a></p></div>

  <p>Each context maintains a stack of drawing states. <dfn id="drawing-state" title="drawing state">Drawing states</dfn> consist of:</p>

  <ul class="brief"><li>The current <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#transformations" title="dom-context-2d-transformation">transformation matrix</a>.</li>
   <li>The current <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#clipping-region">clipping region</a>.</li>
   <li>The current values of the following attributes: <code title="dom-context-2d-strokeStyle"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-strokestyle">strokeStyle</a></code>, <code title="dom-context-2d-fillStyle"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-fillstyle">fillStyle</a></code>, <code title="dom-context-2d-globalAlpha"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-globalalpha">globalAlpha</a></code>, <code title="dom-context-2d-lineWidth"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-linewidth">lineWidth</a></code>, <code title="dom-context-2d-lineCap"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-linecap">lineCap</a></code>, <code title="dom-context-2d-lineJoin"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-linejoin">lineJoin</a></code>, <code title="dom-context-2d-miterLimit"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-miterlimit">miterLimit</a></code>, <code title="dom-context-2d-lineDashOffset"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-linedashoffset">lineDashOffset</a></code>, <code title="dom-context-2d-shadowOffsetX"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-shadowoffsetx">shadowOffsetX</a></code>, <code title="dom-context-2d-shadowOffsetY"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-shadowoffsety">shadowOffsetY</a></code>, <code title="dom-context-2d-shadowBlur"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-shadowblur">shadowBlur</a></code>, <code title="dom-context-2d-shadowColor"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-shadowcolor">shadowColor</a></code>, <code title="dom-context-2d-globalCompositeOperation"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-globalcompositeoperation">globalCompositeOperation</a></code>, <code title="dom-context-2d-font"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-font">font</a></code>, <code title="dom-context-2d-textAlign"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textalign">textAlign</a></code>, <code title="dom-context-2d-textBaseline"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textbaseline">textBaseline</a></code>, <code title="dom-context-2d-imageSmoothingEnabled"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-imagesmoothingenabled">imageSmoothingEnabled</a></code>.</li>
   <li>The current <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dash-list">dash list</a>.</li>
  </ul><p class="note">The <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#current-default-path">current default path</a> and the
  current bitmap are not part of the drawing state. The <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#current-default-path">current
  default path</a> is persistent, and can only be reset using the
  <code title="dom-context-2d-beginPath"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-beginpath">beginPath()</a></code> method.
  The current bitmap is a property of the canvas, not the context.</p>

  <dl class="domintro"><dt><var title="">context</var> . <code title="dom-context-2d-save"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-save">save</a></code>()</dt>

   <dd>

    <p>Pushes the current state onto the stack.</p>

   </dd>

   <dt><var title="">context</var> . <code title="dom-context-2d-restore"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-restore">restore</a></code>()</dt>

   <dd>

    <p>Pops the top state on the stack, restoring the context to that state.</p>

   </dd>

  </dl><div class="impl">

  <p>The <dfn id="dom-context-2d-save" title="dom-context-2d-save"><code>save()</code></dfn>
  method must push a copy of the current drawing state onto the
  drawing state stack.</p>

  <p>The <dfn id="dom-context-2d-restore" title="dom-context-2d-restore"><code>restore()</code></dfn> method
  must pop the top entry in the drawing state stack, and reset the
  drawing state it describes. If there is no saved state, the method
  must do nothing.</p>

  <!-- v7
idea from Mihai:
> 5. Drawing states should be saveable with IDs, and for easier restoring.
>
> save(id)
> restore(id)
>
> If id is not provided, then save() works as defined now. The same for
> restore().
>
> Currently, it's not trivial to save and restore a specific state.
...and from Philip:
> I think a more convenient syntax would be:
>   var state = ctx.save();
>   ctx.restore(state);
> But how would it interact with normal calls to ctx.restore()?
  -->

  </div>


  <h6 id="drawingstyle-objects"><span class="secno">4.8.11.1.3 </span><code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#drawingstyle">DrawingStyle</a></code> objects</h6>

  <p>All the line styles (line width, caps, joins, and dash patterns)
  and text styles (fonts) described in the next two sections apply to
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasrenderingcontext2d">CanvasRenderingContext2D</a></code> objects and to
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#drawingstyle">DrawingStyle</a></code> objects. This section defines the
  constructor used to obtain a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#drawingstyle">DrawingStyle</a></code> object. This
  object is then used by methods on <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a></code> objects to
  control how text and paths are rasterised and stroked.</p>

  <dl class="domintro"><dt><var title="">styles</var> = new <code title="dom-DrawingStyle"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-drawingstyle">DrawingStyle</a></code>( [ <var title="">element</var> ] )</dt>

   <dd>

    <p>Creates a new <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#drawingstyle">DrawingStyle</a></code> object, optionally
    using a specific element for resolving relative keywords and sizes
    in font specifications.</p>

   </dd>

  </dl><div class="impl">

  <p>Each <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#drawingstyle">DrawingStyle</a></code> object has a <dfn id="styles-scope-node">styles scope
  node</dfn>.</p>

  <p>The <dfn id="dom-drawingstyle" title="dom-DrawingStyle"><code>DrawingStyle()</code></dfn>
  constructor, when invoked, must return a newly created
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#drawingstyle">DrawingStyle</a></code> object. If the constructor was passed an
  argument, then the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#drawingstyle">DrawingStyle</a></code> object's <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#styles-scope-node">styles
  scope node</a> is that element. Otherwise, the object's
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#styles-scope-node">styles scope node</a> is the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/dom.html#document">Document</a></code> object
  of the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/browsers.html#active-document">active document</a> of the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/browsers.html#browsing-context">browsing
  context</a> of the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/browsers.html#window">Window</a></code> object on which the
  interface object of the invoked constructor is found.</p>

  </div>


  <h6 id="line-styles"><span class="secno">4.8.11.1.4 </span>Line styles</h6><div class="status LC"><p><strong>Ready for first implementations</strong></p><p class="idref"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#line-styles">#line-styles</a></p><div class="implementations"><p class="IE NONE" title="Latest Internet Explorer beta: does not support this feature">Latest Internet Explorer beta: unknown</p><p class="Firefox BUG" title="Latest Firefox trunk nightly build: has nearly complete support for this feature, but does not yet pass all the relevant test cases">Latest Firefox trunk nightly build: complete but buggy support</p><p class="Safari BUG" title="Latest WebKit or Chromium trunk build: has nearly complete support for this feature, but does not yet pass all the relevant test cases">Latest WebKit or Chromium trunk build: complete but buggy support</p><p class="Opera BUG" title="Latest Opera beta or preview build: has nearly complete support for this feature, but does not yet pass all the relevant test cases">Latest Opera beta or preview build: complete but buggy support</p><p class="Shims NONE" title="JavaScript libraries, plugins, etc: does not support this feature">JavaScript libraries, plugins, etc: unknown</p></div><p class="last-edit"><a>2009-10-23</a> <a>Hixie</a></p><p class="edit-link"><a href="http://www.whatwg.org/specs/web-apps/current-work/edit-section.html?section=line-styles">Edit this information...</a></p></div>

  <dl class="domintro"><dt><var title="">context</var> . <code title="dom-context-2d-lineWidth"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-linewidth">lineWidth</a></code> [ = <var title="">value</var> ]</dt>
   <dt><var title="">styles</var> . <code title="dom-context-2d-lineWidth"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-linewidth">lineWidth</a></code> [ = <var title="">value</var> ]</dt>

   <dd>

    <p>Returns the current line width.</p>

    <p>Can be set, to change the line width. Values that are not
    finite values greater than zero are ignored.</p>

   </dd>

   <dt><var title="">context</var> . <code title="dom-context-2d-lineCap"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-linecap">lineCap</a></code> [ = <var title="">value</var> ]</dt>
   <dt><var title="">styles</var> . <code title="dom-context-2d-lineCap"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-linecap">lineCap</a></code> [ = <var title="">value</var> ]</dt>

   <dd>

    <p>Returns the current line cap style.</p>

    <p>Can be set, to change the line cap style.</p>

    <p>The possible line cap styles are <code>butt</code>,
    <code>round</code>, and <code>square</code>. Other values are
    ignored.</p>

   </dd>

   <dt><var title="">context</var> . <code title="dom-context-2d-lineJoin"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-linejoin">lineJoin</a></code> [ = <var title="">value</var> ]</dt>
   <dt><var title="">styles</var> . <code title="dom-context-2d-lineJoin"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-linejoin">lineJoin</a></code> [ = <var title="">value</var> ]</dt>

   <dd>

    <p>Returns the current line join style.</p>

    <p>Can be set, to change the line join style.</p>

    <p>The possible line join styles are <code>bevel</code>,
    <code>round</code>, and <code>miter</code>. Other values are
    ignored.</p>

   </dd>

   <dt><var title="">context</var> . <code title="dom-context-2d-miterLimit"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-miterlimit">miterLimit</a></code> [ = <var title="">value</var> ]</dt>
   <dt><var title="">styles</var> . <code title="dom-context-2d-miterLimit"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-miterlimit">miterLimit</a></code> [ = <var title="">value</var> ]</dt>

   <dd>

    <p>Returns the current miter limit ratio.</p>

    <p>Can be set, to change the miter limit ratio. Values that are
    not finite values greater than zero are ignored.</p>

   </dd>


   <dt><var title="">context</var> . <code title="dom-context-2d-setLineDash"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-setlinedash">setLineDash</a></code>(<var title="">segments</var>)</dt>
   <dt><var title="">styles</var> . <code title="dom-context-2d-setLineDash"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-setlinedash">setLineDash</a></code>(<var title="">segments</var>)</dt>

   <dd>

    <p>Sets the current line dash pattern (as used when stroking). The
    argument is an array of distances for which to alternately have
    the line on and the line off.</p>

   </dd>


   <dt><var title="">segments</var> = <var title="">context</var> . <code title="dom-context-2d-getLineDash"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-getlinedash">getLineDash</a></code>()</dt>
   <dt><var title="">segments</var> = <var title="">styles</var> . <code title="dom-context-2d-getLineDash"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-getlinedash">getLineDash</a></code>()</dt>

   <dd>

    <p>Returns a copy of the current line dash pattern. The array
    returned will always have an even number of entries (i.e. the
    pattern is normalized).</p>

   </dd>


   <dt><var title="">context</var> . <code title="dom-context-2d-lineDashOffset"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-linedashoffset">lineDashOffset</a></code></dt>
   <dt><var title="">styles</var> . <code title="dom-context-2d-lineDashOffset"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-linedashoffset">lineDashOffset</a></code></dt>

   <dd>

    <p>Returns the phase offset (in the same units as the line dash pattern).</p>

    <p>Can be set, to change the phase offset. Values that are not
    finite values are ignored.</p>

   </dd>

  </dl><div class="impl">

  <p>Objects that implement the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasdrawingstyles">CanvasDrawingStyles</a></code>
  interface have attributes and methods (defined in this section) that
  control how lines are treated by the object.</p>

  <p>The <dfn id="dom-context-2d-linewidth" title="dom-context-2d-lineWidth"><code>lineWidth</code></dfn>
  attribute gives the width of lines, in coordinate space units. On
  getting, it must return the current value. On setting, zero,
  negative, infinite, and NaN values must be ignored, leaving the
  value unchanged; other values must change the current value to the
  new value.</p>

  <p>When the object implementing the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasdrawingstyles">CanvasDrawingStyles</a></code>
  interface is created, the <code title="dom-context-2d-lineWidth"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-linewidth">lineWidth</a></code> attribute must
  initially have the value <code>1.0</code>.</p>

  <hr><p>The <dfn id="dom-context-2d-linecap" title="dom-context-2d-lineCap"><code>lineCap</code></dfn> attribute
  defines the type of endings that UAs will place on the end of lines.
  The three valid values are <code>butt</code>, <code>round</code>,
  and <code>square</code>.</p>

  <p>On getting, it must return the current value. On setting, if the
  new value is one of the literal strings <code>butt</code>,
  <code>round</code>, and <code>square</code>, then the current value
  must be changed to the new value; other values must ignored, leaving
  the value unchanged.</p>

  <p>When the object implementing the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasdrawingstyles">CanvasDrawingStyles</a></code>
  interface is created, the <code title="dom-context-2d-lineCap"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-linecap">lineCap</a></code> attribute must
  initially have the value <code>butt</code>.</p>

  <hr><p>The <dfn id="dom-context-2d-linejoin" title="dom-context-2d-lineJoin"><code>lineJoin</code></dfn>
  attribute defines the type of corners that UAs will place where two
  lines meet. The three valid values are <code>bevel</code>,
  <code>round</code>, and <code>miter</code>.</p>

  <p>On getting, it must return the current value. On setting, if the
  new value is one of the literal strings <code>bevel</code>,
  <code>round</code>, and <code>miter</code>, then the current value
  must be changed to the new value; other values must be ignored,
  leaving the value unchanged.</p>

  <p>When the object implementing the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasdrawingstyles">CanvasDrawingStyles</a></code>
  interface is created, the <code title="dom-context-2d-lineJoin"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-linejoin">lineJoin</a></code> attribute must
  initially have the value <code>miter</code>.</p>

  <hr><p>When the <code title="dom-context-2d-lineJoin"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-linejoin">lineJoin</a></code>
  attribute has the value <code>miter</code>, strokes use the miter
  limit ratio to decide how to render joins. The miter limit ratio can
  be explicitly set using the <dfn id="dom-context-2d-miterlimit" title="dom-context-2d-miterLimit"><code>miterLimit</code></dfn>
  attribute. On getting, it must return the current value. On setting,
  zero, negative, infinite, and NaN values must be ignored, leaving
  the value unchanged; other values must change the current value to
  the new value.</p>

  <p>When the object implementing the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasdrawingstyles">CanvasDrawingStyles</a></code>
  interface is created, the <code title="dom-context-2d-miterLimit"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-miterlimit">miterLimit</a></code> attribute must
  initially have the value <code>10.0</code>.</p>

  <hr><p>Each <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasdrawingstyles">CanvasDrawingStyles</a></code> object has a <dfn id="dash-list">dash
  list</dfn>, which is either empty or consists of an even number of
  non-negative numbers. Initially, the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dash-list">dash list</a> must be
  empty.</p>

  <p>When the <dfn id="dom-context-2d-setlinedash" title="dom-context-2d-setLineDash"><code>setLineDash()</code></dfn>
  method is invoked, it must run the following steps:</p>

  <ol><li><p>Let <var title="">a</var> be a copy of the array provided as
   the argument.</p></li>

   <li><p>If any value in the array is not finite (e.g. an Infinity or
   a NaN value), or if any value is negative (less than zero), then
   abort these steps.</p></li>

   <li><p>If the number of elements in <var title="">a</var> is odd,
   then let <var title="">a</var> be the concatentation of two copies
   of <var title="">a</var>.</p></li>

   <li><p>Let the object's <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dash-list">dash list</a> be <var title="">a</var>.</p></li>

  </ol><p>When the <dfn id="dom-context-2d-getlinedash" title="dom-context-2d-getLineDash"><code>getLineDash()</code></dfn>
  method is invoked, it must return a newly created array whose values
  are the values of the object's <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dash-list">dash list</a>, in the same
  order.</p>

  <p>It is sometimes useful to change the "phase" of the dash pattern,
  e.g. to achieve a "marching ants" effect. The phase can be set using
  the <dfn id="dom-context-2d-linedashoffset" title="dom-context-2d-lineDashOffset"><code>lineDashOffset</code></dfn>
  attribute. On getting, it must return the current value. On setting,
  infinite and NaN values must be ignored, leaving the value
  unchanged; other values must change the current value to the new
  value.</p>

  <p>When the object implementing the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasdrawingstyles">CanvasDrawingStyles</a></code>
  interface is created, the <code title="dom-context-2d-lineDashOffset"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-linedashoffset">lineDashOffset</a></code>
  attribute must initially have the value <code>0.0</code>.</p>

  <hr><p>When a user agent is to <dfn id="trace-a-path">trace a <span>path</span></dfn>,
  given an object <var title="">style</var> that implements the
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasdrawingstyles">CanvasDrawingStyles</a></code> interface, it must run the following
  algorithm. This algorithm returns a new <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">path</a>.</p>

  <ol><li><p>Let <var title="">path</var> be a copy of the path being
   traced.</p></li>

   <li><p>Remove from <var title="">path</var> any subpaths containing
   no lines (i.e. empty subpaths with zero points, and subpaths with
   just one point).</p></li>

   <li><p>Replace each point in each subpath of <var title="">path</var> other than the first point and the last point
   of each subpath by a <i>join</i> that joins the line leading to
   that point to the line leading out of that point, such that the
   subpaths all consist of two points (a starting point with a line
   leading out of it, and an ending point with a line leading into
   it), one or more lines (connecting the points and the joins), and
   zero or more joins (each connecting one line to another), connected
   together such that each subpath is a series of one or more lines
   with a join between each one and a point on each end.</p></li>

   <li><p>Add a straight closing line to each closed subpath in <var title="">path</var> connecting the last point and the first point
   of that subpath; change the last point to a join (from the
   previously last line to the newly added closing line), and change
   the first point to a join (from the newly added closing line to the
   first line).</p>

   </li><li><p>If the <var title="">styles</var> <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dash-list">dash list</a> is
   empty, jump to the step labeled <i>joins</i>.</p></li>

   <li><p>Let <var title="">width</var> be the aggregate length of all
   the lines of all the subpaths in <var title="">path</var>, in
   coordinate space units.</p></li>

   <li><p>Let <var title="">offset</var> be the value of the <var title="">styles</var> <code title="dom-context-2d-lineDashOffset"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-linedashoffset">lineDashOffset</a></code>, in
   coordinate space units.</p></li>

   <li>

    <p>While <var title="">offset</var> is greater than <var title="">width</var>, decrement it by <var title="">width</var>.</p>

    <p>While <var title="">offset</var> is less than <var title="">width</var>, increment it by <var title="">width</var>.</p>

   </li>

   <li><p><i>Offset subpath</i>: If <var title="">offset</var> is
   non-zero, add a new subpath at the start of <var title="">path</var> consisting of two points connected by a line
   whose length is <var title="">offset</var> coordinate space units.
   (This path is temporary and will be removed in the <i>joins</i>
   step below. Its purpose is to offset the dash pattern.)</p>

   </li><li><p>Define <var title="">L</var> to be a linear coordinate line
   defined along all lines in all the subpaths in <var title="">path</var>, such that the start of the first line in the
   first subpath is defined as coordinate 0, and the end of the last
   line in the last subpath is defined as coordinate <var title="">width</var>.</p></li>

   <li><p>Let <var title="">position</var> be 0.</p></li>

   <li><p>Let <var title="">index</var> be 0.</p></li>

   <li><p>Let <var title="">current state</var> be <i>off</i> (the
   other states being <i>on</i> and <i>zero-on</i>).</p></li>

   <li><p><i>Dash On</i>: Let <var title="">segment length</var> be
   the value of the <var title="">styles</var> <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dash-list">dash
   list</a>'s <var title="">index</var>th entry.</p></li>

   <li><p>Increment <var title="">position</var> by <var title="">segment length</var>.</p></li>

   <li><p>If <var title="">position</var> is greater than <var title="">width</var>, then jump to the step labeled
   <i>joins</i>.</p></li>

   <li><p>If <var title="">segment length</var> is non-zero, let <var title="">current state</var> be <i>on</i>.</p></li>

   <li><p>Increment <var title="">index</var> by one.</p></li>

   <li><p><i>Dash Off</i>: Let <var title="">segment length</var> be
   the value of the <var title="">styles</var> <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dash-list">dash
   list</a>'s <var title="">index</var>th entry.</p></li>

   <li><p>Let <var title="">start</var> be the offset <var title="">position</var> on <var title="">L</var>.</p></li>

   <li><p>Increment <var title="">position</var> by <var title="">segment length</var>.</p></li>

   <li><p>If <var title="">position</var> is greater than <var title="">width</var>, then let <var title="">end</var> be the
   offset <var title="">width</var> on <var title="">L</var>.
   Otherwise, let <var title="">end</var> be the offset <var title="">position</var> on <var title="">L</var>.</p></li>

   <li>

    <p>Jump to the first appropriate step:</p>

    <dl class="switch"><dt>If <var title="">segment length</var> is zero and <var title="">current state</var> is <i>off</i></dt>

     <dd>

      <p>Do nothing, just continue to the next step.</p>

     </dd>


     <dt>If <var title="">current state</var> is <i>off</i></dt>

     <dd>

      <p>Cut the line on which <var title="">end</var> finds itself
      short at <var title="">end</var> and place a point there,
      cutting the subpath that it was in in two; remove all line
      segments, joins, points, and subpaths that are between <var title="">start</var> and <var title="">end</var>; and finally
      place a single point at <var title="">start</var> with no lines
      connecting to it.</p>

      <p>The point has a <i>directionality</i> for the purposes of
      drawing line caps (see below). The directionality is the
      direction that the original line had at that point (i.e. when
      <var title="">L</var> was defined above).</p>

     </dd>


     <dt>Otherwise</dt>

     <dd>

      <p>Cut the line on which <var title="">start</var> finds itself
      into two at <var title="">start</var> and place a point there,
      cutting the subpath that it was in in two, and similarly cut the
      line on which <var title="">end</var> finds itself short at <var title="">end</var> and place a point there, cutting the subpath
      that <em>it</em> was in in two, and then remove all line segments,
      joins, points, and subpaths that are between <var title="">start</var> and <var title="">end</var>.</p>

      <p>If <var title="">start</var> and <var title="">end</var> are
      the same point, then this results in just the line being cut in
      two and two points being inserted there, with nothing being
      removed, unless a join also happens to be at that point, in which
      case the join must be removed.</p>

     </dd>

    </dl></li>

   <li><p>If <var title="">position</var> is greater than <var title="">width</var>, then jump to the step labeld
   <i>joins</i>.</p></li>

   <li><p>If <var title="">segment length</var> is greater than zero,
   let <var title="">positioned-at-on-dash</var> be false.</p></li>

   <li><p>Increment <var title="">index</var> by one. If it is equal
   to the number of entries in the <var title="">styles</var>
   <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dash-list">dash list</a>, then let <var title="">index</var> be
   0.</p></li>

   <li><p>Return to the step labeled <i>dash on</i>.</p></li>

   <li><p><i>Joins</i>: Remove from <var title="">path</var> any
   subpath that originally formed part of the subpath added in the
   <i>offset subpath</i> step above.</p></li>

   <li>

    <p>Create a new <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">path</a> that describes the result of
    inflating the paths in <var title="">path</var> perpendicular to
    the direction of the path to the <var title="">styles</var> <code title="dom-context-2d-lineWidth"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-linewidth">lineWidth</a></code> width, replacing
    each point with the end cap necessary to satisfy the <var title="">styles</var> <code title="dom-context-2d-lineCap"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-linecap">lineCap</a></code> attribute as
    described previously and elaborated below, and replacing each join
    with the join necessary to satisfy the <var title="">styles</var>
    <code title="dom-context-2d-lineJoin"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-linejoin">lineJoin</a></code> type, as
    defined below.</p>

    <p><strong>Caps</strong>: Each point has a flat edge perpendicular
    to the direction of the line coming out of it. This is them
    augmented according to the value of the <var title="">styles</var>
    <code title="dom-context-2d-lineCap"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-linecap">lineCap</a></code>. The
    <code>butt</code> value means that no additional line cap is
    added. The <code>round</code> value means that a semi-circle with
    the diameter equal to the <var title="">styles</var> <code title="dom-context-2d-lineWidth"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-linewidth">lineWidth</a></code> width must
    additionally be placed on to the line coming out of each point.
    The <code>square</code> value means that a rectangle with the
    length of the <var title="">styles</var> <code title="dom-context-2d-lineWidth"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-linewidth">lineWidth</a></code> width and the
    width of half the <var title="">styles</var> <code title="dom-context-2d-lineWidth"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-linewidth">lineWidth</a></code> width, placed
    flat against the edge perpendicular to the direction of the line
    coming out of the point, must be added at each point.</p>

    <p>Points with no lines coming out of them must have two caps
    placed back-to-back as if it was really two points connected to
    each other by an infinitesimally short straight line in the
    direction of the point's <i>directionality</i> (as defined
    above).</p>

    <p><strong>Joins</strong>: In addition to the point where a join
    occurs, two additional points are relevant to each join, one for
    each line: the two corners found half the line width away from the
    join point, one perpendicular to each line, each on the side
    furthest from the other line.</p>

    <p>A filled triangle connecting these two opposite corners with a
    straight line, with the third point of the triangle being the join
    point, must be added at all joins. The <code title="dom-context-2d-lineJoin"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-linejoin">lineJoin</a></code> attribute controls
    whether anything else is rendered. The three aforementioned values
    have the following meanings:</p>

    <p>The <code>bevel</code> value means that this is all that is
    rendered at joins.</p>

    <p>The <code>round</code> value means that a filled arc connecting
    the two aforementioned corners of the join, abutting (and not
    overlapping) the aforementioned triangle, with the diameter equal
    to the line width and the origin at the point of the join, must be
    added at joins.</p>

    <p>The <code>miter</code> value means that a second filled
    triangle must (if it can given the miter length) be added at the
    join, with one line being the line between the two aforementioned
    corners, abutting the first triangle, and the other two being
    continuations of the outside edges of the two joining lines, as
    long as required to intersect without going over the miter
    length.</p>

    <p>The miter length is the distance from the point where the join
    occurs to the intersection of the line edges on the outside of the
    join. The miter limit ratio is the maximum allowed ratio of the
    miter length to half the line width. If the miter length would
    cause the miter limit ratio (as set by the <var title="">style</var> <code title="dom-context-2d-miterLimit"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-miterlimit">miterLimit</a></code> attribute) to
    be exceeded, this second triangle must not be added.</p>

    <p>Subpaths in the newly created path must wind clockwise,
    regardless of the direction of paths in <var title="">path</var>.</p>
    <!--
     ...because both of these examples result in two lines (assuming
     non-zero winding rules, things are different under even/odd),
     there's no "hole" where the lines overlap:

            c.beginPath();
            c.lineWidth=30;
            c.moveTo(200,200); // subpath 1
            c.lineTo(400,200);
            c.moveTo(400,210); // subpath 2
            c.lineTo(200,190);
            c.stroke();

            c.beginPath();
            c.lineWidth=30;
            c.moveTo(200,200); // subpath 1
            c.lineTo(400,200);
            c.lineTo(300,300);
            c.closePath();
            c.moveTo(400,210); // subpath 2
            c.lineTo(200,190);
            c.lineTo(300,300);
            c.closePath();
            c.stroke();

     ...and we want the same result when you create the two subpaths
     in each example above as two Paths, stroke them onto a third
     Path, and then fill that Path on the context.
    -->

   </li>

   <li><p>Return the newly created path.</p></li>

  </ol><!--v6: Another request has been for hairline width lines, that remain
hairline width with transform. ack Shaun Morris.  --></div>


  <h6 id="text-styles"><span class="secno">4.8.11.1.5 </span>Text styles</h6><div class="status REC"><p><strong>Implemented and widely deployed</strong></p><p class="idref"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#text-styles">#text-styles</a></p><div class="implementations"><p class="IE NONE" title="Latest Internet Explorer beta: does not support this feature">Latest Internet Explorer beta: unknown</p><p class="Firefox NONE" title="Latest Firefox trunk nightly build: does not support this feature">Latest Firefox trunk nightly build: unknown</p><p class="Safari NONE" title="Latest WebKit or Chromium trunk build: does not support this feature">Latest WebKit or Chromium trunk build: unknown</p><p class="Opera NONE" title="Latest Opera beta or preview build: does not support this feature">Latest Opera beta or preview build: unknown</p><p class="Shims NONE" title="JavaScript libraries, plugins, etc: does not support this feature">JavaScript libraries, plugins, etc: unknown</p></div><p class="last-edit"><a>2012-03-26</a> <a>Hixie</a></p><p class="edit-link"><a href="http://www.whatwg.org/specs/web-apps/current-work/edit-section.html?section=text-styles">Edit this information...</a></p></div>

  <dl class="domintro"><dt><var title="">context</var> . <code title="dom-context-2d-font"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-font">font</a></code> [ = <var title="">value</var> ]</dt>
   <dt><var title="">styles</var> . <code title="dom-context-2d-font"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-font">font</a></code> [ = <var title="">value</var> ]</dt>

   <dd>

    <p>Returns the current font settings.</p>

    <p>Can be set, to change the font. The syntax is the same as for
    the CSS 'font' property; values that cannot be parsed as CSS font
    values are ignored.</p>

    <p>Relative keywords and lengths are computed relative to the font
    of the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element.</p>

   </dd>

   <dt><var title="">context</var> . <code title="dom-context-2d-textAlign"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textalign">textAlign</a></code> [ = <var title="">value</var> ]</dt>
   <dt><var title="">styles</var> . <code title="dom-context-2d-textAlign"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textalign">textAlign</a></code> [ = <var title="">value</var> ]</dt>

   <dd>

    <p>Returns the current text alignment settings.</p>

    <p>Can be set, to change the alignment. The possible values are
    <code title="">start</code>, <code title="">end</code>, <code title="">left</code>, <code title="">right</code>, and <code title="">center</code>. Other values are ignored. The default is
    <code title="">start</code>.</p>

   </dd>

   <dt><var title="">context</var> . <code title="dom-context-2d-textBaseline"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textbaseline">textBaseline</a></code> [ = <var title="">value</var> ]</dt>
   <dt><var title="">styles</var> . <code title="dom-context-2d-textBaseline"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textbaseline">textBaseline</a></code> [ = <var title="">value</var> ]</dt>

   <dd>

    <p>Returns the current baseline alignment settings.</p>

    <p>Can be set, to change the baseline alignment. The possible
    values and their meanings are given below. Other values are
    ignored. The default is <code title="">alphabetic</code>.</p>

   </dd>

  </dl><div class="impl">

  <p>Objects that implement the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasdrawingstyles">CanvasDrawingStyles</a></code>
  interface have attributes (defined in this section) that control how
  text is laid out (rasterized or outlined) by the object. Such
  objects also have a <dfn id="font-style-source-node">font style source node</dfn>. For
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasrenderingcontext2d">CanvasRenderingContext2D</a></code> objects, this is the
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element. For <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#drawingstyle">DrawingStyle</a></code> objects,
  it's the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#styles-scope-node">styles scope node</a>.</p>

  <p>The <dfn id="dom-context-2d-font" title="dom-context-2d-font"><code>font</code></dfn> IDL
  attribute, on setting, must be parsed the same way as the 'font'
  property of CSS (but without supporting property-independent style
  sheet syntax like 'inherit'), and the resulting font must be
  assigned to the context, with the 'line-height' component forced to
  'normal', with the 'font-size' component converted to CSS pixels,
  and with system fonts being computed to explicit values. If the new
  value is syntactically incorrect (including using
  property-independent style sheet syntax like 'inherit' or
  'initial'), then it must be ignored, without assigning a new font
  value. <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/references.html#refsCSS">[CSS]</a></p>

  <p>Font names must be interpreted in the context of the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#font-style-source-node">font
  style source node</a>'s stylesheets when the font is to be used;
  any fonts embedded using <code title="">@font-face</code> that are
  visible to that element must therefore be available once they are
  loaded. (If a reference font is used before it is fully loaded, or
  if the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#font-style-source-node">font style source node</a> does not have that font
  in scope at the time the font is to be used, then it must be treated
  as if it was an unknown font, falling back to another as described
  by the relevant CSS specifications.) <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/references.html#refsCSSFONTS">[CSSFONTS]</a></p>

  <p>Only vector fonts should be used by the user agent; if a user
  agent were to use bitmap fonts then transformations would likely
  make the font look very ugly.</p>

  <p>On getting, the <code title="dom-context-2d-font"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-font">font</a></code>
  attribute must return the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#serializing-a-css-value" title="serializing a CSS
  value">serialized form</a> of the current font of the context
  (with no 'line-height' component). <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/references.html#refsCSSOM">[CSSOM]</a></p>

  <div class="example">

   <p>For example, after the following statement:</p>

   <pre>context.font = 'italic 400 12px/2 Unknown Font, sans-serif';</pre>

   <p>...the expression <code title="">context.font</code> would
   evaluate to the string "<code title="">italic&nbsp;12px&nbsp;"Unknown&nbsp;Font",&nbsp;sans-serif</code>". The
   "400" font-weight doesn't appear because that is the default
   value. The line-height doesn't appear because it is forced to
   "normal", the default value.</p>

  </div>

  <p>When the object implementing the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasdrawingstyles">CanvasDrawingStyles</a></code>
  interface is created, the font of the context must be set to 10px
  sans-serif. When the 'font-size' component is set to lengths using
  percentages, 'em' or 'ex' units, or the 'larger' or 'smaller'
  keywords, these must be interpreted relative to the computed value


  of the 'font-size' property of the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#font-style-source-node">font style source
  node</a> at the time that the attribute is set, if that is an
  element. When the 'font-weight' component is set to the relative
  values 'bolder' and 'lighter', these must be interpreted relative to
  the computed value of the 'font-weight' property of the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#font-style-source-node">font
  style source node</a> at the time that the attribute is set, if
  that is an element. If the computed values are undefined for a
  particular case (e.g. because the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#font-style-source-node">font style source
  node</a> is not an element or is not <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#in-a-document">in a
  <code>Document</code></a>), then the relative keywords must be
  interpreted relative to the normal-weight 10px sans-serif
  default.</p>

  <p>The <dfn id="dom-context-2d-textalign" title="dom-context-2d-textAlign"><code>textAlign</code></dfn> IDL
  attribute, on getting, must return the current value. On setting, if
  the value is one of <code title="">start</code>, <code title="">end</code>, <code title="">left</code>, <code title="">right</code>, or <code title="">center</code>, then the
  value must be changed to the new value. Otherwise, the new value
  must be ignored. When the object implementing the
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasdrawingstyles">CanvasDrawingStyles</a></code> interface is created, the <code title="dom-context-2d-textAlign"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textalign">textAlign</a></code> attribute must
  initially have the value <code title="">start</code>.</p>

  <p>The <dfn id="dom-context-2d-textbaseline" title="dom-context-2d-textBaseline"><code>textBaseline</code></dfn>
  IDL attribute, on getting, must return the current value. On
  setting, if the value is one of <code title="dom-context-2d-textBaseline-top"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textbaseline-top">top</a></code>, <code title="dom-context-2d-textBaseline-hanging"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textbaseline-hanging">hanging</a></code>, <code title="dom-context-2d-textBaseline-middle"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textbaseline-middle">middle</a></code>, <code title="dom-context-2d-textBaseline-alphabetic"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textbaseline-alphabetic">alphabetic</a></code>,
  <code title="dom-context-2d-textBaseline-ideographic"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textbaseline-ideographic">ideographic</a></code>,
  or <code title="dom-context-2d-textBaseline-bottom"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textbaseline-bottom">bottom</a></code>,
  then the value must be changed to the new value. Otherwise, the new
  value must be ignored. When the object implementing the
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasdrawingstyles">CanvasDrawingStyles</a></code> interface is created, the <code title="dom-context-2d-textBaseline"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textbaseline">textBaseline</a></code> attribute
  must initially have the value <code title="">alphabetic</code>.</p>

  </div>

  <p>The <code title="dom-context-2d-textBaseline"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textbaseline">textBaseline</a></code>
  attribute's allowed keywords correspond to alignment points in the
  font:</p>

  <!-- this is filler to make sure the TCP packet boundary doesn't fall in the middle of one of the NCRs below -->
  <!-- (because otherwise the parser in anolis screws it up) -->
  <p><img alt="The top of the em square is roughly at the top of the glyphs in a font, the hanging baseline is where some glyphs like आ are anchored, the middle is half-way between the top of the em square and the bottom of the em square, the alphabetic baseline is where characters like Á, ÿ, f, and Ω are anchored, the ideographic baseline is where glyphs like 私 and 達 are anchored, and the bottom of the em square is roughly at the bottom of the glyphs in a font. The top and bottom of the bounding box can be far from these baselines, due to glyphs extending far outside the em square." height="300" src="./4.8.11 The canvas element — HTML Standard_files/baselines.png" width="738"></p>

  <p>The keywords map to these alignment points as follows:</p>

  <dl><dt><dfn id="dom-context-2d-textbaseline-top" title="dom-context-2d-textBaseline-top"><code>top</code></dfn>
   </dt><dd>The top of the em square</dd>

   <dt><dfn id="dom-context-2d-textbaseline-hanging" title="dom-context-2d-textBaseline-hanging"><code>hanging</code></dfn>
   </dt><dd>The hanging baseline</dd>

   <dt><dfn id="dom-context-2d-textbaseline-middle" title="dom-context-2d-textBaseline-middle"><code>middle</code></dfn>
   </dt><dd>The middle of the em square</dd>

   <dt><dfn id="dom-context-2d-textbaseline-alphabetic" title="dom-context-2d-textBaseline-alphabetic"><code>alphabetic</code></dfn>
   </dt><dd>The alphabetic baseline</dd>

   <dt><dfn id="dom-context-2d-textbaseline-ideographic" title="dom-context-2d-textBaseline-ideographic"><code>ideographic</code></dfn>
   </dt><dd>The ideographic baseline</dd>

   <dt><dfn id="dom-context-2d-textbaseline-bottom" title="dom-context-2d-textBaseline-bottom"><code>bottom</code></dfn>
   </dt><dd>The bottom of the em square</dd>

  </dl><p>The <dfn id="text-preparation-algorithm">text preparation algorithm</dfn> is as follows. It takes
  as input a string <var title="">text</var>, a
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasdrawingstyles">CanvasDrawingStyles</a></code> object <var title="">target</var>,
  and an optional length <var title="">maxWidth</var>. It returns an
  array of glyph shapes, each positioned on a common coordinate space,
  and a <var title="">physical alignment</var> whose value is one of
  <i>left</i>, <i>right</i>, and <i title="">center</i>. (Most callers of this
  algorithm ignore the <var title="">physical alignment</var>.)</p>

  <ol><li><p>If <var title="">maxWidth</var> was provided but is less
   than or equal to zero, return an empty array.</p></li>

   <li><p>Replace all the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/common-microsyntaxes.html#space-character" title="space character">space
   characters</a> in <var title="">text</var> with U+0020 SPACE
   characters.</p></li>

   <li><p>Let <var title="">font</var> be the current font of <var title="">target</var>, as given by that object's <code title="dom-context-2d-font"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-font">font</a></code> attribute.</p></li>

   <li>

    <p>Apply the appropriate step from the following list to determine
    the value of <var title="">direction</var>:</p>

    <dl class="switch"><dt>If the <var title="">target</var> object's <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#font-style-source-node">font style
     source node</a> is an element</dt>

     <dd>Let <var title="">direction</var> be <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/elements.html#the-directionality">the
     directionality</a> of the <var title="">target</var> object's
     <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#font-style-source-node">font style source node</a>.</dd>

     <dt>If the <var title="">target</var> object's <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#font-style-source-node">font style
     source node</a> is a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/dom.html#document">Document</a></code> and that
     <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/dom.html#document">Document</a></code> has a root element child</dt>

     <dd>Let <var title="">direction</var> be <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/elements.html#the-directionality">the
     directionality</a> of the <var title="">target</var> object's
     <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#font-style-source-node">font style source node</a>'s root element child.</dd>

     <dt>If the <var title="">target</var> object's <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#font-style-source-node">font style
     source node</a> is a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/dom.html#document">Document</a></code> and that
     <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/dom.html#document">Document</a></code> has no root element child</dt>

     <dd>Let <var title="">direction</var> be '<a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/elements.html#concept-ltr" title="concept-ltr">ltr</a>'.</dd>

    </dl></li>

   <li><p>Form a hypothetical infinitely-wide CSS line box containing
   a single inline box containing the text <var title="">text</var>,
   with all the properties at their initial values except the 'font'
   property of the inline box set to <var title="">font</var>, the
   'direction' property of the inline box set to <var title="">direction</var>, and the 'white-space' property set to
   'pre'. <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/references.html#refsCSS">[CSS]</a></p></li>

   <!-- if you insert a step here, make sure to adjust the next step's
   final words -->

   <li><p>If <var title="">maxWidth</var> was provided and the
   hypothetical width of the inline box in the hypothetical line box
   is greater than <var title="">maxWidth</var> CSS pixels, then
   change <var title="">font</var> to have a more condensed font (if
   one is available or if a reasonably readable one can be synthesized
   by applying a horizontal scale factor to the font) or a smaller
   font, and return to the previous step.</p></li>

   <li>

    <p>The <var title="">anchor point</var> is a point on the inline
    box, and the <var title="">physical alignment</var> is one of the
    values <i>left</i>, <i>right</i>, and <i title="">center</i>. These
    variables are determined by the <code title="dom-context-2d-textAlign"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textalign">textAlign</a></code> and <code title="dom-context-2d-textBaseline"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textbaseline">textBaseline</a></code> values as
    follows:</p>

    <p>Horizontal position:</p>

    <dl><dt>If <code title="dom-context-2d-textAlign"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textalign">textAlign</a></code> is
     <code title="">left</code></dt>

     <dt>If <code title="dom-context-2d-textAlign"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textalign">textAlign</a></code> is
     <code title="">start</code> and <var title="">direction</var> is
     'ltr'</dt>

     <dt>If <code title="dom-context-2d-textAlign"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textalign">textAlign</a></code> is
     <code title="">end</code> and <var title="">direction</var> is
     'rtl'</dt>

     <dd>Let the <var title="">anchor point</var>'s horizontal
     position be the left edge of the inline box, and let <var title="">physical alignment</var> be <i>left</i>.</dd>


     <dt>If <code title="dom-context-2d-textAlign"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textalign">textAlign</a></code> is
     <code title="">right</code></dt>

     <dt>If <code title="dom-context-2d-textAlign"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textalign">textAlign</a></code> is
     <code title="">end</code> and <var title="">direction</var> is
     'ltr'</dt>

     <dt>If <code title="dom-context-2d-textAlign"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textalign">textAlign</a></code> is
     <code title="">start</code> and <var title="">direction</var> is
     'rtl'</dt>

     <dd>Let the <var title="">anchor point</var>'s horizontal
     position be the right edge of the inline box, and let <var title="">physical alignment</var> be <i>right</i>.</dd>


     <dt>If <code title="dom-context-2d-textAlign"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textalign">textAlign</a></code> is
     <code title="">center</code></dt>

     <dd>Let the <var title="">anchor point</var>'s horizontal
     position be half way between the left and right edges of the
     inline box, and let <var title="">physical alignment</var> be
     <i title="">center</i>.</dd>

    </dl><p>Vertical position:</p>

    <dl><dt>If <code title="dom-context-2d-textBaseline"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textbaseline">textBaseline</a></code> is <code title="dom-context-2d-textBaseline-top"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textbaseline-top">top</a></code></dt>

     <dd>Let the <var title="">anchor point</var>'s vertical position
     be the top of the em box of the first available font of the
     inline box.</dd>


     <dt>If <code title="dom-context-2d-textBaseline"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textbaseline">textBaseline</a></code> is <code title="dom-context-2d-textBaseline-hanging"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textbaseline-hanging">hanging</a></code></dt>

     <dd>Let the <var title="">anchor point</var>'s vertical position
     be the hanging baseline of the first available font of the inline
     box.</dd>


     <dt>If <code title="dom-context-2d-textBaseline"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textbaseline">textBaseline</a></code> is <code title="dom-context-2d-textBaseline-middle"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textbaseline-middle">middle</a></code></dt>

     <dd>Let the <var title="">anchor point</var>'s vertical position
     be half way between the bottom and the top of the em box of the
     first available font of the inline box.</dd>


     <dt>If <code title="dom-context-2d-textBaseline"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textbaseline">textBaseline</a></code> is <code title="dom-context-2d-textBaseline-alphabetic"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textbaseline-alphabetic">alphabetic</a></code></dt>

     <dd>Let the <var title="">anchor point</var>'s vertical position
     be the alphabetic baseline of the first available font of the inline
     box.</dd>


     <dt>If <code title="dom-context-2d-textBaseline"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textbaseline">textBaseline</a></code> is <code title="dom-context-2d-textBaseline-ideographic"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textbaseline-ideographic">ideographic</a></code></dt>

     <dd>Let the <var title="">anchor point</var>'s vertical position
     be the ideographic baseline of the first available font of the inline
     box.</dd>


     <dt>If <code title="dom-context-2d-textBaseline"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textbaseline">textBaseline</a></code> is <code title="dom-context-2d-textBaseline-bottom"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textbaseline-bottom">bottom</a></code></dt>

     <dd>Let the <var title="">anchor point</var>'s vertical position
     be the bottom of the em box of the first available font of the
     inline box.</dd>

    </dl></li>

   <li>

    <p>Let <var title="">result</var> be an array constructed by
    iterating over each glyph in the inline box from left to right (if
    any), adding to the array, for each glyph, the shape of the glyph
    as it is in the inline box, positioned on a coordinate space using
    CSS pixels with its origin is at the <var title="">anchor
    point</var>.</p>

   </li>

   <li><p>Return <var title="">result</var>, and, for callers that
   need it, <var title="">physical alignment</var> as the alignment
   value.</p></li>

  </ol><h6 id="building-paths"><span class="secno">4.8.11.1.6 </span>Building paths</h6><div class="status LC"><p><strong>Ready for first implementations</strong></p><p class="idref"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#building-paths">#building-paths</a></p><div class="implementations"><p class="IE NONE" title="Latest Internet Explorer beta: does not support this feature">Latest Internet Explorer beta: unknown</p><p class="Firefox NONE" title="Latest Firefox trunk nightly build: does not support this feature">Latest Firefox trunk nightly build: unknown</p><p class="Safari NONE" title="Latest WebKit or Chromium trunk build: does not support this feature">Latest WebKit or Chromium trunk build: unknown</p><p class="Opera NONE" title="Latest Opera beta or preview build: does not support this feature">Latest Opera beta or preview build: unknown</p><p class="Shims NONE" title="JavaScript libraries, plugins, etc: does not support this feature">JavaScript libraries, plugins, etc: unknown</p></div><p class="last-edit"><a>2012-03-26</a> <a>Hixie</a></p><p class="edit-link"><a href="http://www.whatwg.org/specs/web-apps/current-work/edit-section.html?section=building-paths">Edit this information...</a></p></div>

  <p>Each object implementing the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvaspathmethods">CanvasPathMethods</a></code>
  interface has a <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#concept-path" title="concept-path">path</a>. A <dfn id="concept-path" title="concept-path">path</dfn> has a list of zero or more subpaths.
  Each subpath consists of a list of one or more points, connected by
  straight or curved lines, and a flag indicating whether the subpath
  is closed or not. A closed subpath is one where the last point of
  the subpath is connected to the first point of the subpath by a
  straight line. Subpaths with fewer than two points are ignored when
  painting the path.</p>

  <p>When an object implementing the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvaspathmethods">CanvasPathMethods</a></code>
  interface is created, its <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#concept-path" title="concept-path">path</a>
  must be initialized to zero subpaths.</p>

  <dl class="domintro"><dt><var title="">context</var> . <code title="dom-context-2d-moveTo"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-moveto">moveTo</a></code>(<var title="">x</var>, <var title="">y</var>)</dt>
   <dt><var title="">path</var> . <code title="dom-context-2d-moveTo"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-moveto">moveTo</a></code>(<var title="">x</var>, <var title="">y</var>)</dt>

   <dd>

    <p>Creates a new subpath with the given point.</p>

   </dd>

   <dt><var title="">context</var> . <code title="dom-context-2d-closePath"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-closepath">closePath</a></code>()</dt>
   <dt><var title="">path</var> . <code title="dom-context-2d-closePath"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-closepath">closePath</a></code>()</dt>

   <dd>

    <p>Marks the current subpath as closed, and starts a new subpath with a point the same as the start and end of the newly closed subpath.</p>

   </dd>

   <dt><var title="">context</var> . <code title="dom-context-2d-lineTo"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-lineto">lineTo</a></code>(<var title="">x</var>, <var title="">y</var>)</dt>
   <dt><var title="">path</var> . <code title="dom-context-2d-lineTo"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-lineto">lineTo</a></code>(<var title="">x</var>, <var title="">y</var>)</dt>

   <dd>

    <p>Adds the given point to the current subpath, connected to the previous one by a straight line.</p>

   </dd>

   <dt><var title="">context</var> . <code title="dom-context-2d-quadraticCurveTo"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-quadraticcurveto">quadraticCurveTo</a></code>(<var title="">cpx</var>, <var title="">cpy</var>, <var title="">x</var>, <var title="">y</var>)</dt>
   <dt><var title="">path</var> . <code title="dom-context-2d-quadraticCurveTo"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-quadraticcurveto">quadraticCurveTo</a></code>(<var title="">cpx</var>, <var title="">cpy</var>, <var title="">x</var>, <var title="">y</var>)</dt>

   <dd>

    <p>Adds the given point to the current subpath, connected to the previous one by a quadratic Bézier curve with the given control point.</p>

   </dd>

   <dt><var title="">context</var> . <code title="dom-context-2d-bezierCurveTo"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-beziercurveto">bezierCurveTo</a></code>(<var title="">cp1x</var>, <var title="">cp1y</var>, <var title="">cp2x</var>, <var title="">cp2y</var>, <var title="">x</var>, <var title="">y</var>)</dt>
   <dt><var title="">path</var> . <code title="dom-context-2d-bezierCurveTo"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-beziercurveto">bezierCurveTo</a></code>(<var title="">cp1x</var>, <var title="">cp1y</var>, <var title="">cp2x</var>, <var title="">cp2y</var>, <var title="">x</var>, <var title="">y</var>)</dt>

   <dd>

    <p>Adds the given point to the current subpath, connected to the previous one by a cubic Bézier curve with the given control points.</p>

   </dd>

   <dt><var title="">context</var> . <code title="dom-context-2d-arcTo"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-arcto">arcTo</a></code>(<var title="">x1</var>, <var title="">y1</var>, <var title="">x2</var>, <var title="">y2</var>, <var title="">radiusX</var> [, <var title="">radiusY</var>, <var title="">rotation</var> ])</dt>
   <dt><var title="">path</var> . <code title="dom-context-2d-arcTo"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-arcto">arcTo</a></code>(<var title="">x1</var>, <var title="">y1</var>, <var title="">x2</var>, <var title="">y2</var>, <var title="">radius</var> [, <var title="">radiusY</var>, <var title="">rotation</var> ])</dt>

   <dd>

    <p>Adds an arc with the given control points and radius to the
    current subpath, connected to the previous point by a straight
    line.</p>

    <p>If two radii are provided, the first controls the width of the
    arc's ellipse, and the second controls the height. If only one is
    provided, or if they are the same, the arc is from a circle. In
    the case of an ellipse, the rotation argument controls the
    clockwise inclination of the ellipse relative to the x-axis.</p>

    <p>Throws an <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#indexsizeerror">IndexSizeError</a></code> exception if the given
    radius is negative.</p>

    <figure class="diagrams"><!-- if anyone wants to try writing alternative text for these,
     be my guest. I can't work out how to describe them. --><img alt="" src="./4.8.11 The canvas element — HTML Standard_files/arcTo1.png"><img alt="" src="./4.8.11 The canvas element — HTML Standard_files/arcTo2.png"><img alt="" src="./4.8.11 The canvas element — HTML Standard_files/arcTo3.png"></figure><!--

c.clearRect(0, 0, 640, 480);
c.save();
try {
  var x0 = 150;
  var y0 = 100;
  var x1 = 375;
  var y1 = 100;
  var x2 = x1;
  var y2 = 250;
  var r = 50;

  var bottom = 210;
  var center = 100;

  var fontSize = 16;
  var margin = 50;
  var dotHalfSize = 5;

  // (also update the label positions at the bottom)


  // ========

  function extendLine(xa,ya,xb,yb) {
    var dx = xb-xa;
    var dy = yb-ya;
    var theta = Math.atan2(dx,dy);
    var extX = margin * Math.sin(theta);
    var extY = margin * Math.cos(theta);
    c.beginPath();
    c.moveTo(xa-extX,ya-extY);
    c.lineTo(xb+extX,yb+extY);
    c.stroke();
  }

  function dot(x,y,s) {
    c.beginPath();
    c.arc(x,y,dotHalfSize,0,Math.PI*2);
    c.fill();
    c.textAlign = 'left';
    c.textBaseline = 'top';
    c.fillText(s,x+dotHalfSize,y);
  }

  c.font = fontSize + 'px Gill Sans';
  c.fillStyle = 'black';
  c.lineWidth = 1;
  c.strokeStyle = 'red';
  extendLine(x0,y0,x1,y1);
  extendLine(x1,y1,x2,y2);

  c.lineWidth = 1;
  c.strokeStyle = 'silver';
  c.beginPath();
  c.moveTo(x0,y0);

  // based on http://lists.freedesktop.org/archives/cairo/2005-August/004801.html
  var angle0, angle1, angle2, angled;
  var xc, yc, dc;
  angle0 = Math.atan2(y0 - y1, x0 - x1);
  angle2 = Math.atan2(y2 - y1, x2 - x1);
  angle1 = (angle0 + angle2) / 2;
  angled = angle2 - angle0;
  if (angled > Math.PI || (angled < 0 && angled > -Math.PI)) {
    angle1 += Math.PI;
    angled = 2 * Math.PI - angled;
    angle0 += Math.PI*2;
    angle2 -= Math.PI*2;
  } else {
    angle0 -= Math.PI*2;
    angle2 += Math.PI*2;
  }
  dc = r / Math.sin (angled / 2);
  yc = Math.sin(angle1);
  xc = Math.cos(angle1);
  xc = x1 + xc * dc;
  yc = y1 + yc * dc;

  c.lineWidth = 1;
  c.strokeStyle = 'blue';
  c.beginPath();
  c.moveTo(xc,yc);
  c.arc(xc,yc,r, Math.PI*3/4, Math.PI*(3/4));
  c.stroke();
  c.beginPath();
  c.strokeStyle = 'silver';
  c.arc(xc,yc,r, Math.PI*3/4,Math.PI*(2+3/4));
  c.stroke();
  c.save();
  try {
    c.translate(xc, yc);
    c.rotate(-Math.PI/4);
    c.textAlign = 'center';
    c.textBaseline = 'top';
    c.fillText("radius", -r/2, 0);
  } finally {
    c.restore();
  }

  c.lineWidth = 15;
  c.lineCap = 'round';
  c.strokeStyle = 'rgba(20,200,40,0.8)';
  c.beginPath();
  c.moveTo(x0,y0);
  c.arcTo(x1,y1,x2,y2,r);
  c.stroke();

  dot(x0,y0, "x\u2080,y\u2080");
  dot(x1,y1, "x\u2081,y\u2081");
  dot(x2,y2, "x\u2082,y\u2082");
  dot(xc,yc, '');

  c.textAlign = 'left';
  c.textBaseline = 'alphabetic';
  var L = 0;

  function print(s) {
    c.fillText(s, center, bottom+L*fontSize*1.3);
    L += 1;
  }
  print('// the thick line corresponds to:');
  print('context.moveTo(x\u2080, y\u2080)');
  print('context.arcTo(x\u2081, y\u2081, x\u2082, y\u2082, radius)');
  print('context.stroke()');

  c.fillStyle = 'green';
  c.fillText("\u25be initial line", 160, 70);
  c.textAlign = 'right';
  c.fillText("arc \u25b8", x1-25, 115);

} finally {
  c.restore();
}

--></dd>

   <dt><var title="">context</var> . <code title="dom-context-2d-arc"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-arc">arc</a></code>(<var title="">x</var>, <var title="">y</var>, <var title="">radius</var>, <var title="">startAngle</var>, <var title="">endAngle</var> [, <var title="">anticlockwise</var> ] )</dt>
   <dt><var title="">path</var> . <code title="dom-context-2d-arc"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-arc">arc</a></code>(<var title="">x</var>, <var title="">y</var>, <var title="">radius</var>, <var title="">startAngle</var>, <var title="">endAngle</var> [, <var title="">anticlockwise</var> ] )</dt>

   <dd>

    <p>Adds points to the subpath such that the arc described by the
    circumference of the circle described by the arguments, starting
    at the given start angle and ending at the given end angle, going
    in the given direction (defaulting to clockwise), is added to the
    path, connected to the previous point by a straight line.</p>

    <p>Throws an <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#indexsizeerror">IndexSizeError</a></code> exception if the given
    radius is negative.</p>

    <figure class="diagrams"><!-- if anyone wants to try writing alternative text for this, be my guest. I can't work out how to describe it. --><img alt="" src="./4.8.11 The canvas element — HTML Standard_files/arc1.png"></figure><!--

c.clearRect(0, 0, 640, 480);
c.save();
try {
  var x0 = 50;
  var y0 = 200;
  var x = 255;
  var y = 150;
  var radius = 100;
  var startAngle = 2.0;
  var endAngle = 5.7;
  var direction = false;

  var bottom = 110;
  var center = 380;

  var fontSize = 16;
  var margin = 50;
  var dotHalfSize = 5;
  var arrowHead = 5;

  // (also update the label positions at the bottom)

  // ========

  function dot(x,y,s) {
    c.beginPath();
    c.arc(x,y,dotHalfSize,0,Math.PI*2);
    c.fill();
    c.textAlign = 'center';
    c.textBaseline = 'top';
    c.fillText(s,x,y+dotHalfSize);
  }

  function arc(x, y, r, sA, eA, d, fr, s) {
    c.lineWidth = 1;
    c.strokeStyle = 'red';
    c.beginPath();
    c.arc(x, y, r, sA, eA, d);
    c.stroke();

    c.save();
    c.translate(x, y);
    c.rotate(eA);
    c.beginPath();
    c.moveTo(r-arrowHead, d?arrowHead:-arrowHead);
    c.lineTo(r, 0);
    c.lineTo(r+arrowHead, d?arrowHead:-arrowHead);
    c.stroke();
    c.strokeStyle = 'silver';
    c.beginPath();
    c.moveTo(0, 0);
    c.lineTo(fr, 0);
    c.stroke();
    c.restore();

    c.fillStyle = 'black';
    if (eA<Math.PI) {
      c.save();
      c.translate(x, y);
      c.rotate(sA+(eA-sA)/2-Math.PI/2);
      c.translate(0, r);
      c.rotate(-(sA+(eA-sA)/2-Math.PI/2));
      c.beginPath();
      c.textAlign = 'center';
      c.textBaseline = 'bottom';
      c.fillText(s + '  ',0,0);
      c.restore();
    } else {
      c.save();
      c.beginPath();
      c.textAlign = 'left';
      c.textBaseline = 'middle';
      c.fillText(' ' + s,x-r,y);
      c.restore();
    }
  }

  function radial(x, y, length, rotation, s) {
    c.lineWidth = 1;
    c.strokeStyle = 'blue';
    c.save();
    c.translate(x, y);
    c.rotate(rotation);
    c.beginPath();
    c.moveTo(0, 0);
    c.lineTo(length, 0);
    c.stroke();
    c.textAlign = 'center';
    c.textBaseline = 'bottom';
    c.fillStyle = 'black';
    c.fillText(s,length/2,0);
    c.restore();
  }

  c.font = fontSize + 'px Gill Sans';

  // construction lines
  c.lineWidth = 1;
  c.strokeStyle = 'silver';
  // circle
  c.beginPath();
  c.arc(x, y, radius, 0, 2*Math.PI);
  c.stroke();
  // angles
  arc(x, y, radius/10+2*radius/3, 0, startAngle, false, radius, '\u03B1');
  arc(x, y, radius/10+radius/3, 0, endAngle, false, radius, '\u03B2');
  // radii
  radial(x, y, radius, 0, 'radius');

  // the line
  c.lineWidth = 15;
  c.lineCap = 'round';
  c.strokeStyle = 'rgba(20,200,40,0.8)';
  c.beginPath();
  c.moveTo(x0,y0);
  c.arc(x,y,radius,startAngle,endAngle,direction);
  c.stroke();

  dot(x0,y0, "x\u2080,y\u2080");
  dot(x,y, "x,y");

  c.textAlign = 'left';
  c.textBaseline = 'alphabetic';
  var L = 0;

  function print(s) {
    c.fillText(s, center, bottom+L*fontSize*1.3);
    L += 1;
  }
  print('// the thick line corresponds to:');
  print('context.moveTo(x\u2080, y\u2080)');
  print('context.arc(x, y, radius, \u03B1, \u03B2)');
  print('context.stroke()');

  c.fillStyle = 'green';

  c.textBaseline = 'top';
  c.fillText("initial line \u25b4", x0+20, y0+fontSize*2);

  c.textAlign = 'right';
  c.textBaseline = 'middle';
  c.fillText("arc \u25b8", x-radius-15, y);

} finally {
  c.restore();
}
--></dd>

   <dt><var title="">context</var> . <code title="dom-context-2d-ellipse"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-ellipse">ellipse</a></code>(<var title="">x</var>, <var title="">y</var>, <var title="">radiusX</var>, <var title="">radiusY</var>, <var title="">rotation</var>, <var title="">startAngle</var>, <var title="">endAngle</var>, <var title="">anticlockwise</var>)</dt>
   <dt><var title="">path</var> . <code title="dom-context-2d-ellipse"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-ellipse">ellipse</a></code>(<var title="">x</var>, <var title="">y</var>, <var title="">radiusX</var>, <var title="">radiusY</var>, <var title="">rotation</var>, <var title="">startAngle</var>, <var title="">endAngle</var>, <var title="">anticlockwise</var>)</dt>

   <dd>

    <p>Adds points to the subpath such that the arc described by the
    circumference of the ellipse described by the arguments, starting
    at the given start angle and ending at the given end angle, going
    in the given direction (defaulting to clockwise), is added to the
    path, connected to the previous point by a straight line.</p>

    <p>Throws an <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#indexsizeerror">IndexSizeError</a></code> exception if the given
    radius is negative.</p>

   </dd>

   <dt><var title="">context</var> . <code title="dom-context-2d-rect"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-rect">rect</a></code>(<var title="">x</var>, <var title="">y</var>, <var title="">w</var>, <var title="">h</var>)</dt>
   <dt><var title="">path</var> . <code title="dom-context-2d-rect"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-rect">rect</a></code>(<var title="">x</var>, <var title="">y</var>, <var title="">w</var>, <var title="">h</var>)</dt>

   <dd>

    <p>Adds a new closed subpath to the path, representing the given rectangle.</p>

   </dd>

  </dl><div class="impl">

  <p>The following methods allow authors to manipulate the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#concept-path" title="concept-path">paths</a> of objects implementing the
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvaspathmethods">CanvasPathMethods</a></code> interface.</p>

  <p>For <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasrenderingcontext2d">CanvasRenderingContext2D</a></code> objects, the points and
  lines added to <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#current-default-path">current default path</a> by these methods
  must be transformed according to the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#transformations" title="dom-context-2d-transformation">current transformation
  matrix</a> before they are added to the path.</p>


  <p>The <dfn id="dom-context-2d-moveto" title="dom-context-2d-moveTo"><code>moveTo(<var title="">x</var>, <var title="">y</var>)</code></dfn> method must
  create a new subpath with the specified point as its first (and
  only) point.</p>

  <p>When the user agent is to <dfn id="ensure-there-is-a-subpath">ensure there is a subpath</dfn>
  for a coordinate (<var title="">x</var>, <var title="">y</var>) on a
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#concept-path" title="concept-path">path</a>, the user agent must check to
  see if the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#concept-path" title="concept-path">path</a> has any subpaths,
  and if it does not, then the user agent must create a new subpath
  with the point (<var title="">x</var>, <var title="">y</var>) as its
  first (and only) point, as if the <code title="dom-context-2d-moveTo"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-moveto">moveTo()</a></code> method had been
  called.</p>


  <p>The <dfn id="dom-context-2d-closepath" title="dom-context-2d-closePath"><code>closePath()</code></dfn>
  method must do nothing if the object's path has no subpaths.
  Otherwise, it must mark the last subpath as closed, create a new
  subpath whose first point is the same as the previous subpath's
  first point, and finally add this new subpath to the path.</p>

  <p class="note">If the last subpath had more than one point in its
  list of points, then this is equivalent to adding a straight line
  connecting the last point back to the first point, thus "closing"
  the shape, and then repeating the last (possibly implied) <code title="dom-context-2d-moveTo"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-moveto">moveTo()</a></code> call.</p>


  <p>New points and the lines connecting them are added to subpaths
  using the methods described below. In all cases, the methods only
  modify the last subpath in the object's path.</p>


  <p>The <dfn id="dom-context-2d-lineto" title="dom-context-2d-lineTo"><code>lineTo(<var title="">x</var>, <var title="">y</var>)</code></dfn> method must
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#ensure-there-is-a-subpath">ensure there is a subpath</a> for <span title="">(<var title="">x</var>, <var title="">y</var>)</span> if the object's path
  has no subpaths. Otherwise, it must connect the last point in the
  subpath to the given point (<var title="">x</var>, <var title="">y</var>) using a straight line, and must then add the given
  point (<var title="">x</var>, <var title="">y</var>) to the
  subpath.</p>


  <p>The <dfn id="dom-context-2d-quadraticcurveto" title="dom-context-2d-quadraticCurveTo"><code>quadraticCurveTo(<var title="">cpx</var>, <var title="">cpy</var>, <var title="">x</var>,
  <var title="">y</var>)</code></dfn> method must <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#ensure-there-is-a-subpath">ensure there
  is a subpath</a> for <span title="">(<var title="">cpx</var>,
  <var title="">cpy</var>)</span>, and then must connect the last
  point in the subpath to the given point (<var title="">x</var>, <var title="">y</var>) using a quadratic Bézier curve with control
  point (<var title="">cpx</var>, <var title="">cpy</var>), and must
  then add the given point (<var title="">x</var>, <var title="">y</var>) to the subpath. <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/references.html#refsBEZIER">[BEZIER]</a></p>


  <p>The <dfn id="dom-context-2d-beziercurveto" title="dom-context-2d-bezierCurveTo"><code>bezierCurveTo(<var title="">cp1x</var>, <var title="">cp1y</var>, <var title="">cp2x</var>, <var title="">cp2y</var>, <var title="">x</var>, <var title="">y</var>)</code></dfn> method must
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#ensure-there-is-a-subpath">ensure there is a subpath</a> for <span title="">(<var title="">cp1x</var>, <var title="">cp1y</var>)</span>, and then must
  connect the last point in the subpath to the given point (<var title="">x</var>, <var title="">y</var>) using a cubic Bézier
  curve with control points (<var title="">cp1x</var>, <var title="">cp1y</var>) and (<var title="">cp2x</var>, <var title="">cp2y</var>). Then, it must add the point (<var title="">x</var>, <var title="">y</var>) to the subpath. <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/references.html#refsBEZIER">[BEZIER]</a></p>

  <hr><p>The <dfn id="dom-context-2d-arcto" title="dom-context-2d-arcTo"><code>arcTo(<var title="">x1</var>, <var title="">y1</var>, <var title="">x2</var>,
  <var title="">y2</var>, <var title="">radiusX</var>, <var title="">radiusY</var>, <var title="">rotation</var>)</code></dfn>
  method must first <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#ensure-there-is-a-subpath">ensure there is a subpath</a> for <span title="">(<var title="">x1</var>, <var title="">y1</var>)</span>.
  Then, the behavior depends on the arguments and the last point in
  the subpath, as described below.</p>

  <p>Negative values for <var title="">radiusX</var> or <var title="">radiusY</var> must cause the implementation to throw an
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#indexsizeerror">IndexSizeError</a></code> exception. If <var title="">radiusY</var> is omitted, user agents must act as if it had
  the same value as <var title="">radiusX</var>.</p>

  <p>Let the point (<var title="">x0</var>, <var title="">y0</var>) be
  the last point in the subpath.</p>

  <p>If the point (<var title="">x0</var>, <var title="">y0</var>) is
  equal to the point (<var title="">x1</var>, <var title="">y1</var>),
  or if the point (<var title="">x1</var>, <var title="">y1</var>) is
  equal to the point (<var title="">x2</var>, <var title="">y2</var>),
  or if both <var title="">radiusX</var> and <var title="">radiusY</var> are zero, then the method must add the point
  (<var title="">x1</var>, <var title="">y1</var>) to the subpath, and
  connect that point to the previous point (<var title="">x0</var>,
  <var title="">y0</var>) by a straight line.</p>

  <p>Otherwise, if the points (<var title="">x0</var>, <var title="">y0</var>), (<var title="">x1</var>, <var title="">y1</var>), and (<var title="">x2</var>, <var title="">y2</var>) all lie on a single straight line, then the
  method must add the point (<var title="">x1</var>, <var title="">y1</var>) to the subpath, and connect that point to the
  previous point (<var title="">x0</var>, <var title="">y0</var>) by a
  straight line.</p>

  <p>Otherwise, let <var title="">The Arc</var> be the shortest arc
  given by circumference of the ellipse that has radius <var title="">radiusX</var> on the major axis and radius <var title="">radiusY</var> on the minor axis, and whose semi-major axis
  is rotated <var title="">rotation</var> radians clockwise from the
  positive x-axis, and that has one point tangent to the half-infinite
  line that crosses the point (<var title="">x0</var>, <var title="">y0</var>) and ends at the point (<var title="">x1</var>,
  <var title="">y1</var>), and that has a different point tangent to
  the half-infinite line that ends at the point (<var title="">x1</var>, <var title="">y1</var>) and crosses the point
  (<var title="">x2</var>, <var title="">y2</var>). The points at
  which this ellipse touches these two lines are called the start and
  end tangent points respectively. The method must connect the point
  (<var title="">x0</var>, <var title="">y0</var>) to the start
  tangent point by a straight line, adding the start tangent point to
  the subpath, and then must connect the start tangent point to the
  end tangent point by <var title="">The Arc</var>, adding the end
  tangent point to the subpath.</p>

  <hr><p>The <dfn id="dom-context-2d-arc" title="dom-context-2d-arc"><code>arc(<var title="">x</var>, <var title="">y</var>, <var title="">radius</var>,
  <var title="">startAngle</var>, <var title="">endAngle</var>, <var title="">anticlockwise</var>)</code></dfn> and <dfn id="dom-context-2d-ellipse" title="dom-context-2d-ellipse"><code>ellipse(<var title="">x</var>,
  <var title="">y</var>, <var title="">radiusX</var>, <var title="">radiusY</var>, <var title="">rotation</var>, <var title="">startAngle</var>, <var title="">endAngle</var>, <var title="">anticlockwise</var>)</code></dfn> methods draw arcs.</p>

  <p>The <code title="dom-context-2d-arc"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-arc">arc()</a></code> method is
  equivalent to the <code title="dom-context-2d-ellipse"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-ellipse">ellipse()</a></code> method in the case
  where the two radii are equal. When the <code title="dom-context-2d-arc"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-arc">arc()</a></code> method is invoked, it must
  act as if the <code title="dom-context-2d-ellipse"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-ellipse">ellipse()</a></code>
  method had been invoked with the <var title="">radiusX</var> and
  <var title="">radiusY</var> arguments set to the value of the <var title="">radius</var> argument, the <var title="">rotation</var>
  argument set to zero, and the other arguments set to the same values
  as their identically named arguments on the <code title="dom-context-2d-arc"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-arc">arc()</a></code> method.</p>

  <p>When the <code title="dom-context-2d-ellipse"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-ellipse">ellipse()</a></code>
  method is invoked, it must proceed as follows. First, if the
  object's path has any subpaths, then the method must add a straight
  line from the last point in the subpath to the start point of the
  arc. Then, it must add the start and end points of the arc to the
  subpath, and connect them with an arc. The arc and its start and end
  points are defined as follows:</p>

  <p>Consider an ellipse that has its origin at (<var title="">x</var>, <var title="">y</var>), that has a major-axis
  radius <var title="">radiusX</var> and a minor-axis radius <var title="">radiusY</var>, and that is rotated about its origin such
  that its semi-major axis is inclined <var title="">rotation</var>
  radians clockwise from the x-axis. The points at <var title="">startAngle</var> and <var title="">endAngle</var> along
  this circle's circumference, measured in radians clockwise from the
  ellipse's semi-major axis, are the start and end points
  respectively.</p>

  <p>If the <var title="">anticlockwise</var> argument false and <span title=""><var title="">endAngle</var>-<var title="">startAngle</var></span> is equal to or greater than <span title="">2π</span>, or, if the <var title="">anticlockwise</var>
  argument is <em>true</em> and <span title=""><var title="">startAngle</var>-<var title="">endAngle</var></span> is
  equal to or greater than <span title="">2π</span>, then the arc
  is the whole circumference of this ellipse.</p>

  <p>Otherwise, the arc is the path along the circumference of this
  ellipse from the start point to the end point, going anti-clockwise
  if the <var title="">anticlockwise</var> argument is true, and
  clockwise otherwise. Since the points are on the ellipse, as opposed
  to being simply angles from zero, the arc can never cover an angle
  greater than <span title="">2π</span> radians.</p>

  <p>Negative values for <var title="">radiusX</var> or <var title="">radiusY</var> must cause the implementation to throw an
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#indexsizeerror">IndexSizeError</a></code> exception.</p>

  <hr><p>The <dfn id="dom-context-2d-rect" title="dom-context-2d-rect"><code>rect(<var title="">x</var>, <var title="">y</var>, <var title="">w</var>, <var title="">h</var>)</code></dfn> method must create a new subpath
  containing just the four points (<var title="">x</var>, <var title="">y</var>), (<var title="">x</var>+<var title="">w</var>,
  <var title="">y</var>), (<var title="">x</var>+<var title="">w</var>, <var title="">y</var>+<var title="">h</var>),
  (<var title="">x</var>, <var title="">y</var>+<var title="">h</var>), with those four points connected by straight
  lines, and must then mark the subpath as closed. It must then create
  a new subpath with the point (<var title="">x</var>, <var title="">y</var>) as the only point in the subpath.</p>


  <!-- v6 feature request:
        * points as a primitive shape
          http://home.comcast.net/~urbanjost/canvas/vogle4.html
  -->

  </div>



  <h6 id="path-objects"><span class="secno">4.8.11.1.7 </span><code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a></code> objects</h6><div class="status LC"><p><strong>Ready for first implementations</strong></p><p class="idref"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path-objects">#path-objects</a></p><div class="implementations"><p class="IE NONE" title="Latest Internet Explorer beta: does not support this feature">Latest Internet Explorer beta: unknown</p><p class="Firefox NONE" title="Latest Firefox trunk nightly build: does not support this feature">Latest Firefox trunk nightly build: unknown</p><p class="Safari NONE" title="Latest WebKit or Chromium trunk build: does not support this feature">Latest WebKit or Chromium trunk build: unknown</p><p class="Opera NONE" title="Latest Opera beta or preview build: does not support this feature">Latest Opera beta or preview build: unknown</p><p class="Shims NONE" title="JavaScript libraries, plugins, etc: does not support this feature">JavaScript libraries, plugins, etc: unknown</p></div><p class="last-edit"><a>2012-03-26</a> <a>Hixie</a></p><p class="edit-link"><a href="http://www.whatwg.org/specs/web-apps/current-work/edit-section.html?section=path-objects">Edit this information...</a></p></div>

  <p><code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a></code> objects can be used to declare paths that are
  then later used on <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasrenderingcontext2d">CanvasRenderingContext2D</a></code> objects. In
  addition to many of the APIs described in earlier sections,
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a></code> objects have methods to combine paths, and to add
  text to paths.</p>

  <dl class="domintro"><dt><var title="">path</var> = new <code title="dom-Path"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-path">Path</a></code>()</dt>

   <dd>

    <p>Creates a new empty <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a></code> object.</p>

   </dd>

   <dt><var title="">path</var> = new <code title="dom-Path-copy"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-path-copy">Path</a></code>(<var title="">path</var>)</dt>

   <dd>

    <p>Creates a new <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a></code> object that is a copy of the argument.</p>

   </dd>

   <dt><var title="">path</var> = new <code title="dom-Path-withdata"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-path-withdata">Path</a></code>(<var title="">d</var>)</dt>

   <dd>

    <p>Creates a new path with the path described by the argument, interpreted as SVG path data. <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/references.html#refsSVG">[SVG]</a></p>

   </dd>

   <dt><var title="">path</var> . <code title="dom-path-addPath"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-path-addpath">addPath</a></code>(<var title="">path</var>, <var title="">transform</var>)</dt>
   <dt><var title="">path</var> . <code title="dom-path-addPathByStrokingPath"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-path-addpathbystrokingpath">addPathByStrokingPath</a></code>(<var title="">path</var>, <var title="">styles</var>, <var title="">transform</var>)</dt>

   <dd>

    <p>Adds to the path the path given by the argument.</p>

    <p>In the case of the stroking variants, the line styles are taken from the <var title="">styles</var> argument, which can be either a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#drawingstyle">DrawingStyle</a></code> object or a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasrenderingcontext2d">CanvasRenderingContext2D</a></code> object.</p>

   </dd>

   <dt><var title="">path</var> . <code title="dom-path-addText"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-path-addtext">addText</a></code>(<var title="">text</var>, <var title="">styles</var>, <var title="">transform</var>, <var title="">x</var>, <var title="">y</var> [, <var title="">maxWidth</var> ])</dt>
   <dt><var title="">path</var> . <code title="dom-path-addText"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-path-addtext">addText</a></code>(<var title="">text</var>, <var title="">styles</var>, <var title="">transform</var>, <var title="">path</var> [, <var title="">maxWidth</var> ])</dt>
   <dt><var title="">path</var> . <code title="dom-path-addPathByStrokingText"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-path-addpathbystrokingtext">addPathByStrokingText</a></code>(<var title="">text</var>, <var title="">styles</var>, <var title="">transform</var>, <var title="">x</var>, <var title="">y</var> [, <var title="">maxWidth</var> ])</dt>
   <dt><var title="">path</var> . <code title="dom-path-addPathByStrokingText"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-path-addpathbystrokingtext">addPathByStrokingText</a></code>(<var title="">text</var>, <var title="">styles</var>, <var title="">transform</var>, <var title="">path</var> [, <var title="">maxWidth</var> ])</dt>

   <dd>

    <p>Adds to the path a series of subpaths corresponding to the given text. If the arguments give a coordinate, the text is drawn horizontally at the given coordinates. If the arguments give a path, the text is drawn along the path. If a maximum width is provided, the text will be scaled to fit that width if necessary.</p>

    <p>The font, and in the case of the stroking variants, the line styles, are taken from the <var title="">styles</var> argument, which can be either a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#drawingstyle">DrawingStyle</a></code> object or a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasrenderingcontext2d">CanvasRenderingContext2D</a></code> object.</p>

   </dd>

  </dl><div class="impl">

  <p>The <dfn id="dom-path" title="dom-Path"><code>Path()</code></dfn> constructor,
  when invoked, must return a newly created <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a></code>
  object.</p>

  <hr><p>The <dfn id="dom-path-copy" title="dom-Path-copy"><code>Path()</code></dfn>
  constructor, when invoked, must return a newly created
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a></code> object, to which the subpaths of the argument are
  added. (In other words, it returns a copy of the argument.)</p>

  <hr><p>The <dfn id="dom-path-withdata" title="dom-Path-withdata"><code>Path(<var title="">d</var>)</code></dfn> constructor must run the following
  steps:</p>

  <ol><li>

    <p>Parse and interpret the <var title="">d</var> argument
    according to the SVG specification's rules for path data, thus
    obtaining an SVG path. <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/references.html#refsSVG">[SVG]</a></p>

    <p class="note">The resulting path could be empty. SVG defines
    error handling rules for parsing and applying path data.</p>

   </li>

   <li><p>Let (<var title="">x</var>, <var title="">y</var>) be the
   last point in the SVG path.</p></li>

   <li><p>Create a new <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a></code> object and add all the
   subpaths in the SVG path, if any, to that <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a></code> object.
   </p>

   </li><li><p>Create a new subpath in the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a></code> object with
   (<var title="">x</var>, <var title="">y</var>) as the only point in
   the subpath.</p></li>

   <li><p>Return the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a></code> object as the constructed
   object.</p></li>

  </ol><hr><p>The <dfn id="dom-path-addpath" title="dom-path-addPath"><code>addPath(<var title="">b</var>, <var title="">transform</var>)</code></dfn>
  method, when invoked on a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a></code> object <var title="">a</var>, must run the following steps:</p>

  <ol><li><p>If the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a></code> object <var title="">b</var> has
   no subpaths, abort these steps.</p></li>

   <li><p>Create a copy of all the subpaths in <var title="">b</var>.
   Let this copy be known as <var title="">c</var>.</p></li>

   <li><p>Transform all the coordinates and lines in <var title="">c</var> by the transform matrix <var title="">transform</var>, if it is not null.</p></li>

   <li><p>Let (<var title="">x</var>, <var title="">y</var>) be the
   last point in the last subpath of <var title="">c</var>.</p></li>

   <li><p>Add all the subpaths in <var title="">c</var> to <var title="">a</var>.</p></li>

   <li><p>Create a new subpath in <var title="">a</var> with (<var title="">x</var>, <var title="">y</var>) as the only point in the
   subpath.</p></li>

  </ol><hr><p>The <dfn id="dom-path-addpathbystrokingpath" title="dom-path-addPathByStrokingPath"><code>addPathByStrokingPath(<var title="">b</var>, <var title="">styles</var>, <var title="">transform</var>)</code></dfn> method, when invoked on a
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a></code> object <var title="">a</var>, must run the
  following steps:</p>

  <ol><li><p>If the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a></code> object <var title="">b</var> has
   no subpaths, abort these steps.</p></li>

   <li><p>Create a copy of all the subpaths in <var title="">b</var>.
   Let this copy be known as <var title="">c</var>.</p></li>

   <li><p>Transform all the coordinates and lines in <var title="">c</var> by transformation matrix <var title="">transform</var>, if it is not null.</p></li>

   <li><p>Let a new list of subpaths <var title="">d</var> be the
   result of <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#trace-a-path" title="trace a path">tracing</a> <var title="">c</var>, using the <var title="">styles</var> argument for
   the line styles.</p>

   </li><li><p>Let (<var title="">x</var>, <var title="">y</var>) be the
   last point in the last subpath of <var title="">d</var>.</p></li>

   <li><p>Add all the subpaths in <var title="">d</var> to <var title="">a</var>.</p></li>

   <li><p>Create a new subpath in <var title="">a</var> with (<var title="">x</var>, <var title="">y</var>) as the only point in the
   subpath.</p></li>

  </ol><hr><p>The <dfn id="dom-path-addtext" title="dom-path-addText"><code>addText()</code></dfn>
  and <dfn id="dom-path-addpathbystrokingtext" title="dom-path-addPathByStrokingText"><code>addPathByStrokingText()</code></dfn>
  methods each come in two variants: one rendering text at a given
  coordinate, and one rendering text along a given path. In both
  cases, the methods take a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasdrawingstyles">CanvasDrawingStyles</a></code> object
  argument for the text and (if appropriate) line styles to use, an
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#svgmatrix">SVGMatrix</a></code> object <var title="">transform</var> (which
  can be null), and a maximum width can optionally be provided.</p>

  <p>When one of the <code title="dom-path-addText"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-path-addtext">addText()</a></code> and <code title="dom-path-addPathByStrokingText"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-path-addpathbystrokingtext">addPathByStrokingText()</a></code> variants
  that take as argument an (<var title="">x</var>, <var title="">y</var>) coordinate is invoked, the method must run the
  following algorithm:</p>

  <ol><li><p>Run the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#text-preparation-algorithm">text preparation algorithm</a>, passing it
   <var title="">text</var>, the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasdrawingstyles">CanvasDrawingStyles</a></code>
   object argument, and, if the <var title="">maxWidth</var> argument
   was provided, that argument. Let <var title="">glyphs</var> be the
   result.</p>

   </li><li><p>Move all the shapes in <var title="">glyphs</var> to the
   right by <var title="">x</var> CSS pixels and down by <var title="">y</var> CSS pixels.</p></li>

   <li><p>Let <var title="">glyph subpaths</var> be a
   <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">path</a> describing the shapes given in <var title="">glyphs</var>, with each CSS pixel in the coordinate space
   of <var title="">glyphs</var> mapped to one coordinate space unit
   in <var title="">glyph subpaths</var>. Subpaths in <var title="">glyph subpaths</var> must wind clockwise, regardless of
   how the user agent's font subsystem renders fonts and regardless of
   how the fonts themselves are defined.</p>

   </li><li><p>If the method is <code title="dom-path-addPathByStrokingText"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-path-addpathbystrokingtext">addPathByStrokingText()</a></code>,
   replace <var title="">glyph subpaths</var> by the result of <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#trace-a-path" title="trace a path">tracing</a> <var title="">glyph
   subpaths</var>, using the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasdrawingstyles">CanvasDrawingStyles</a></code> object
   argument for the line styles.</p>

   </li><li><p>Transform all the coordinates and lines in <var title="">glyph subpaths</var> by the transformation matrix <var title="">transform</var>, if it is not null.</p></li>

   <li><p>Let (<var title="">x<sub title="">final</sub></var>, <var title="">y<sub title="">final</sub></var>) be the last point in the
   last subpath of <var title="">glyph subpaths</var>.</p></li>

   <li><p>Add all the subpaths in <var title="">glyph
   subpaths</var> to the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a></code> object.</p></li>

   <li><p>Create a new subpath in the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a></code> object with
   (<var title="">x<sub title="">final</sub></var>, <var title="">y<sub title="">final</sub></var>) as the only point in the
   subpath.</p></li>

  </ol><p>When one of the <code title="dom-path-addText"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-path-addtext">addText()</a></code> and <code title="dom-path-addPathByStrokingText"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-path-addpathbystrokingtext">addPathByStrokingText()</a></code>
  variants that take as argument a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a></code> object is
  invoked, the method must run the following algorithm:</p>

  <ol><li><p>Let <var title="">target</var> be the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a></code>
   object on which the method was invoked.</p></li>

   <li><p>Let <var title="">path</var> be the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a></code> object
   that was provided in the method's arguments.</p></li>

   <li><p>Run the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#text-preparation-algorithm">text preparation algorithm</a>, passing it
   <var title="">text</var>, the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasdrawingstyles">CanvasDrawingStyles</a></code>
   object argument, and, if the <var title="">maxWidth</var> argument
   was provided, that argument. Let <var title="">glyphs</var> be the
   resulting array, and <var title="">physical alignment</var> be the
   resulting alignment value.</p>

   </li><li><p>Let <var title="">width</var> be the aggregate length of all
   the subpaths in <var title="">path</var>, including the distances
   from the last point of each closed subpath to the first point of
   that subpath.</p></li>

   <li><p>Define <var title="">L</var> to be a linear coordinate line
   for of all the subpaths in <var title="">path</var>, with
   additional lines drawn between the last point and the first point
   of each closed subpath, such that the first point of the first
   subpath is defined as point 0, and the last point of the last
   subpath, if the last subpath is not closed, or the second
   occurrence first point of that subpath, if it is closed, is defined
   as point <var title="">width</var>.</p></li>

   <li>

    <p>Let <var title="">offset</var> be determined according to the
    appropriate step below:</p>

    <dl class="switch"><dt>If <var title="">physical alignment</var> is <i>left</i></dt>
     <dd>Let <var title="">offset</var> be zero.</dd>

     <dt>If <var title="">physical alignment</var> is <i>right</i></dt>
     <dd>Let <var title="">offset</var> be <var title="">width</var>.</dd>

     <dt>If <var title="">physical alignment</var> is <i title="">center</i></dt>
     <dd>Let <var title="">offset</var> be half of <var title="">width</var>.</dd>

    </dl></li>

   <li><p>Move all the shapes in <var title="">glyphs</var> to the
   right by <var title="">offset</var> CSS pixels.</p></li>

   <li>

    <p>For each glyph <var title="">glyph</var> in the <var title="">glyphs</var> array, run these substeps:</p>

    <ol><li><p>Let <var title="">dx</var> be the <var title="">x</var>-coordinate of the horizontal center of the
     bounding box of the shape described by <var title="">glyph</var>, in CSS pixels.</p></li>

     <li><p>If <var title="">dx</var> is negative or greater than <var title="">width</var>, skip the remainder of these substeps for
     this glyph.</p></li>

     <li><p>Recast <var title="">dx</var> to coordinate spaces units
     in <var title="">path</var>. (This just changes the
     dimensionality of <var title="">dx</var>, not its numeric
     value.)</p> <!-- hide this step if people get confused by the
     pedancy -->

     </li><li><p>Find the point <var title="">p</var> on <var title="">path</var> (or implied closing lines in <var title="">path</var>) that corresponds to the position <var title="">dx</var> on the coordinate line <var title="">L</var>.</p>

     </li><li><p>Let <var title="">θ</var> be the clockwise angle
     from the positive x-axis to the side of the line that is
     tangential to <var title="">path</var> at the point <var title="">p</var> that is going in the same direction as the line
     at point <var title="">p</var>.</p></li>

     <li><p>Rotate the shape described by <var title="">glyph</var>
     clockwise by <var title="">θ</var> about the point that is
     at the <var title="">dx</var> coordinate horizontally and the
     zero coordinate vertically.</p></li>

     <li><p>Let (<var title="">x</var>, <var title="">y</var>) be the
     coordinate of the point <var title="">p</var>.</p></li>

     <li><p>Move the shape described by <var title="">glyph</var> to
     the right by <var title="">x</var> and down by <var title="">y</var>.</p></li>

     <li><p>Let <var title="">glyph subpaths</var> be a list of
     subpaths describing the shape given in <var title="">glyph</var>,
     with each CSS pixel in the coordinate space of <var title="">glyph</var> mapped to one coordinate space unit in <var title="">glyph subpaths</var>. Subpaths in <var title="">glyph
     subpaths</var> must wind clockwise, regardless of how the user
     agent's font subsystem renders fonts and regardless of how the
     fonts themselves are defined.</p>

     </li><li><p>If the method is <code title="dom-path-addPathByStrokingText"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-path-addpathbystrokingtext">addPathByStrokingText()</a></code>,
     replace <var title="">glyph subpaths</var> by the result of <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#trace-a-path" title="trace a path">tracing</a> <var title="">glyph
     subpaths</var>, using the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasdrawingstyles">CanvasDrawingStyles</a></code> object
     argument for the line styles.</p>

     </li><li><p>Transform all the coordinates and lines in <var title="">glyph subpaths</var> by the transformation matrix <var title="">transform</var>, if it is not null.</p></li>

     <li><p>Let (<var title="">x<sub title="">final</sub></var>, <var title="">y<sub title="">final</sub></var>) be the last point in
     the last subpath of <var title="">glyph subpaths</var>. (This
     coordinate is only used if this is the last glyph
     processed.)</p></li>

     <li><p>Add all the subpaths in <var title="">glyph subpaths</var>
     to <var title="">target</var>.</p></li>

    </ol></li>

   <li><p>Create a new subpath in the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a></code> object with
   (<var title="">x<sub title="">final</sub></var>, <var title="">y<sub title="">final</sub></var>) as the only point in the
   subpath.</p></li>

  </ol></div>



  <h6 id="transformations"><span class="secno">4.8.11.1.8 </span><dfn title="dom-context-2d-transformation">Transformations</dfn></h6><div class="status REC"><p><strong>Implemented and widely deployed</strong></p><p class="idref"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#transformations">#transformations</a></p><div class="implementations"><p class="IE NONE" title="Latest Internet Explorer beta: does not support this feature">Latest Internet Explorer beta: unknown</p><p class="Firefox BUG" title="Latest Firefox trunk nightly build: has nearly complete support for this feature, but does not yet pass all the relevant test cases">Latest Firefox trunk nightly build: complete but buggy support</p><p class="Safari PARTIAL" title="Latest WebKit or Chromium trunk build: has partial support for this feature, but might have bugs and certainly doesn&#39;t support all aspects of this feature">Latest WebKit or Chromium trunk build: incomplete support</p><p class="Opera BUG" title="Latest Opera beta or preview build: has nearly complete support for this feature, but does not yet pass all the relevant test cases">Latest Opera beta or preview build: complete but buggy support</p><p class="Shims NONE" title="JavaScript libraries, plugins, etc: does not support this feature">JavaScript libraries, plugins, etc: unknown</p></div><p class="last-edit"><a>2012-03-26</a> <a>Hixie</a></p><p class="edit-link"><a href="http://www.whatwg.org/specs/web-apps/current-work/edit-section.html?section=transformations">Edit this information...</a></p></div>

  <p>Each <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasrenderingcontext2d">CanvasRenderingContext2D</a></code> object has a
  <i>current transformation matrix</i>, as well as methods (described
  in this section) to manipulate it. When a
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasrenderingcontext2d">CanvasRenderingContext2D</a></code> object is created, its
  transformation matrix must be initialized to the identity
  transform.</p>

  <p>The transformation matrix is applied to coordinates when creating
  the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#current-default-path">current default path</a>, and when painting text,
  shapes, and <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a></code> objects, on
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasrenderingcontext2d">CanvasRenderingContext2D</a></code> objects.</p> <!-- conformance
  criteria for actual drawing are described in the various sections
  below -->

  <p class="note">Most of the API uses <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#svgmatrix">SVGMatrix</a></code> objects
  rather than this API. This API remains mostly for historical
  reasons.</p>

  <div class="impl">

  <p>The transformations must be performed in reverse order.</p>

  <p class="note">For instance, if a scale transformation that doubles
  the width is applied to the canvas, followed by a rotation
  transformation that rotates drawing operations by a quarter turn,
  and a rectangle twice as wide as it is tall is then drawn on the
  canvas, the actual result will be a square.</p> <!-- q.v.
  http://goo.gl/5RLrN -->

  </div>

  <dl class="domintro"><dt><var title="">context</var> . <code title="dom-context-2d-currentTransform"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-currenttransform">currentTransform</a></code> [ = <var title="">value</var> ]</dt>

   <dd>

    <p>Returns the transformation matrix, as an <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#svgmatrix">SVGMatrix</a></code> object.</p>

    <p>Can be set, to change the transformation matrix.</p>

   </dd>

   <dt><var title="">context</var> . <code title="dom-context-2d-scale"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-scale">scale</a></code>(<var title="">x</var>, <var title="">y</var>)</dt>

   <dd>

    <p>Changes the transformation matrix to apply a scaling transformation with the given characteristics.</p>

   </dd>

   <dt><var title="">context</var> . <code title="dom-context-2d-rotate"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-rotate">rotate</a></code>(<var title="">angle</var>)</dt>

   <dd>

    <p>Changes the transformation matrix to apply a rotation transformation with the given characteristics. The angle is in radians.</p>

   </dd>

   <dt><var title="">context</var> . <code title="dom-context-2d-translate"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-translate">translate</a></code>(<var title="">x</var>, <var title="">y</var>)</dt>

   <dd>

    <p>Changes the transformation matrix to apply a translation transformation with the given characteristics.</p>

   </dd>

   <dt><var title="">context</var> . <code title="dom-context-2d-transform"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-transform">transform</a></code>(<var title="">a</var>, <var title="">b</var>, <var title="">c</var>, <var title="">d</var>, <var title="">e</var>, <var title="">f</var>)</dt>

   <dd>

    <p>Changes the transformation matrix to apply the matrix given by the arguments as described below.</p>

   </dd>

   <dt><var title="">context</var> . <code title="dom-context-2d-setTransform"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-settransform">setTransform</a></code>(<var title="">a</var>, <var title="">b</var>, <var title="">c</var>, <var title="">d</var>, <var title="">e</var>, <var title="">f</var>)</dt>

   <dd>

    <p>Changes the transformation matrix <em>to</em> the matrix given by the arguments as described below.</p>

   </dd>

   <dt><var title="">context</var> . <code title="dom-context-2d-resetTransform"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-resettransform">resetTransform</a></code>()</dt>

   <dd>

    <p>Changes the transformation matrix to the identity transform.</p>

   </dd>

  </dl><div class="impl">

  <p>The <dfn id="dom-context-2d-currenttransform" title="dom-context-2d-currentTransform"><code>currentTransform</code></dfn>,
  on getting, must return the last object that it was set to. On
  setting, its value must be changed to the new value, and the
  transformation matrix must be updated to match the matrix described
  by the new value. When the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasrenderingcontext2d">CanvasRenderingContext2D</a></code>
  object is created, the <code title="dom-context-2d-currentTransform"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-currenttransform">currentTransform</a></code>
  attribute must be set a newly created <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#svgmatrix">SVGMatrix</a></code> object.
  When the transformation matrix is mutated by the methods described
  in this section, the last <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#svgmatrix">SVGMatrix</a></code> object to which the
  attribute has been set must be mutated in a corresponding
  fashion.</p>

  <p>The <dfn id="dom-context-2d-scale" title="dom-context-2d-scale"><code>scale(<var title="">x</var>, <var title="">y</var>)</code></dfn> method must
  add the scaling transformation described by the arguments to the
  transformation matrix. The <var title="">x</var> argument represents
  the scale factor in the horizontal direction and the <var title="">y</var> argument represents the scale factor in the
  vertical direction. The factors are multiples.</p>

  <p>The <dfn id="dom-context-2d-rotate" title="dom-context-2d-rotate"><code>rotate(<var title="">angle</var>)</code></dfn> method must add the rotation
  transformation described by the argument to the transformation
  matrix. The <var title="">angle</var> argument represents a
  clockwise rotation angle expressed in radians.</p>

  <p>The <dfn id="dom-context-2d-translate" title="dom-context-2d-translate"><code>translate(<var title="">x</var>, <var title="">y</var>)</code></dfn> method must
  add the translation transformation described by the arguments to the
  transformation matrix. The <var title="">x</var> argument represents
  the translation distance in the horizontal direction and the <var title="">y</var> argument represents the translation distance in the
  vertical direction. The arguments are in coordinate space units.</p>

  <p>The <dfn id="dom-context-2d-transform" title="dom-context-2d-transform"><code>transform(<var title="">a</var>, <var title="">b</var>, <var title="">c</var>, <var title="">d</var>, <var title="">e</var>, <var title="">f</var>)</code></dfn> method must replace the current
  transformation matrix with the result of multiplying the current
  transformation matrix with the matrix described by:</p>

  </div>

  <table class="matrix"><tbody><tr><td><var title="">a</var></td>
    <td><var title="">c</var></td>
    <td><var title="">e</var></td>
   </tr><tr><td><var title="">b</var></td>
    <td><var title="">d</var></td>
    <td><var title="">f</var></td>
   </tr><tr><td>0</td>
    <td>0</td>
    <td>1</td>
   </tr></tbody></table><p class="note">The arguments <var title="">a</var>, <var title="">b</var>, <var title="">c</var>, <var title="">d</var>, <var title="">e</var>, and <var title="">f</var> are sometimes called
  <var title="">m11</var>, <var title="">m12</var>, <var title="">m21</var>, <var title="">m22</var>, <var title="">dx</var>,
  and <var title="">dy</var> or <var title="">m11</var>, <var title="">m21</var>, <var title="">m12</var>, <var title="">m22</var>, <var title="">dx</var>, and <var title="">dy</var>. Care should be taken in particular with the order
  of the second and third arguments (<var title="">b</var> and <var title="">c</var>) as their order varies from API to API and APIs
  sometimes use the notation <var title="">m12</var>/<var title="">m21</var> and sometimes <var title="">m21</var>/<var title="">m12</var> for those positions.</p>

  <div class="impl">

  <p>The <dfn id="dom-context-2d-settransform" title="dom-context-2d-setTransform"><code>setTransform(<var title="">a</var>, <var title="">b</var>, <var title="">c</var>, <var title="">d</var>, <var title="">e</var>,
  <var title="">f</var>)</code></dfn> method must reset the current
  transform to the identity matrix, and then invoke the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-transform" title="dom-context-2d-transform">transform</a>(<var title="">a</var>, <var title="">b</var>, <var title="">c</var>, <var title="">d</var>, <var title="">e</var>,
  <var title="">f</var>)</code> method with the same arguments.</p>

  <p>The <dfn id="dom-context-2d-resettransform" title="dom-context-2d-resetTransform"><code>resetTransform()</code></dfn>
  method must reset the current transform to the identity matrix.</p>

  </div>




  <h6 id="fill-and-stroke-styles"><span class="secno">4.8.11.1.9 </span>Fill and stroke styles</h6><div class="status REC"><p><strong>Implemented and widely deployed</strong></p><p class="idref"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#fill-and-stroke-styles">#fill-and-stroke-styles</a></p><div class="implementations"><p class="IE NONE" title="Latest Internet Explorer beta: does not support this feature">Latest Internet Explorer beta: unknown</p><p class="Firefox NONE" title="Latest Firefox trunk nightly build: does not support this feature">Latest Firefox trunk nightly build: unknown</p><p class="Safari NONE" title="Latest WebKit or Chromium trunk build: does not support this feature">Latest WebKit or Chromium trunk build: unknown</p><p class="Opera NONE" title="Latest Opera beta or preview build: does not support this feature">Latest Opera beta or preview build: unknown</p><p class="Shims NONE" title="JavaScript libraries, plugins, etc: does not support this feature">JavaScript libraries, plugins, etc: unknown</p></div><p class="last-edit"><a>2012-03-26</a> <a>Hixie</a></p><p class="edit-link"><a href="http://www.whatwg.org/specs/web-apps/current-work/edit-section.html?section=fill-and-stroke-styles">Edit this information...</a></p></div>

  <dl class="domintro"><dt><var title="">context</var> . <code title="dom-context-2d-fillStyle"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-fillstyle">fillStyle</a></code> [ = <var title="">value</var> ]</dt>

   <dd>

    <p>Returns the current style used for filling shapes.</p>

    <p>Can be set, to change the fill style.</p>

    <p>The style can be either a string containing a CSS color, or a
    <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasgradient">CanvasGradient</a></code> or <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvaspattern">CanvasPattern</a></code>
    object. Invalid values are ignored.</p>

   </dd>

   <dt><var title="">context</var> . <code title="dom-context-2d-strokeStyle"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-strokestyle">strokeStyle</a></code> [ = <var title="">value</var> ]</dt>

   <dd>

    <p>Returns the current style used for stroking shapes.</p>

    <p>Can be set, to change the stroke style.</p>

    <p>The style can be either a string containing a CSS color, or a
    <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasgradient">CanvasGradient</a></code> or <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvaspattern">CanvasPattern</a></code>
    object. Invalid values are ignored.</p>

   </dd>

  </dl><div class="impl">

  <!-- v6 feature requests:

   * Getting and setting colours by component to bypass the CSS value parsing.

     Either:
        context.fillStyle.red += 1;

     Or:
        var array = context.fillStyle;
        array[1] += 1;
        context.fillStyle = array;

   * A more performant way of setting colours in general, e.g.:

       context.setFillColor(r,g,b,a) // already supported by webkit

     Or:

       context.fillStyle = 0xRRGGBBAA; // set a 32bit int directly

   * fill rule for deciding between winding and even-odd algorithms.
     SVG has fill-rule: nonzero | evenodd
       http://www.w3.org/TR/SVG/painting.html#FillProperties
     see also mozFillRule: http://lists.whatwg.org/pipermail/whatwg-whatwg.org/2011-June/032002.html

  -->

  <p>The <dfn id="dom-context-2d-fillstyle" title="dom-context-2d-fillStyle"><code>fillStyle</code></dfn>
  attribute represents the color or style to use inside shapes, and
  the <dfn id="dom-context-2d-strokestyle" title="dom-context-2d-strokeStyle"><code>strokeStyle</code></dfn>
  attribute represents the color or style to use for the lines around
  the shapes.</p>

  <p>Both attributes can be either strings,
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasgradient">CanvasGradient</a></code>s, or <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvaspattern">CanvasPattern</a></code>s. On
  setting, strings must be <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#parsed-as-a-css-color-value" title="parsed as a CSS &lt;color&gt;
  value">parsed as CSS &lt;color&gt; values</a> and the color
  assigned, and <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasgradient">CanvasGradient</a></code> and
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvaspattern">CanvasPattern</a></code> objects must be assigned themselves. <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/references.html#refsCSSCOLOR">[CSSCOLOR]</a> If the value is a string but
  cannot be <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#parsed-as-a-css-color-value">parsed as a CSS &lt;color&gt; value</a>, or is
  neither a string, a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasgradient">CanvasGradient</a></code>, nor a
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvaspattern">CanvasPattern</a></code>, then it must be ignored, and the
  attribute must retain its previous value.</p>

  <p>When set to a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvaspattern">CanvasPattern</a></code> or
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasgradient">CanvasGradient</a></code> object, the assignment is
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#live">live</a>, meaning that changes made to the object after the
  assignment do affect subsequent stroking or filling of shapes.</p>

  <p>On getting, if the value is a color, then the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#serialization-of-a-color" title="serialization of a color">serialization of the color</a>
  must be returned. Otherwise, if it is not a color but a
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasgradient">CanvasGradient</a></code> or <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvaspattern">CanvasPattern</a></code>, then the
  respective object must be returned. (Such objects are opaque and
  therefore only useful for assigning to other attributes or for
  comparison to other gradients or patterns.)</p>

  <p>The <dfn id="serialization-of-a-color">serialization of a color</dfn><div class="status CWD"><p><strong>Warning! Likely to change!</strong></p><p class="idref"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#serialization-of-a-color">#serialization-of-a-color</a></p><div class="implementations"><p class="IE PASS" title="Latest Internet Explorer beta: passes all the available test cases for this feature">Latest Internet Explorer beta: excellent support</p><p class="Firefox PASS" title="Latest Firefox trunk nightly build: passes all the available test cases for this feature">Latest Firefox trunk nightly build: excellent support</p><p class="Safari BUG" title="Latest WebKit or Chromium trunk build: has nearly complete support for this feature, but does not yet pass all the relevant test cases">Latest WebKit or Chromium trunk build: complete but buggy support</p><p class="Opera BUG" title="Latest Opera beta or preview build: has nearly complete support for this feature, but does not yet pass all the relevant test cases">Latest Opera beta or preview build: complete but buggy support</p><p class="Shims NONE" title="JavaScript libraries, plugins, etc: does not support this feature">JavaScript libraries, plugins, etc: unknown</p></div><p class="last-edit"><a>2011-02-27</a> <a>Ms2ger</a></p><p class="edit-link"><a href="http://www.whatwg.org/specs/web-apps/current-work/edit-section.html?section=serialization-of-a-color">Edit this information...</a></p></div> for a color value is a
  string, computed as follows: if it has alpha equal to 1.0, then the
  string is a lowercase six-digit hex value, prefixed with a "#"
  character (U+0023 NUMBER SIGN), with the first two digits
  representing the red component, the next two digits representing the
  green component, and the last two digits representing the blue
  component, the digits being in the range 0-9 a-f (U+0030 to U+0039
  and U+0061 to U+0066). Otherwise, the color value has alpha less
  than 1.0, and the string is the color value in the CSS <code title="">rgba()</code> functional-notation format: the literal
  string <code title="">rgba</code> (U+0072 U+0067 U+0062 U+0061)
  followed by a U+0028 LEFT PARENTHESIS, a base-ten integer in the
  range 0-255 representing the red component (using digits 0-9, U+0030
  to U+0039, in the shortest form possible), a literal U+002C COMMA
  and U+0020 SPACE, an integer for the green component, a comma and a
  space, an integer for the blue component, another comma and space, a
  U+0030 DIGIT ZERO, if the alpha value is greater than zero then a
  U+002E FULL STOP (representing the decimal point), if the alpha
  value is greater than zero then one or more digits in the range 0-9
  (U+0030 to U+0039) representing the fractional part of the alpha<!--
  value with no trailing zeros (implied by next sentence)-->, and
  finally a U+0029 RIGHT PARENTHESIS. User agents must express the
  fractional part of the alpha value, if any, with the level of
  precision necessary for the alpha value, when reparsed, to be
  interpreted as the same alpha value.</p> <!-- if people complain
  this is unreadable, expand it into a <dl> with two nested <ol>s -->

  <p>When the context is created, the <code title="dom-context-2d-fillStyle"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-fillstyle">fillStyle</a></code> and <code title="dom-context-2d-strokeStyle"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-strokestyle">strokeStyle</a></code> attributes
  must initially have the string value <code title="">#000000</code>.</p>

  <p>When the value is a color, it must not be affected by the
  transformation matrix when used to draw on the canvas.</p> <!-- so
  singular matrices don't affect solid color fillStyles -->

  </div>

  <hr><p>There are two types of gradients, linear gradients and radial
  gradients, both represented by objects implementing the opaque
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasgradient">CanvasGradient</a></code> interface.</p>

  <p id="interpolation">Once a gradient has been created (see below),
  stops are placed along it to define how the colors are distributed
  along the gradient. <span class="impl">The color of the gradient at
  each stop is the color specified for that stop. Between each such
  stop, the colors and the alpha component must be linearly
  interpolated over the RGBA space without premultiplying the alpha
  value to find the color to use at that offset. Before the first
  stop, the color must be the color of the first stop. After the last
  stop, the color must be the color of the last stop. When there are
  no stops, the gradient is transparent black.</span></p>

  <dl class="domintro"><dt><var title="">gradient</var> . <code title="dom-canvasgradient-addColorStop"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-canvasgradient-addcolorstop">addColorStop</a></code>(<var title="">offset</var>, <var title="">color</var>)</dt>

   <dd>

    <p>Adds a color stop with the given color to the gradient at the
    given offset. 0.0 is the offset at one end of the gradient, 1.0 is
    the offset at the other end.</p>

    <p>Throws an <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#indexsizeerror">IndexSizeError</a></code> exception if the offset
    is out of range. Throws a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#syntaxerror">SyntaxError</a></code> exception if the
    color cannot be parsed.</p>

   </dd>

   <dt><var title="">gradient</var> = <var title="">context</var> . <code title="dom-context-2d-createLinearGradient"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-createlineargradient">createLinearGradient</a></code>(<var title="">x0</var>, <var title="">y0</var>, <var title="">x1</var>, <var title="">y1</var>)</dt>

   <dd>

    <p>Returns a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasgradient">CanvasGradient</a></code> object that represents a
    linear gradient that paints along the line given by the
    coordinates represented by the arguments.</p>

    <p>If any of the arguments are not finite numbers, throws a
    <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#notsupportederror">NotSupportedError</a></code> exception.</p>

   </dd>

   <dt><var title="">gradient</var> = <var title="">context</var> . <code title="dom-context-2d-createRadialGradient"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-createradialgradient">createRadialGradient</a></code>(<var title="">x0</var>, <var title="">y0</var>, <var title="">r0</var>, <var title="">x1</var>, <var title="">y1</var>, <var title="">r1</var>)</dt>

   <dd>

    <p>Returns a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasgradient">CanvasGradient</a></code> object that represents a
    radial gradient that paints along the cone given by the circles
    represented by the arguments.</p>

    <p>If any of the arguments are not finite numbers, throws a
    <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#notsupportederror">NotSupportedError</a></code> exception. If either of the radii
    are negative, throws an <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#indexsizeerror">IndexSizeError</a></code> exception.</p>

   </dd>

  </dl><div class="impl">

  <p>The <dfn id="dom-canvasgradient-addcolorstop" title="dom-canvasgradient-addColorStop"><code>addColorStop(<var title="">offset</var>, <var title="">color</var>)</code></dfn>
  method on the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasgradient">CanvasGradient</a></code> interface adds a new stop
  to a gradient. If the <var title="">offset</var> is less than 0,
  greater than 1, infinite, or NaN, then an
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#indexsizeerror">IndexSizeError</a></code> exception must be thrown. If the <var title="">color</var> cannot be <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#parsed-as-a-css-color-value">parsed as a CSS &lt;color&gt;
  value</a>, then a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#syntaxerror">SyntaxError</a></code> exception must be
  thrown. Otherwise, the gradient must have a new stop placed, at
  offset <var title="">offset</var> relative to the whole gradient,
  and with the color obtained by parsing <var title="">color</var> as
  a CSS &lt;color&gt; value. If multiple stops are added at the same
  offset on a gradient, they must be placed in the order added, with
  the first one closest to the start of the gradient, and each
  subsequent one infinitesimally further along towards the end point
  (in effect causing all but the first and last stop added at each
  point to be ignored).</p>

  <p>The <dfn id="dom-context-2d-createlineargradient" title="dom-context-2d-createLinearGradient"><code>createLinearGradient(<var title="">x0</var>, <var title="">y0</var>, <var title="">x1</var>,
  <var title="">y1</var>)</code></dfn> method takes four arguments
  that represent the start point (<var title="">x0</var>, <var title="">y0</var>) and end point (<var title="">x1</var>, <var title="">y1</var>) of the gradient. If any of the arguments to <code title="dom-context-2d-createLinearGradient"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-createlineargradient">createLinearGradient()</a></code>
  are infinite or NaN, the method must throw a
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#notsupportederror">NotSupportedError</a></code> exception. Otherwise, the method must
  return a linear <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasgradient">CanvasGradient</a></code> initialized with the
  specified line.</p>

  <p>Linear gradients must be rendered such that all points on a line
  perpendicular to the line that crosses the start and end points have
  the color at the point where those two lines cross (with the colors
  coming from the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#interpolation">interpolation and
  extrapolation</a> described above). The points in the linear
  gradient must be transformed as described by the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#transformations" title="dom-context-2d-transformation">current transformation
  matrix</a> when rendering.</p>

  <p>If <span title=""><var title="">x0</var>&nbsp;=&nbsp;<var title="">x1</var></span> and <span title=""><var title="">y0</var>&nbsp;=&nbsp;<var title="">y1</var></span>, then
  the linear gradient must paint nothing.</p>

  <p>The <dfn id="dom-context-2d-createradialgradient" title="dom-context-2d-createRadialGradient"><code>createRadialGradient(<var title="">x0</var>, <var title="">y0</var>, <var title="">r0</var>,
  <var title="">x1</var>, <var title="">y1</var>, <var title="">r1</var>)</code></dfn> method takes six arguments, the
  first three representing the start circle with origin (<var title="">x0</var>, <var title="">y0</var>) and radius <var title="">r0</var>, and the last three representing the end circle
  with origin (<var title="">x1</var>, <var title="">y1</var>) and
  radius <var title="">r1</var>. The values are in coordinate space
  units. If any of the arguments are infinite or NaN, a
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#notsupportederror">NotSupportedError</a></code> exception must be thrown. If either
  of <var title="">r0</var> or <var title="">r1</var> are negative, an
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#indexsizeerror">IndexSizeError</a></code> exception must be thrown. Otherwise,
  the method must return a radial <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasgradient">CanvasGradient</a></code>
  initialized with the two specified circles.</p>

  <p>Radial gradients must be rendered by following these steps:</p>

  <ol><li><p>If <span title=""><var title="">x<sub>0</sub></var>&nbsp;=&nbsp;<var title="">x<sub>1</sub></var></span> and <span title=""><var title="">y<sub>0</sub></var>&nbsp;=&nbsp;<var title="">y<sub>1</sub></var></span> and <span title=""><var title="">r<sub>0</sub></var>&nbsp;=&nbsp;<var title="">r<sub>1</sub></var></span>, then the radial gradient must
   paint nothing. Abort these steps.</p></li>

   <li>

    <p>Let <span title="">x(<var title="">ω</var>)&nbsp;=&nbsp;(<var title="">x<sub>1</sub></var>-<var title="">x<sub>0</sub></var>)<var title="">ω</var>&nbsp;+&nbsp;<var title="">x<sub>0</sub></var></span></p>

    <p>Let <span title="">y(<var title="">ω</var>)&nbsp;=&nbsp;(<var title="">y<sub>1</sub></var>-<var title="">y<sub>0</sub></var>)<var title="">ω</var>&nbsp;+&nbsp;<var title="">y<sub>0</sub></var></span></p>

    <p>Let <span title="">r(<var title="">ω</var>)&nbsp;=&nbsp;(<var title="">r<sub>1</sub></var>-<var title="">r<sub>0</sub></var>)<var title="">ω</var>&nbsp;+&nbsp;<var title="">r<sub>0</sub></var></span></p>

    <p>Let the color at <var title="">ω</var> be the color at
    that position on the gradient (with the colors coming from the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#interpolation">interpolation and extrapolation</a>
    described above).</p>

   </li>

   <li><p>For all values of <var title="">ω</var> where <span title="">r(<var title="">ω</var>)&nbsp;&gt;&nbsp;0</span>,
   starting with the value of <var title="">ω</var> nearest to
   positive infinity and ending with the value of <var title="">ω</var> nearest to negative infinity, draw the
   circumference of the circle with radius <span title="">r(<var title="">ω</var>)</span> at position (<span title="">x(<var title="">ω</var>)</span>, <span title="">y(<var title="">ω</var>)</span>), with the color at <var title="">ω</var>, but only painting on the parts of the
   canvas that have not yet been painted on by earlier circles in this
   step for this rendering of the gradient.</p></li>

  </ol><p class="note">This effectively creates a cone, touched by the two
  circles defined in the creation of the gradient, with the part of
  the cone before the start circle (0.0) using the color of the first
  offset, the part of the cone after the end circle (1.0) using the
  color of the last offset, and areas outside the cone untouched by
  the gradient (transparent black).</p>

  <p>The resulting radial gradient must then be transformed as
  described by the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#transformations" title="dom-context-2d-transformation">current
  transformation matrix</a> when rendering.</p>

  <p>Gradients must be painted only where the relevant stroking or
  filling effects requires that they be drawn.</p>

  </div>

  <hr><p>Patterns are represented by objects implementing the opaque
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvaspattern">CanvasPattern</a></code> interface.</p>

  <dl class="domintro"><dt><var title="">pattern</var> = <var title="">context</var> . <code title="dom-context-2d-createPattern"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-createpattern">createPattern</a></code>(<var title="">image</var>, <var title="">repetition</var>)</dt>

   <dd>

    <p>Returns a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvaspattern">CanvasPattern</a></code> object that uses the given image
    and repeats in the direction(s) given by the <var title="">repetition</var> argument.</p>

    <p>The allowed values for <var title="">repetition</var> are <code title="">repeat</code> (both directions), <code title="">repeat-x</code> (horizontal only), <code title="">repeat-y</code> (vertical only), and <code title="">no-repeat</code> (neither). If the <var title="">repetition</var> argument is empty, the value <code title="">repeat</code> is used.</p>

    <p>If the image has no image data, throws an
    <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#invalidstateerror">InvalidStateError</a></code> exception. If the second argument
    isn't one of the allowed values, throws a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#syntaxerror">SyntaxError</a></code>
    exception. If the image isn't yet fully decoded, then the method
    returns null.</p>

   </dd>

   <dt><var title="">pattern</var> . <code title="dom-canvaspattern-setTransform"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-canvaspattern-settransform">setTransform</a></code>(<var title="">transform</var>)</dt>

   <dd>

    <p>Sets the transformation matrix that will be used when rendering
    the pattern during a fill or stroke painting operation.</p>

   </dd>

  </dl><div class="impl">

  <p>To create objects of this type, the <dfn id="dom-context-2d-createpattern" title="dom-context-2d-createPattern"><code>createPattern(<var title="">image</var>, <var title="">repetition</var>)</code></dfn>
  method is used. The first argument gives the image to use as the
  pattern (either an <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/embedded-content-1.html#htmlimageelement">HTMLImageElement</a></code>,
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#htmlcanvaselement">HTMLCanvasElement</a></code>, or <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#htmlvideoelement">HTMLVideoElement</a></code>
  object). Modifying this image after calling the <code title="dom-context-2d-createPattern"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-createpattern">createPattern()</a></code> method
  must not affect the pattern. The second argument must be a string
  with one of the following values: <code title="">repeat</code>,
  <code title="">repeat-x</code>, <code title="">repeat-y</code>,
  <code title="">no-repeat</code>. If the empty string is specified,
  <code title="">repeat</code> must be assumed. If an unrecognized value
  is given, then the user agent must throw a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#syntaxerror">SyntaxError</a></code>
  exception. User agents must recognize the four values described above
  exactly (e.g. they must not do case folding). Except as specified
  below, the method must return a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvaspattern">CanvasPattern</a></code> object
  suitably initialized.</p>

  <p>The <var title="">image</var> argument is an instance of either
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/embedded-content-1.html#htmlimageelement">HTMLImageElement</a></code>, <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#htmlcanvaselement">HTMLCanvasElement</a></code>, or
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#htmlvideoelement">HTMLVideoElement</a></code>.</p> <!-- drawImage() has an equivalent
  paragraph -->

  <p>If the <var title="">image</var> argument is an
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/embedded-content-1.html#htmlimageelement">HTMLImageElement</a></code> object that is not <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/embedded-content-1.html#img-good" title="img-good">fully decodable</a>, or if the <var title="">image</var> argument is an <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#htmlvideoelement">HTMLVideoElement</a></code>
  object whose <code title="dom-media-readyState"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#dom-media-readystate">readyState</a></code>
  attribute is either <code title="dom-media-HAVE_NOTHING"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#dom-media-have_nothing">HAVE_NOTHING</a></code> or <code title="dom-media-HAVE_METADATA"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#dom-media-have_metadata">HAVE_METADATA</a></code>, then the
  implementation must return null.</p> <!-- drawImage() has an
  equivalent paragraph -->

  <p>If the <var title="">image</var> argument is an
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#htmlcanvaselement">HTMLCanvasElement</a></code> object with either a horizontal
  dimension or a vertical dimension equal to zero, then the
  implementation must throw an <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#invalidstateerror">InvalidStateError</a></code>
  exception.</p>
  <!-- drawImage() has an equivalent paragraph -->

  <p>Patterns have a transformation matrix, which controls how the
  pattern is used when it is painted. Initially, a pattern's
  transformation matrix must be the identity transform.</p>

  <p>When the <dfn id="dom-canvaspattern-settransform" title="dom-canvaspattern-setTransform"><code>setTransform()</code></dfn>
  method is invoked on the pattern, the user agent must replace the
  pattern's transformation matrix with the one described by the
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#svgmatrix">SVGMatrix</a></code> object provided as an argument to the
  method.</p>

  <p>When a pattern is to be rendered within an area, the user agent
  must run the following steps to determine what is rendered:</p>

  <ol><li><p>Create an infinite transparent black bitmap.</p></li>

   <li>

    <p>Place a copy of the image on the bitmap, anchored such that its
    top left corner is at the origin of the coordinate space, with one
    coordinate space unit per CSS pixel of the image, then place
    repeated copies of this image horizontally to the left and right,
    if the <code>repeat-x</code> string was specified, or vertically
    up and down, if the <code>repeat-y</code> string was specified, or
    in all four directions all over the bitmap, if the
    <code>repeat</code> string was specified.</p>

    <p>If the original image data is a bitmap image, the value painted
    at a point in the area of the repetitions is computed by filtering
    the original image data. If the <code title="dom-context-2d-imageSmoothingEnabled"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-imagesmoothingenabled">imageSmoothingEnabled</a></code>
    attribute is set to true, then the user agent may use any
    filtering algorithm (for example bilinear interpolation or
    nearest-neighbor). If the <code title="dom-context-2d-imageSmoothingEnabled"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-imagesmoothingenabled">imageSmoothingEnabled</a></code>
    attribute is set to false, the image must be rendered using
    nearest-neighbor interpolation. When such a filtering algorithm
    requires a pixel value from outside the original image data, it
    must instead use the value from wrapping the pixel's coordinates
    to the original image's dimensions. (That is, the filter uses
    'repeat' behavior, regardless of the value of <var title="">repetition</var>.)
    <!-- drawImage() has similar paragraphs with different rules -->

   </p></li>

   <li><p>Transform the resulting bitmap according to the pattern's
   transformation matrix.</p></li>

   <li><p>Transform the resulting bitmap again, this time according to
   the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#transformations" title="dom-context-2d-transformation">current
   transformation matrix</a>.</p></li>

   <li><p>Replace any part of the image outside the area in which the
   pattern is to be rendered with transparent black.</p></li>

   <li><p>The resulting bitmap is what is to be rendered, with the
   same origin and same scale.</p></li>

  </ol><p>When the <code title="dom-context-2d-createPattern"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-createpattern">createPattern()</a></code> method
  is passed an animated image as its <var title="">image</var>
  argument, the user agent must use the poster frame of the animation,
  or, if there is no poster frame, the first frame of the
  animation.</p>
  <!-- drawImage() has an equivalent paragraph -->

  <p>When the <var title="">image</var> argument is an
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#htmlvideoelement">HTMLVideoElement</a></code>, then the frame at the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#current-playback-position">current
  playback position</a> must be used as the source image, and the
  source image's dimensions must be the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#concept-video-intrinsic-width" title="concept-video-intrinsic-width">intrinsic width</a> and
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#concept-video-intrinsic-height" title="concept-video-intrinsic-height">intrinsic height</a>
  of the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#media-resource">media resource</a> (i.e. after any aspect-ratio
  correction has been applied).</p>
  <!-- drawImage() has an equivalent paragraph -->

  </div>

  <div class="impl">

  <hr><p>If a radial gradient or repeated pattern is used when the
  transformation matrix is singular, the resulting style must be
  transparent black (otherwise the gradient or pattern would be
  collapsed to a point or line, leaving the other pixels undefined).
  Linear gradients and solid colors always define all points even with
  singular tranformation matrices.</p>

  </div>




  <h6 id="drawing-rectangles-to-the-canvas"><span class="secno">4.8.11.1.10 </span>Drawing rectangles to the canvas</h6><div class="status REC"><p><strong>Implemented and widely deployed</strong></p><p class="idref"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#drawing-rectangles-to-the-canvas">#drawing-rectangles-to-the-canvas</a></p><div class="implementations"><p class="IE NONE" title="Latest Internet Explorer beta: does not support this feature">Latest Internet Explorer beta: unknown</p><p class="Firefox NONE" title="Latest Firefox trunk nightly build: does not support this feature">Latest Firefox trunk nightly build: unknown</p><p class="Safari NONE" title="Latest WebKit or Chromium trunk build: does not support this feature">Latest WebKit or Chromium trunk build: unknown</p><p class="Opera NONE" title="Latest Opera beta or preview build: does not support this feature">Latest Opera beta or preview build: unknown</p><p class="Shims NONE" title="JavaScript libraries, plugins, etc: does not support this feature">JavaScript libraries, plugins, etc: unknown</p></div><p class="last-edit"><a>2012-03-26</a> <a>Hixie</a></p><p class="edit-link"><a href="http://www.whatwg.org/specs/web-apps/current-work/edit-section.html?section=drawing-rectangles-to-the-canvas">Edit this information...</a></p></div>

  <p>There are three methods that immediately draw rectangles to the
  bitmap. They each take four arguments; the first two give the <var title="">x</var> and <var title="">y</var> coordinates of the top
  left of the rectangle, and the second two give the width <var title="">w</var> and height <var title="">h</var> of the rectangle,
  respectively.</p>

  <div class="impl">

  <p>The <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#transformations" title="dom-context-2d-transformation">current
  transformation matrix</a> must be applied to the following four
  coordinates, which form the path that must then be closed to get the
  specified rectangle: <span title="">(<var title="">x</var>, <var title="">y</var>)</span>, <span title="">(<span title=""><var title="">x</var>+<var title="">w</var></span>, <var title="">y</var>)</span>,
  <span title="">(<span title=""><var title="">x</var>+<var title="">w</var></span>,
  <span title=""><var title="">y</var>+<var title="">h</var></span>)</span>,
  <span title="">(<var title="">x</var>, <span title=""><var title="">y</var>+<var title="">h</var></span>)</span>.</p>

  <p>Shapes are painted without affecting the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#current-default-path">current default
  path</a>, and are subject to the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#clipping-region">clipping region</a>,
  and, with the exception of <code title="dom-context-2d-clearRect"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-clearrect">clearRect()</a></code>, also <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#shadows" title="shadows">shadow effects</a>, <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-globalalpha" title="dom-context-2d-globalAlpha">global alpha</a>, and <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-globalcompositeoperation" title="dom-context-2d-globalCompositeOperation">global composition
  operators</a>.</p>

  </div>

  <dl class="domintro"><dt><var title="">context</var> . <code title="dom-context-2d-clearRect"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-clearrect">clearRect</a></code>(<var title="">x</var>, <var title="">y</var>, <var title="">w</var>, <var title="">h</var>)</dt>

   <dd>

    <p>Clears all pixels on the canvas in the given rectangle to transparent black.</p>

   </dd>

   <dt><var title="">context</var> . <code title="dom-context-2d-fillRect"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-fillrect">fillRect</a></code>(<var title="">x</var>, <var title="">y</var>, <var title="">w</var>, <var title="">h</var>)</dt>

   <dd>

    <p>Paints the given rectangle onto the canvas, using the current fill style.</p>

   </dd>

   <dt><var title="">context</var> . <code title="dom-context-2d-strokeRect"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-strokerect">strokeRect</a></code>(<var title="">x</var>, <var title="">y</var>, <var title="">w</var>, <var title="">h</var>)</dt>

   <dd>

    <p>Paints the box that outlines the given rectangle onto the canvas, using the current stroke style.</p>

   </dd>

  </dl><div class="impl">

  <p>The <dfn id="dom-context-2d-clearrect" title="dom-context-2d-clearRect"><code>clearRect(<var title="">x</var>, <var title="">y</var>, <var title="">w</var>, <var title="">h</var>)</code></dfn> method must run the following steps:</p>

  <ol><li><p>Let <var title="">pixels</var> be the set of pixels in the
   specified rectangle that also intersect the current <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#clipping-region">clipping
   region</a>.</p></li>

   <li><p>Clear the pixels in <var title="">pixels</var> to a fully
   transparent black, erasing any previous image.</p></li>

   <li><p><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#clear-regions-that-cover-the-pixels">Clear regions that cover the pixels</a> in <var title="">pixels</var> in the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element.</p></li>

  </ol><p class="note">If either height or width are zero, this method has
  no effect, since the set of pixels would be empty.</p>

  <p>The <dfn id="dom-context-2d-fillrect" title="dom-context-2d-fillRect"><code>fillRect(<var title="">x</var>, <var title="">y</var>, <var title="">w</var>, <var title="">h</var>)</code></dfn> method must paint the specified
  rectangular area using the <code title="dom-context-2d-fillStyle"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-fillstyle">fillStyle</a></code>. If either height
  or width are zero, this method has no effect.</p>

  <p>The <dfn id="dom-context-2d-strokerect" title="dom-context-2d-strokeRect"><code>strokeRect(<var title="">x</var>, <var title="">y</var>, <var title="">w</var>, <var title="">h</var>)</code></dfn> method must take the result of <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#trace-a-path" title="trace a path">tracing the path</a> described below, using
  the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasrenderingcontext2d">CanvasRenderingContext2D</a></code> object's line styles, and
  fill it with the <code title="dom-context-2d-strokeStyle"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-strokestyle">strokeStyle</a></code>.</p>

  <p>If both <var title="">w</var> and <var title="">h</var> are zero,
  the path has a single subpath with just one point (<var title="">x</var>, <var title="">y</var>), and no lines, and this
  method thus has no effect (the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#trace-a-path">trace a path</a> algorithm
  returns an empty path in that case).</p>

  <p>If just one of either <var title="">w</var> or <var title="">h</var> is zero, then the path has a single subpath
  consisting of two points, with coordinates (<span title=""><var title="">x</var></span>, <span title=""><var title="">y</var></span>) and (<span title=""><var title="">x</var>+<var title="">w</var></span>, <span title=""><var title="">y</var></span>+<var title="">h</var>), in that order,
  connected by a single straight line.</p>

  <p>Otherwise, the path has a single subpath are four points, with
  coordinates (<span title=""><var title="">x</var></span>, <span title=""><var title="">y</var></span>), (<span title=""><var title="">x</var>+<var title="">w</var></span>, <span title=""><var title="">y</var></span>), (<span title=""><var title="">x</var>+<var title="">w</var></span>, <span title=""><var title="">y</var></span>+<var title="">h</var>), and (<span title=""><var title="">x</var></span>, <span title=""><var title="">y</var>+<var title="">h</var></span>), connected to each
  other in that order by straight lines.</p>

  </div>



  <h6 id="drawing-text-to-the-canvas"><span class="secno">4.8.11.1.11 </span>Drawing text to the canvas</h6><div class="status REC"><p><strong>Implemented and widely deployed</strong></p><p class="idref"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#drawing-text-to-the-canvas">#drawing-text-to-the-canvas</a></p><div class="implementations"><p class="IE NONE" title="Latest Internet Explorer beta: does not support this feature">Latest Internet Explorer beta: unknown</p><p class="Firefox NONE" title="Latest Firefox trunk nightly build: does not support this feature">Latest Firefox trunk nightly build: unknown</p><p class="Safari NONE" title="Latest WebKit or Chromium trunk build: does not support this feature">Latest WebKit or Chromium trunk build: unknown</p><p class="Opera NONE" title="Latest Opera beta or preview build: does not support this feature">Latest Opera beta or preview build: unknown</p><p class="Shims NONE" title="JavaScript libraries, plugins, etc: does not support this feature">JavaScript libraries, plugins, etc: unknown</p></div><p class="last-edit"><a>2012-03-26</a> <a>Hixie</a></p><p class="edit-link"><a href="http://www.whatwg.org/specs/web-apps/current-work/edit-section.html?section=drawing-text-to-the-canvas">Edit this information...</a></p></div>

  <dl class="domintro"><dt><var title="">context</var> . <code title="dom-context-2d-fillText"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-filltext">fillText</a></code>(<var title="">text</var>, <var title="">x</var>, <var title="">y</var> [, <var title="">maxWidth</var> ] )</dt>
   <dt><var title="">context</var> . <code title="dom-context-2d-strokeText"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-stroketext">strokeText</a></code>(<var title="">text</var>, <var title="">x</var>, <var title="">y</var> [, <var title="">maxWidth</var> ] )</dt>

   <dd>

    <p>Fills or strokes (respectively) the given text at the given
    position. If a maximum width is provided, the text will be scaled
    to fit that width if necessary.</p>

   </dd>

   <dt><var title="">metrics</var> = <var title="">context</var> . <code title="dom-context-2d-measureText"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-measuretext">measureText</a></code>(<var title="">text</var>)</dt>

   <dd>

    <p>Returns a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#textmetrics">TextMetrics</a></code> object with the metrics of the given text in the current font.</p>

   </dd>

   <dt><var title="">metrics</var> . <code title="dom-textmetrics-width"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-textmetrics-width">width</a></code></dt>
   <dt><var title="">metrics</var> . <code title="dom-textmetrics-actualBoundingBoxLeft"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-textmetrics-actualboundingboxleft">actualBoundingBoxLeft</a></code></dt>
   <dt><var title="">metrics</var> . <code title="dom-textmetrics-actualBoundingBoxRight"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-textmetrics-actualboundingboxright">actualBoundingBoxRight</a></code></dt>
   <dt><var title="">metrics</var> . <code title="dom-textmetrics-fontBoundingBoxAscent"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-textmetrics-fontboundingboxascent">fontBoundingBoxAscent</a></code></dt>
   <dt><var title="">metrics</var> . <code title="dom-textmetrics-fontBoundingBoxDescent"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-textmetrics-fontboundingboxdescent">fontBoundingBoxDescent</a></code></dt>
   <dt><var title="">metrics</var> . <code title="dom-textmetrics-actualBoundingBoxAscent"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-textmetrics-actualboundingboxascent">actualBoundingBoxAscent</a></code></dt>
   <dt><var title="">metrics</var> . <code title="dom-textmetrics-actualBoundingBoxDescent"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-textmetrics-actualboundingboxdescent">actualBoundingBoxDescent</a></code></dt>
   <dt><var title="">metrics</var> . <code title="dom-textmetrics-emHeightAscent"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-textmetrics-emheightascent">emHeightAscent</a></code></dt>
   <dt><var title="">metrics</var> . <code title="dom-textmetrics-emHeightDescent"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-textmetrics-emheightdescent">emHeightDescent</a></code></dt>
   <dt><var title="">metrics</var> . <code title="dom-textmetrics-hangingBaseline"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-textmetrics-hangingbaseline">hangingBaseline</a></code></dt>
   <dt><var title="">metrics</var> . <code title="dom-textmetrics-alphabeticBaseline"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-textmetrics-alphabeticbaseline">alphabeticBaseline</a></code></dt>
   <dt><var title="">metrics</var> . <code title="dom-textmetrics-ideographicBaseline"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-textmetrics-ideographicbaseline">ideographicBaseline</a></code></dt>

   <dd>

    <p>Returns the measurement described below.</p>

   </dd>

  </dl><div class="impl">

  <p>The <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasrenderingcontext2d">CanvasRenderingContext2D</a></code> interface provides the
  following methods for rendering text directly to the canvas.</p>

  <p>The <dfn id="dom-context-2d-filltext" title="dom-context-2d-fillText"><code>fillText()</code></dfn> and
  <dfn id="dom-context-2d-stroketext" title="dom-context-2d-strokeText"><code>strokeText()</code></dfn>
  methods take three or four arguments, <var title="">text</var>, <var title="">x</var>, <var title="">y</var>, and optionally <var title="">maxWidth</var>, and render the given <var title="">text</var> at the given (<var title="">x</var>, <var title="">y</var>) coordinates ensuring that the text isn't wider
  than <var title="">maxWidth</var> if specified, using the current
  <code title="dom-context-2d-font"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-font">font</a></code>, <code title="dom-context-2d-textAlign"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textalign">textAlign</a></code>, and <code title="dom-context-2d-textBaseline"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textbaseline">textBaseline</a></code>
  values. Specifically, when the methods are called, the user agent
  must run the following steps:</p>

  <ol><li><p>Run the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#text-preparation-algorithm">text preparation algorithm</a>, passing it
   <var title="">text</var>, the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasrenderingcontext2d">CanvasRenderingContext2D</a></code>
   object, and, if the <var title="">maxWidth</var> argument was
   provided, that argument. Let <var title="">glyphs</var> be the
   result.</p>

   </li><li><p>Move all the shapes in <var title="">glyphs</var> to the
   right by <var title="">x</var> CSS pixels and down by <var title="">y</var> CSS pixels.</p></li>

   <li>

    <p>Paint the shapes given in <var title="">glyphs</var>, as
    transformed by the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#transformations" title="dom-context-2d-transformation">current transformation
    matrix</a>, with each CSS pixel in the coordinate space of <var title="">glyphs</var> mapped to one coordinate space unit.</p>

    <p>For <code title="dom-context-2d-fillText"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-filltext">fillText()</a></code>,
    <code title="dom-context-2d-fillStyle"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-fillstyle">fillStyle</a></code> must be
    applied to the shapes and <code title="dom-context-2d-strokeStyle"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-strokestyle">strokeStyle</a></code> must be
    ignored. For <code title="dom-context-2d-strokeText"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-stroketext">strokeText()</a></code>, the reverse
    holds: <code title="dom-context-2d-strokeStyle"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-strokestyle">strokeStyle</a></code>
    must be applied to the result of <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#trace-a-path" title="trace a
    path">tracing</a> the shapes using the
    <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasrenderingcontext2d">CanvasRenderingContext2D</a></code> object for the line styles,
    and <code title="dom-context-2d-fillStyle"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-fillstyle">fillStyle</a></code> must
    be ignored.</p>

    <p>These shapes are painted without affecting the current path,
    and are subject to <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#shadows" title="shadows">shadow effects</a>,
    <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-globalalpha" title="dom-context-2d-globalAlpha">global alpha</a>, the
    <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#clipping-region">clipping region</a>, and <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-globalcompositeoperation" title="dom-context-2d-globalCompositeOperation">global composition
    operators</a>.</p>

   </li>

  </ol><!--v6DVT - this is commented out until CSS can get its act together
enough to actual specify vertical text rendering (how long have we
been waiting now?)

WHEN EDITING THIS, FIX THE PARTS MARKED "&#x0058;&#x0058;&#x0058;" BELOW

ALSO NOTE THAT THIS PROBABLY NEEDS ENTIRELY REVISITING NOW THAT WE
HAVE REJIGGED HOW TEXT WORKS IN v5

  <p>The <dfn
  title="dom-context-2d-fillVerticalText"><code>fillVerticalText()</code></dfn>
  and <dfn
  title="dom-context-2d-strokeVerticalText"><code>strokeVerticalText()</code></dfn>
  methods take three or four arguments, <var title="">text</var>, <var
  title="">x</var>, <var title="">y</var>, and optionally <var
  title="">maxHeight</var>, and render the given <var
  title="">text</var> as vertical text at the given (<var
  title="">x</var>, <var title="">y</var>) coordinates ensuring that
  the text isn't taller than <var title="">maxHeight</var> if
  specified, using the current <code
  title="dom-context-2d-font">font</code> and <code
  title="dom-context-2d-textAlign">textAlign</code>
  values. Specifically, when the methods are called, the user agent
  must run the following steps:</p>

  <ol>

   <li><p>If <var title="">maxHeight</var> is present but less than or
   equal to zero, return without doing anything; abort these
   steps.</p></li>

   <li><p>Let <var title="">font</var> be the current font of the
   context, as given by the <code
   title="dom-context-2d-font">font</code> attribute.</p></li>

   <li><p>Replace all the <span title="space character">space
   characters</span> in <var title="">text</var> with U+0020 SPACE
   characters.</p></li>

   <li><p>Form a <em class="&#x0058;&#x0058;&#x0058;">whatever CSS ends up calling
   vertical line boxes and inline boxes</em> containing the text <var
   title="">text</var>, with all the properties at their initial
   values except the 'font' property of the inline box set to <var
   title="">font</var> and the 'direction' property of the inline
   box set to <span>the directionality</span> of the <code>canvas</code>
   element.</p></li>

   <!- - if you insert a step here, make sure to adjust the next step's
   final words - ->

   <li><p>If the <var title="">maxHeight</var> argument was specified
   and the hypothetical height of the <em class="&#x0058;&#x0058;&#x0058;">box</em>
   in the hypothetical line box is greater than <var
   title="">maxHeight</var> CSS pixels, then change <var
   title="">font</var> to have a more condensed font (if one is
   available or if a reasonably readable one can be synthesized by
   applying an appropriate scale factor to the font) or a smaller
   font, and return to the previous step.</p></li>

   <li>

    <p>Let the <var title="">anchor point</var> be a point on the <em
    class="&#x0058;&#x0058;&#x0058;">inline box</var>, determined by the <code
    title="dom-context-2d-textAlign">textAlign</code>, as follows:</p>

    <p>Vertical position:</p>

    <dl>

     <dt>If <code
     title="dom-context-2d-textAlign">textAlign</code> is <code
     title="">start</code></dt>
     <dt>If <code
     title="dom-context-2d-textAlign">textAlign</code> is <code
     title="">left</code> and <span>the directionality</span> of the
     <code>canvas</code> element is 'ltr'</dt>
     <dt>If <code
     title="dom-context-2d-textAlign">textAlign</code> is <code
     title="">right</code> and <span>the directionality</span> of the
     <code>canvas</code> element is 'rtl'</dt>

     <dd>Let the <var title="">anchor point</var>'s vertical
     position be the top edge of the <em class="&#x0058;&#x0058;&#x0058;">inline
     box</em>.</dd>

     <dt>If <code
     title="dom-context-2d-textAlign">textAlign</code> is <code
     title="">end</code></dt>
     <dt>If <code
     title="dom-context-2d-textAlign">textAlign</code> is <code
     title="">right</code> and <span>the directionality</span> of the
     <code>canvas</code> element is 'ltr'</dt>
     <dt>If <code
     title="dom-context-2d-textAlign">textAlign</code> is <code
     title="">left</code> and <span>the directionality</span> of the
     <code>canvas</code> element is 'rtl'</dt>

     <dd>Let the <var title="">anchor point</var>'s vertical
     position be the bottom edge of the <em class="&#x0058;&#x0058;&#x0058;">inline
     box</em>.</dd>


     <dt>If <code
     title="dom-context-2d-textAlign">textAlign</code> is <code
     title="">center</code></dt>

     <dd>Let the <var title="">anchor point</var>'s vertical position
     be half way between the top and bottom edges of the <em
     class="&#x0058;&#x0058;&#x0058;">inline box</em>.</dd>

    </dl>

    <p>Let the horizontal position be half way between the left and
    right edges of the em box of the first available font of the <em
    class="&#x0058;&#x0058;&#x0058;">inline box</em>.</p>

   </li>

   <li>

    <p>Paint the hypothetical inline box as the shape given by the
    text's glyphs, as transformed by the <span
    title="dom-context-2d-transformation">current transformation
    matrix</span>, and anchored and sized so that before applying the
    <span title="dom-context-2d-transformation">current transformation
    matrix</span>, the <var title="">anchor point</var> is at (<var
    title="">x</var>, <var title="">y</var>) and each CSS pixel is
    mapped to one coordinate space unit.</p>

    <p>For <code
    title="dom-context-2d-fillVerticalText">fillVerticalText()</code>
    <code title="dom-context-2d-fillStyle">fillStyle</code> must be
    applied and <code
    title="dom-context-2d-strokeStyle">strokeStyle</code> must be
    ignored. For <code
    title="dom-context-2d-strokeVerticalText">strokeVerticalText()</code>
    the reverse holds and <code
    title="dom-context-2d-strokeStyle">strokeStyle</code> must be
    applied and <code
    title="dom-context-2d-fillStyle">fillStyle</code> must be
    ignored.</p>

    <p>Text is painted without affecting the current path, and is
    subject to <span title="shadows">shadow effects</span>, <span
    title="dom-context-2d-globalAlpha">global alpha</span>, the
    <span>clipping region</span>, and <span
    title="dom-context-2d-globalCompositeOperation">global composition
    operators</span>.</p>

   </li>

  </ol>

v6DVT (also check for '- -' bits in the part above) --><p>The <dfn id="dom-context-2d-measuretext" title="dom-context-2d-measureText"><code>measureText()</code></dfn>
  method takes one argument, <var title="">text</var>. When the method
  is invoked, the user agent must replace all the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/common-microsyntaxes.html#space-character" title="space
  character">space characters</a> in <var title="">text</var> with
  U+0020 SPACE characters, and then must form a hypothetical
  infinitely-wide CSS line box containing a single inline box
  containing the text <var title="">text</var>, with all the
  properties at their initial values except the 'white-space' property
  of the inline element set to 'pre' and the 'font' property of the
  inline element set to the current font of the context as given by
  the <code title="dom-context-2d-font"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-font">font</a></code> attribute, and
  must then create a new <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#textmetrics">TextMetrics</a></code> object with its
  attributes set as described in the following list.
<!--ADD-TOPIC:Security-->
  If doing these measurements requires using a font that has an
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/origin-0.html#origin">origin</a> that is not the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/origin-0.html#same-origin" title="same
  origin">same</a> as that of the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/dom.html#document">Document</a></code> object that
  owns the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element (even if "using a font" means
  just checking if that font has a particular glyph in it before
  falling back to another font), then the method must throw a
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#securityerror">SecurityError</a></code> exception.
<!--REMOVE-TOPIC:Security-->
  Otherwise, it must return the new <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#textmetrics">TextMetrics</a></code> object.
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/references.html#refsCSS">[CSS]</a>
  <a class="fingerprint" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/introduction.html#fingerprint"><img alt="(This is a fingerprinting vector.)" src="./4.8.11 The canvas element — HTML Standard_files/fingerprint.png"></a>
  </p>

  </div>

  <dl><dt><dfn id="dom-textmetrics-width" title="dom-textmetrics-width"><code>width</code></dfn> attribute</dt>

   <dd><p>The width of that inline box, in CSS pixels. (The text's advance width.)</p></dd>

   <dt><dfn id="dom-textmetrics-actualboundingboxleft" title="dom-textmetrics-actualBoundingBoxLeft"><code>actualBoundingBoxLeft</code></dfn> attribute</dt>

   <dd>
    <p>The distance parallel to the baseline from the alignment point given by the <code title="dom-context-2d-textAlign"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textalign">textAlign</a></code> attribute to the left side of the bounding rectangle of the given text, in CSS pixels; positive numbers indicating a distance going left from the given alignment point.
    </p><p class="note">The sum of this value and the next (<code title="dom-textmetrics-actualBoundingBoxRight"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-textmetrics-actualboundingboxright">actualBoundingBoxRight</a></code>) can be wider than the width of the inline box (<code title="dom-textmetrics-width"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-textmetrics-width">width</a></code>), in particular with slanted fonts where characters overhang their advance width.</p>

   </dd>

   <dt><dfn id="dom-textmetrics-actualboundingboxright" title="dom-textmetrics-actualBoundingBoxRight"><code>actualBoundingBoxRight</code></dfn> attribute</dt>

   <dd>
    <p>The distance parallel to the baseline from the alignment point given by the <code title="dom-context-2d-textAlign"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textalign">textAlign</a></code> attribute to the right side of the bounding rectangle of the given text, in CSS pixels; positive numbers indicating a distance going right from the given alignment point.</p>
   </dd>

   <dt><dfn id="dom-textmetrics-fontboundingboxascent" title="dom-textmetrics-fontBoundingBoxAscent"><code>fontBoundingBoxAscent</code></dfn> attribute</dt>

   <dd>
    <p>The distance from the horizontal line indicated by the <code title="dom-context-2d-textBaseline"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textbaseline">textBaseline</a></code> attribute to the top of the highest bounding rectangle of all the fonts used to render the text, in CSS pixels; positive numbers indicating a distance going up from the given baseline.</p>
    <p class="note">This value and the next are useful when rendering a background that must have a consistent height even if the exact text being rendered changes. The <code title="dom-textmetrics-actualBoundingBoxAscent"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-textmetrics-actualboundingboxascent">actualBoundingBoxAscent</a></code> attribute (and its corresponding attribute for the descent) are useful when drawing a bounding box around specific text.</p>
   </dd>

   <dt><dfn id="dom-textmetrics-fontboundingboxdescent" title="dom-textmetrics-fontBoundingBoxDescent"><code>fontBoundingBoxDescent</code></dfn> attribute</dt>

   <dd><p>The distance from the horizontal line indicated by the <code title="dom-context-2d-textBaseline"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textbaseline">textBaseline</a></code> attribute to the bottom of the lowest bounding rectangle of all the fonts used to render the text, in CSS pixels; positive numbers indicating a distance going down from the given baseline.</p></dd>

   <dt><dfn id="dom-textmetrics-actualboundingboxascent" title="dom-textmetrics-actualBoundingBoxAscent"><code>actualBoundingBoxAscent</code></dfn> attribute</dt>

   <dd>
    <p>The distance from the horizontal line indicated by the <code title="dom-context-2d-textBaseline"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textbaseline">textBaseline</a></code> attribute to the top of the bounding rectangle of the given text, in CSS pixels; positive numbers indicating a distance going up from the given baseline.
    </p><p class="note">This number can vary greatly based on the input text, even if the first font specified covers all the characters in the input. For example, the <code title="dom-textmetrics-actualBoundingBoxAscent"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-textmetrics-actualboundingboxascent">actualBoundingBoxAscent</a></code> of a lowercase "o" from an alphabetic baseline would be less than that of an uppercase "F". The value can easily be negative; for example, the distance from the top of the em box (<code title="dom-context-2d-textBaseline"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textbaseline">textBaseline</a></code> value "<code title="dom-context-2d-textBaseline-top"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textbaseline-top">top</a></code>") to the top of the bounding rectangle when the given text is just a single comma "<code title="">,</code>" would likely (unless the font is quite unusual) be negative.</p>
   </dd>

   <dt><dfn id="dom-textmetrics-actualboundingboxdescent" title="dom-textmetrics-actualBoundingBoxDescent"><code>actualBoundingBoxDescent</code></dfn> attribute</dt>

   <dd><p>The distance from the horizontal line indicated by the <code title="dom-context-2d-textBaseline"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textbaseline">textBaseline</a></code> attribute to the bottom of the bounding rectangle of the given text, in CSS pixels; positive numbers indicating a distance going down from the given baseline.</p></dd>

   <dt><dfn id="dom-textmetrics-emheightascent" title="dom-textmetrics-emHeightAscent"><code>emHeightAscent</code></dfn> attribute</dt>

   <dd><p>The distance from the horizontal line indicated by the <code title="dom-context-2d-textBaseline"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textbaseline">textBaseline</a></code> attribute to the top of the em square in the line box, in CSS pixels; positive numbers indicating that the given baseline is below the top of the em square (so this value will usually be positive). Zero if the given baseline is the top of the em square; half the font size if the given baseline is the middle of the em square.</p></dd>

   <dt><dfn id="dom-textmetrics-emheightdescent" title="dom-textmetrics-emHeightDescent"><code>emHeightDescent</code></dfn> attribute</dt>

   <dd><p>The distance from the horizontal line indicated by the <code title="dom-context-2d-textBaseline"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textbaseline">textBaseline</a></code> attribute to the bottom of the em square in the line box, in CSS pixels; positive numbers indicating that the given baseline is below the bottom of the em square (so this value will usually be negative). (Zero if the given baseline is the top of the em square.)</p></dd>

   <dt><dfn id="dom-textmetrics-hangingbaseline" title="dom-textmetrics-hangingBaseline"><code>hangingBaseline</code></dfn> attribute</dt>

   <dd><p>The distance from the horizontal line indicated by the <code title="dom-context-2d-textBaseline"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textbaseline">textBaseline</a></code> attribute to the hanging baseline of the line box, in CSS pixels; positive numbers indicating that the given baseline is below the hanging baseline. (Zero if the given baseline is the hanging baseline.)</p></dd>

   <dt><dfn id="dom-textmetrics-alphabeticbaseline" title="dom-textmetrics-alphabeticBaseline"><code>alphabeticBaseline</code></dfn> attribute</dt>

   <dd><p>The distance from the horizontal line indicated by the <code title="dom-context-2d-textBaseline"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textbaseline">textBaseline</a></code> attribute to the alphabetic baseline of the line box, in CSS pixels; positive numbers indicating that the given baseline is below the alphabetic baseline. (Zero if the given baseline is the alphabetic baseline.)</p></dd>

   <dt><dfn id="dom-textmetrics-ideographicbaseline" title="dom-textmetrics-ideographicBaseline"><code>ideographicBaseline</code></dfn> attribute</dt>

   <dd><p>The distance from the horizontal line indicated by the <code title="dom-context-2d-textBaseline"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-textbaseline">textBaseline</a></code> attribute to the ideographic baseline of the line box, in CSS pixels; positive numbers indicating that the given baseline is below the ideographic baseline. (Zero if the given baseline is the ideographic baseline.)</p></dd>

  </dl><p class="note">Glyphs rendered using <code title="dom-context-2d-fillText"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-filltext">fillText()</a></code> and <code title="dom-context-2d-strokeText"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-stroketext">strokeText()</a></code> can spill out
  of the box given by the font size (the em square size) and the width
  returned by <code title="dom-context-2d-measureText"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-measuretext">measureText()</a></code> (the text
  width). Authors are encouraged to use the bounding box values
  described above if this is an issue.</p>

  <p class="note">A future version of the 2D context API may provide a
  way to render fragments of documents, rendered using CSS, straight
  to the canvas. This would be provided in preference to a dedicated
  way of doing multiline layout.</p>



  <h6 id="drawing-paths-to-the-canvas"><span class="secno">4.8.11.1.12 </span>Drawing paths to the canvas</h6><div class="status CR"><p><strong>Awaiting implementation feedback</strong></p><p class="idref"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#drawing-paths-to-the-canvas">#drawing-paths-to-the-canvas</a></p><div class="implementations"><p class="IE NONE" title="Latest Internet Explorer beta: does not support this feature">Latest Internet Explorer beta: unknown</p><p class="Firefox NONE" title="Latest Firefox trunk nightly build: does not support this feature">Latest Firefox trunk nightly build: unknown</p><p class="Safari NONE" title="Latest WebKit or Chromium trunk build: does not support this feature">Latest WebKit or Chromium trunk build: unknown</p><p class="Opera NONE" title="Latest Opera beta or preview build: does not support this feature">Latest Opera beta or preview build: unknown</p><p class="Shims NONE" title="JavaScript libraries, plugins, etc: does not support this feature">JavaScript libraries, plugins, etc: unknown</p></div><p class="last-edit"><a>2012-03-26</a> <a>Hixie</a></p><p class="edit-link"><a href="http://www.whatwg.org/specs/web-apps/current-work/edit-section.html?section=drawing-paths-to-the-canvas">Edit this information...</a></p></div>

  <p>The context always has a <dfn id="current-default-path">current default path</dfn>. There
  is only one <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#current-default-path">current default path</a>, it is not part of the
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#drawing-state">drawing state</a>. The <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#current-default-path">current default path</a> is
  a <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#concept-path" title="concept-path">path</a>, as described above.</p>

  <dl class="domintro"><dt><var title="">context</var> . <code title="dom-context-2d-beginPath"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-beginpath">beginPath</a></code>()</dt>

   <dd>

    <p>Resets the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#current-default-path">current default path</a>.</p>

   </dd>

   <dt><var title="">context</var> . <code title="dom-context-2d-fill"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-fill">fill</a></code>()</dt>
   <dt><var title="">context</var> . <code title="dom-context-2d-fill"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-fill">fill</a></code>(<var title="">path</var>)</dt>

   <dd>

    <p>Fills the subpaths of the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#current-default-path">current default path</a> or the given path with the current fill style.</p>

   </dd>


   <dt><var title="">context</var> . <code title="dom-context-2d-stroke"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-stroke">stroke</a></code>()</dt>
   <dt><var title="">context</var> . <code title="dom-context-2d-stroke"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-stroke">stroke</a></code>(<var title="">path</var>)</dt>

   <dd>

    <p>Strokes the subpaths of the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#current-default-path">current default path</a> or the given path with the current stroke style.</p>

   </dd>


   <dt><var title="">context</var> . <code title="dom-context-2d-drawSystemFocusRing"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-drawsystemfocusring">drawSystemFocusRing</a></code>(<var title="">element</var>)</dt>
   <dt><var title="">context</var> . <code title="dom-context-2d-drawSystemFocusRing"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-drawsystemfocusring">drawSystemFocusRing</a></code>(<var title="">path</var>, <var title="">element</var>)</dt>

   <dd>

    <p>If the given element is focused, draws a focus ring around the
    <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#current-default-path">current default path</a> or hte given path, following the platform
    conventions for focus rings.</p>

   </dd>


   <dt><var title="">shouldDraw</var> = <var title="">context</var> . <code title="dom-context-2d-drawCustomFocusRing"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-drawcustomfocusring">drawCustomFocusRing</a></code>(<var title="">element</var>)</dt>
   <dt><var title="">shouldDraw</var> = <var title="">context</var> . <code title="dom-context-2d-drawCustomFocusRing"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-drawcustomfocusring">drawCustomFocusRing</a></code>(<var title="">path</var>, <var title="">element</var>)</dt>

   <dd>

    <p>If the given element is focused, and the user has configured
    his system to draw focus rings in a particular manner (for
    example, high contrast focus rings), draws a focus ring around the
    <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#current-default-path">current default path</a> or the given path and returns
    false.</p>

    <p>Otherwise, returns true if the given element is focused, and
    false otherwise. This can thus be used to determine when to draw a
    focus ring (see <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#drawCustomFocusRingExample">the
    example</a> below).</p>

   </dd>


   <dt><var title="">context</var> . <code title="dom-context-2d-scrollPathIntoView"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-scrollpathintoview">scrollPathIntoView</a></code>()</dt>
   <dt><var title="">context</var> . <code title="dom-context-2d-scrollPathIntoView"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-scrollpathintoview">scrollPathIntoView</a></code>(<var title="">path</var>)</dt>

   <dd>

    <p>Scrolls the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#current-default-path">current default path</a> or the given path
    into view. This is especially useful on devices with small
    screens, where the whole canvas might not be visible at once.</p>

   </dd>


   <dt><var title="">context</var> . <code title="dom-context-2d-clip"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-clip">clip</a></code>()</dt>
   <dt><var title="">context</var> . <code title="dom-context-2d-clip"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-clip">clip</a></code>(<var title="">path</var>)</dt>

   <dd>

    <p>Further constrains the clipping region to the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#current-default-path">current
    default path</a> or the given path.</p>

   </dd>


   <dt><var title="">context</var> . <code title="dom-context-2d-resetClip"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-resetclip">resetClip</a></code>()</dt>

   <dd>

    <p>Unconstrains the clipping region.</p>

   </dd>


   <dt><var title="">context</var> . <code title="dom-context-2d-isPointInPath"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-ispointinpath">isPointInPath</a></code>(<var title="">x</var>, <var title="">y</var>)</dt>
   <dt><var title="">context</var> . <code title="dom-context-2d-isPointInPath"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-ispointinpath">isPointInPath</a></code>(<var title="">path</var>, <var title="">x</var>, <var title="">y</var>)</dt>

   <dd>

    <p>Returns true if the given point is in the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#current-default-path">current default path</a>.</p>

   </dd>

  </dl><div class="impl">

  <p>The <dfn id="dom-context-2d-beginpath" title="dom-context-2d-beginPath"><code>beginPath()</code></dfn>
  method must empty the list of subpaths in the context's
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#current-default-path">current default path</a> so that the it once again has zero
  subpaths.</p>

  <p>Where the following method definitions use the term <i>intended
  path</i>, it means the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a></code> argument, if one was
  provided, or the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#current-default-path">current default path</a> otherwise.</p>

  <p>When the intended path is a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a></code> object, the
  coordinates and lines of its subpaths must be transformed according
  to the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasrenderingcontext2d">CanvasRenderingContext2D</a></code> object's <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#transformations" title="dom-context-2d-transformation">current transformation
  matrix</a> when used by these methods (without affecting the
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a></code> object itself). When the intended path is the
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#current-default-path">current default path</a>, it is not affected by the
  transform. (This is because transformations already affect the
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#current-default-path">current default path</a> when it is constructed, so
  applying it when it is painted as well would result in a double
  transformation.)</p>

  <p>The <dfn id="dom-context-2d-fill" title="dom-context-2d-fill"><code>fill()</code></dfn>
  method must fill all the subpaths of the intended path, using <code title="dom-context-2d-fillStyle"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-fillstyle">fillStyle</a></code>, and using the
  non-zero winding number rule. Open subpaths must be implicitly
  closed when being filled (without affecting the actual
  subpaths).</p>

  <p class="note">Thus, if two overlapping but otherwise independent
  subpaths have opposite windings, they cancel out and result in no
  fill. If they have the same winding, that area just gets painted
  once.</p>

  <p>The <dfn id="dom-context-2d-stroke" title="dom-context-2d-stroke"><code>stroke()</code></dfn> method
  must <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#trace-a-path" title="trace a path">trace</a> the intended path,
  using the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasrenderingcontext2d">CanvasRenderingContext2D</a></code> object for the line
  styles, and then fill the combined stroke area using the <code title="dom-context-2d-strokeStyle"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-strokestyle">strokeStyle</a></code> attribute.</p>

  <p class="note">As a result of how the algorithm to <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#trace-a-path">trace a
  path</a> is defined, overlapping parts of the paths in one stroke
  operation are treated as if their union was what was painted.</p>

  <p class="note">The stroke <em>style</em> is affected by the
  transformation during painting, even if the intended path is the
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#current-default-path">current default path</a>.</p>

  <p>Paths, when filled or stroked, must be painted without affecting
  the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#current-default-path">current default path</a> or any <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a></code>
  objects, and must be subject to <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#shadows" title="shadows">shadow
  effects</a>, <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-globalalpha" title="dom-context-2d-globalAlpha">global
  alpha</a>, the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#clipping-region">clipping region</a>, and <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-globalcompositeoperation" title="dom-context-2d-globalCompositeOperation">global composition
  operators</a>. (The effect of transformations is described above
  and varies based on which path is being used.)</p>

  <p>Zero-length line segments must be pruned before stroking a path.
  Empty subpaths must be ignored.</p>

  <hr><p id="dom-context-2d-drawosfocusring">The <dfn id="dom-context-2d-drawsystemfocusring" title="dom-context-2d-drawSystemFocusRing"><code>drawSystemFocusRing(<var title="">element</var>)</code></dfn> method, when invoked, must run
  the following steps:</p>

  <ol><li><p>If <var title="">element</var> is not focused or is not a
   descendant of the element with whose context the method is
   associated, then abort these steps.</p></li>

   <li>

    <p>If the user has requested the use of particular focus rings
    (e.g. high-contrast focus rings), or if the <var title="">element</var> would have a focus ring drawn around it,
    then draw a focus ring of the appropriate style along the intended
    path, following platform conventions.</p>

    <p class="note">Some platforms only draw focus rings around
    elements that have been focused from the keyboard, and not those
    focused from the mouse. Other platforms simply don't draw focus
    rings around some elements at all unless relevant accessibility
    features are enabled. This API is intended to follow these
    conventions. User agents that implement distinctions based on the
    manner in which the element was focused are encouraged to classify
    focus driven by the <code title="dom-focus"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/editing.html#dom-focus">focus()</a></code> method
    based on the kind of user interaction event from which the call
    was triggered (if any).</p>

    <p>The focus ring should not be subject to the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#shadows" title="shadows">shadow effects</a>, the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-globalalpha" title="dom-context-2d-globalAlpha">global alpha</a>, or the
    <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-globalcompositeoperation" title="dom-context-2d-globalCompositeOperation">global
    composition operators</a>, but <em>should</em> be subject to
    the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#clipping-region">clipping region</a>. (The effect of transformations
    is described above and varies based on which path is being
    used.)</p>

   </li>

   <li>

    <p>Optionally, <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#inform">inform the user</a> that the
    focus is at the location given by the intended path. User agents
    may wait until the next time the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#event-loop">event loop</a> reaches
    its "update the rendering" step to optionally inform the user.</p>

   </li>

  </ol><p>The <dfn id="dom-context-2d-drawcustomfocusring" title="dom-context-2d-drawCustomFocusRing"><code>drawCustomFocusRing(<var title="">element</var>)</code></dfn> method, when invoked, must run
  the following steps:</p>

  <ol><li><p>If <var title="">element</var> is not focused or is not a
   descendant of the element with whose context the method is
   associated, then return false and abort these steps.</p></li>

   <li><p>Let <var title="">result</var> be true.</p></li>

   <li>

    <p>If the user has requested the use of particular focus rings
    (e.g. high-contrast focus rings), then draw a focus ring of the
    appropriate style along the intended path, and set <var title="">result</var> to false.</p>

    <p>The focus ring should not be subject to the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#shadows" title="shadows">shadow effects</a>, the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-globalalpha" title="dom-context-2d-globalAlpha">global alpha</a>, or the
    <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-globalcompositeoperation" title="dom-context-2d-globalCompositeOperation">global
    composition operators</a>, but <em>should</em> be subject to
    the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#clipping-region">clipping region</a>. (The effect of transformations
    is described above and varies based on which path is being
    used.)</p>

   </li>

   <li>

    <p>Optionally, <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#inform">inform the user</a> that the
    focus is at the location given by the intended path. User agents
    may wait until the next time the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#event-loop">event loop</a> reaches
    its "update the rendering" step to optionally inform the user.</p>

   </li>

   <li><p>Return <var title="">result</var>.</p></li>

  </ol><p>The <dfn id="dom-context-2d-scrollpathintoview" title="dom-context-2d-scrollPathIntoView"><code>scrollPathIntoView()</code></dfn>
  method, when invoked, must run the following steps:</p>

  <ol><li><p>Let <var title="">the specified rectangle</var> be the
   rectangle of the bounding box of the intended path.</p></li>

   <li><p>Let <var title="">notional child</var> be a hypothetical
   element that is a rendered child of the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element
   whose dimensions are those of <var title="">the specified
   rectangle</var>.</p></li>

   <li><p><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#scroll-an-element-into-view" title="scroll an element into view">Scroll <var title="">notional child</var> into view</a> with the <var title="">align to top flag</var> set.</p>

   </li><li><p>Optionally, <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#inform">inform the user</a> that the
   caret and/or selection cover <var title="">the specified
   rectangle</var> of the canvas. User agents may wait until the next
   time the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#event-loop">event loop</a> reaches its "update the rendering"
   step to optionally inform the user.</p></li>

  </ol><p class="note" id="inform">"Inform the user", as used in this
  section, could mean calling a system accessibility API, which would
  notify assistive technologies such as magnification tools. To
  properly drive magnification based on a focus change, a system
  accessibility API driving a screen magnifier needs the bounds for
  the newly focused object. The methods above are intended to enable
  this by allowing the user agent to report the bounding box of the
  path used to render the focus ring as the bounds of the <var title="">element</var> element passed as an argument, if that
  element is focused, and the bounding box of the area to which the
  user agent is scrolling as the bounding box of the current
  selection.</p>

  <hr><p>The <dfn id="dom-context-2d-clip" title="dom-context-2d-clip"><code>clip()</code></dfn>
  method must create a new <dfn id="clipping-region">clipping region</dfn> by calculating
  the intersection of the current clipping region and the area
  described by the intended path, using the non-zero winding number
  rule. Open subpaths must be implicitly closed when computing the
  clipping region, without affecting the actual subpaths. The new
  clipping region replaces the current clipping region.</p>

  <p>When the context is initialized, the clipping region must be set
  to the rectangle with the top left corner at (0,0) and the width and
  height of the coordinate space.</p>

  <!-- v6
   Jordan OSETE suggests:
    * support ways of extending the clipping region (union instead of intersection)
       - also "add", "subtract", "replace", "intersect" and "xor"
       - maybe just support creating unions, intersections, and other -ions of paths
  -->

  <p>The <dfn id="dom-context-2d-resetclip" title="dom-context-2d-resetClip"><code>resetClip()</code></dfn>
  method must create a new <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#clipping-region">clipping region</a> that is the
  rectangle with the top left corner at (0,0) and the width and height
  of the coordinate space. The new clipping region replaces the
  current clipping region.</p>

  <hr><p>The <dfn id="dom-context-2d-ispointinpath" title="dom-context-2d-isPointInPath"><code>isPointInPath(<var title="">x</var>, <var title="">y</var>)</code></dfn> method must
  return true if the point given by the <var title="">x</var> and <var title="">y</var> coordinates passed to the method, when treated as
  coordinates in the canvas coordinate space unaffected by the current
  transformation, is inside the intended path as determined by the
  non-zero winding number rule; and must return false otherwise.
  Points on the path itself must be considered to be inside the path.
  If either of the arguments is infinite or NaN, then the method must
  return false.</p>

  </div>


  <div class="example" id="drawCustomFocusRingExample">

   <p>This <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element has a couple of checkboxes. The
   path-related commands are highlighted:</p>

   <pre>&lt;canvas height=400 width=750&gt;
 &lt;label&gt;&lt;input type=checkbox id=showA&gt; Show As&lt;/label&gt;
 &lt;label&gt;&lt;input type=checkbox id=showB&gt; Show Bs&lt;/label&gt;
 &lt;!-- ... --&gt;
&lt;/canvas&gt;
&lt;script&gt;
 function drawCheckbox(context, element, x, y, paint) {
   context.save();
   context.font = '10px sans-serif';
   context.textAlign = 'left';
   context.textBaseline = 'middle';
   var metrics = context.measureText(element.labels[0].textContent);
   if (paint) {
<strong>     context.beginPath();
     context.strokeStyle = 'black';
     context.rect(x-5, y-5, 10, 10);
     context.stroke();
</strong>     if (element.checked) {
<strong>       context.fillStyle = 'black';
       context.fill();
</strong>     }
     context.fillText(element.labels[0].textContent, x+5, y);
   }
<strong>   context.beginPath();
   context.rect(x-7, y-7, 12 + metrics.width+2, 14);
   if (paint &amp;&amp; context.drawCustomFocusRing(element)) {
     context.strokeStyle = 'silver';
     context.stroke();
   }
</strong>   context.restore();
 }
 function drawBase() { /* ... */ }
 function drawAs() { /* ... */ }
 function drawBs() { /* ... */ }
 function redraw() {
   var canvas = document.getElementsByTagName('canvas')[0];
   var context = canvas.getContext('2d');
   context.clearRect(0, 0, canvas.width, canvas.height);
   drawCheckbox(context, document.getElementById('showA'), 20, 40, true);
   drawCheckbox(context, document.getElementById('showB'), 20, 60, true);
   drawBase();
   if (document.getElementById('showA').checked)
     drawAs();
   if (document.getElementById('showB').checked)
     drawBs();
 }
 function processClick(event) {
   var canvas = document.getElementsByTagName('canvas')[0];
   var context = canvas.getContext('2d');
   var x = event.clientX;
   var y = event.clientY;
   var node = event.target;
   while (node) {
     x -= node.offsetLeft - node.scrollLeft;
     y -= node.offsetTop - node.scrollTop;
     node = node.offsetParent;
   }
   drawCheckbox(context, document.getElementById('showA'), 20, 40, false);
   if (<strong>context.isPointInPath(x, y)</strong>)
     document.getElementById('showA').checked = !(document.getElementById('showA').checked);
   drawCheckbox(context, document.getElementById('showB'), 20, 60, false);
   if (<strong>context.isPointInPath(x, y)</strong>)
     document.getElementById('showB').checked = !(document.getElementById('showB').checked);
   redraw();
 }
 document.getElementsByTagName('canvas')[0].addEventListener('focus', redraw, true);
 document.getElementsByTagName('canvas')[0].addEventListener('blur', redraw, true);
 document.getElementsByTagName('canvas')[0].addEventListener('change', redraw, true);
 document.getElementsByTagName('canvas')[0].addEventListener('click', processClick, false);
 redraw();
&lt;/script&gt;</pre>
<!-- http://software.hixie.ch/utilities/js/live-dom-viewer/saved/340 -->

  </div>



  <h6 id="drawing-images-to-the-canvas"><span class="secno">4.8.11.1.13 </span>Drawing images to the canvas</h6><div class="status REC"><p><strong>Implemented and widely deployed</strong></p><p class="idref"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#drawing-images-to-the-canvas">#drawing-images-to-the-canvas</a></p><div class="implementations"><p class="IE NONE" title="Latest Internet Explorer beta: does not support this feature">Latest Internet Explorer beta: unknown</p><p class="Firefox NONE" title="Latest Firefox trunk nightly build: does not support this feature">Latest Firefox trunk nightly build: unknown</p><p class="Safari NONE" title="Latest WebKit or Chromium trunk build: does not support this feature">Latest WebKit or Chromium trunk build: unknown</p><p class="Opera NONE" title="Latest Opera beta or preview build: does not support this feature">Latest Opera beta or preview build: unknown</p><p class="Shims NONE" title="JavaScript libraries, plugins, etc: does not support this feature">JavaScript libraries, plugins, etc: unknown</p></div><p class="last-edit"><a>2012-03-26</a> <a>Hixie</a></p><p class="edit-link"><a href="http://www.whatwg.org/specs/web-apps/current-work/edit-section.html?section=drawing-images-to-the-canvas">Edit this information...</a></p></div>

  <p>To draw images onto the canvas, the <dfn id="dom-context-2d-drawimage" title="dom-context-2d-drawImage"><code>drawImage</code></dfn> method
  can be used.</p>

  <p>This method can be invoked with three different sets of arguments:</p>

  <ul class="brief"><li><code title="">drawImage(<var title="">image</var>, <var title="">dx</var>, <var title="">dy</var>)</code>
   </li><li><code title="">drawImage(<var title="">image</var>, <var title="">dx</var>, <var title="">dy</var>, <var title="">dw</var>, <var title="">dh</var>)</code>
   </li><li><code title="">drawImage(<var title="">image</var>, <var title="">sx</var>, <var title="">sy</var>, <var title="">sw</var>, <var title="">sh</var>, <var title="">dx</var>, <var title="">dy</var>, <var title="">dw</var>, <var title="">dh</var>)</code>
  </li></ul><!-- v3: drawImage() of an ImageData object might make sense (when resizing as well as filtering) - ack Charles Pritchard --><p>Each of those three can take either an
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/embedded-content-1.html#htmlimageelement">HTMLImageElement</a></code>, an <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#htmlcanvaselement">HTMLCanvasElement</a></code>, or
  an <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#htmlvideoelement">HTMLVideoElement</a></code> for the <var title="">image</var>
  argument.</p>

  <dl class="domintro"><dt><var title="">context</var> . <code title="dom-context-2d-drawImage"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-drawimage">drawImage</a></code>(<var title="">image</var>, <var title="">dx</var>, <var title="">dy</var>)</dt>
   <dt><var title="">context</var> . <code title="dom-context-2d-drawImage"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-drawimage">drawImage</a></code>(<var title="">image</var>, <var title="">dx</var>, <var title="">dy</var>, <var title="">dw</var>, <var title="">dh</var>)</dt>
   <dt><var title="">context</var> . <code title="dom-context-2d-drawImage"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-drawimage">drawImage</a></code>(<var title="">image</var>, <var title="">sx</var>, <var title="">sy</var>, <var title="">sw</var>, <var title="">sh</var>, <var title="">dx</var>, <var title="">dy</var>, <var title="">dw</var>, <var title="">dh</var>)</dt>

   <dd>

    <p>Draws the given image onto the canvas. The arguments are
    interpreted as follows:</p>

    <p><img alt="The sx and sy parameters give the x and y coordinates of the source rectangle; the sw and sh arguments give the width and height of the source rectangle; the dx and dy give the x and y coordinates of the destination rectangle; and the dw and dh arguments give the width and height of the destination rectangle." height="356" src="./4.8.11 The canvas element — HTML Standard_files/drawImage.png" width="356"></p>

    <p>If the first argument isn't an <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/embedded-content-1.html#the-img-element">img</a></code>,
    <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code>, or <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#the-video-element">video</a></code> element, throws a
    <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#typemismatcherror">TypeMismatchError</a></code> exception. If the image has no
    image data, throws an <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#invalidstateerror">InvalidStateError</a></code> exception. If
    the one of the source rectangle dimensions is zero, throws an
    <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#indexsizeerror">IndexSizeError</a></code> exception. If the image isn't yet
    fully decoded, then nothing is drawn.</p>

   </dd>

  </dl><div class="impl">

  <p>If not specified, the <var title="">dw</var> and <var title="">dh</var> arguments must default to the values of <var title="">sw</var> and <var title="">sh</var>, interpreted such that
  one CSS pixel in the image is treated as one unit in the canvas
  coordinate space. If the <var title="">sx</var>, <var title="">sy</var>, <var title="">sw</var>, and <var title="">sh</var> arguments are omitted, they must default to 0, 0,
  the image's intrinsic width in image pixels, and the image's
  intrinsic height in image pixels, respectively. If the image has no
  intrinsic dimensions, the <i>concrete object size</i> must be used
  instead, as determined using the CSS "<a href="http://dev.w3.org/csswg/css3-images/#default-sizing">Concrete
  Object Size Resolution</a>" algorithm, with the <i>specified
  size</i> having neither a definite width nor height, nor any
  additional contraints, the object's intrinsic properties being those
  of the <var title="">image</var> argument, and the <i>default object
  size</i> being the size of the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element. <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/references.html#refsCSSIMAGES">[CSSIMAGES]</a></p>

  <p>The <var title="">image</var> argument is an instance of either
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/embedded-content-1.html#htmlimageelement">HTMLImageElement</a></code>, <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#htmlcanvaselement">HTMLCanvasElement</a></code>, or
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#htmlvideoelement">HTMLVideoElement</a></code>.</p> <!-- createPattern() has an
  equivalent paragraph -->

  <p>If the <var title="">image</var> argument is an
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/embedded-content-1.html#htmlimageelement">HTMLImageElement</a></code> object that is not <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/embedded-content-1.html#img-good" title="img-good">fully decodable</a>, or if the <var title="">image</var> argument is an <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#htmlvideoelement">HTMLVideoElement</a></code>
  object whose <code title="dom-media-readyState"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#dom-media-readystate">readyState</a></code>
  attribute is either <code title="dom-media-HAVE_NOTHING"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#dom-media-have_nothing">HAVE_NOTHING</a></code> or <code title="dom-media-HAVE_METADATA"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#dom-media-have_metadata">HAVE_METADATA</a></code>, then the
  implementation must return without drawing anything.</p> <!--
  createPattern() has an equivalent paragraph -->

  <p>If the <var title="">image</var> argument is an
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#htmlcanvaselement">HTMLCanvasElement</a></code> object with either a horizontal
  dimension or a vertical dimension equal to zero, then the
  implementation must throw an <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#invalidstateerror">InvalidStateError</a></code>
  exception.</p>
  <!-- createPattern() has an equivalent paragraph -->

  <p>The source rectangle is the rectangle whose corners are the four
  points (<var title="">sx</var>, <var title="">sy</var>), (<span title=""><var title="">sx</var>+<var title="">sw</var></span>, <var title="">sy</var>), (<span title=""><var title="">sx</var>+<var title="">sw</var></span>, <span title=""><var title="">sy</var>+<var title="">sh</var></span>), (<var title="">sx</var>, <span title=""><var title="">sy</var>+<var title="">sh</var></span>).</p>

  <p>If one of the <var title="">sw</var> or <var title="">sh</var>
  arguments is zero, the implementation must throw an
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#indexsizeerror">IndexSizeError</a></code> exception.</p>

  <p>The destination rectangle is the rectangle whose corners are the
  four points (<var title="">dx</var>, <var title="">dy</var>),
  (<span title=""><var title="">dx</var>+<var title="">dw</var></span>, <var title="">dy</var>), (<span title=""><var title="">dx</var>+<var title="">dw</var></span>, <span title=""><var title="">dy</var>+<var title="">dh</var></span>), (<var title="">dx</var>, <span title=""><var title="">dy</var>+<var title="">dh</var></span>).</p>

  <p>When the source rectangle is outside the source image, it must be
  clipped to the source image, and the destination rectangle must be
  clipped in the same proportion.</p>

  <p>When <code title="dom-context-2d-drawImage"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-drawimage">drawImage()</a></code> is
  invoked, the region of the image specified by the source rectangle
  must be painted on the region of the canvas specified by the
  destination rectangle, after applying the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#transformations" title="dom-context-2d-transformation">current transformation
  matrix</a> to the points of the destination rectangle.</p>

  <p>The original image data of the source image must be used, not the
  image as it is rendered (e.g. <code title="attr-dim-width"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-map-element.html#attr-dim-width">width</a></code> and <code title="attr-dim-height"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-map-element.html#attr-dim-height">height</a></code> attributes on the source
  element have no effect). The image data must be processed in the
  original direction, even if the dimensions given are negative. <!--
  remove that last sentence if it causes confusion. Someone once
  suggested that 5,5,-2,-2 was different than 3,3,2,2; this is trying
  to clarify that this is no the case. --></p>

  <p>If the <code title="dom-context-2d-imageSmoothingEnabled"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-imagesmoothingenabled">imageSmoothingEnabled</a></code>
  attribute is set to true, then the user agent should attempt to
  apply a smoothing algorithm to the image data when it is scaled.
  Otherwise, the image must be rendered using nearest-neighbor
  interpolation.</p>

  <p class="note">This specification does not define the precise
  algorithm to use when scaling an image when the <code title="dom-context-2d-imageSmoothingEnabled"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-imagesmoothingenabled">imageSmoothingEnabled</a></code>
  attribute is set to true.</p>

  <p class="note">When a canvas is drawn onto itself, the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#drawing-model">drawing
  model</a> requires the source to be copied before the image is drawn
  back onto the canvas, so it is possible to copy parts of a canvas
  onto overlapping parts of itself.</p>

  <p>If the original image data is a bitmap image, the value painted
  at a point in the destination rectangle is computed by filtering the
  original image data. The user agent may use any filtering algorithm
  (for example bilinear interpolation or nearest-neighbor). When the
  filtering algorithm requires a pixel value from outside the original
  image data, it must instead use the value from the nearest edge
  pixel. (That is, the filter uses 'clamp-to-edge' behavior.)</p>
  <!-- see CORE-32111 and:
       http://krijnhoetmer.nl/irc-logs/whatwg/20100818#l-737
       http://www.w3.org/Bugs/Public/show_bug.cgi?id=10799#c11
  -->
  <!-- createPattern() has a similar paragraph with different rules -->

  <p>When the <code title="dom-context-2d-drawImage"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-drawimage">drawImage()</a></code> method
  is passed an animated image as its <var title="">image</var>
  argument, the user agent must use the poster frame of the animation,
  or, if there is no poster frame, the first frame of the
  animation.</p>
  <!-- createPattern() has an equivalent paragraph -->

  <p>When the <var title="">image</var> argument is an
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#htmlvideoelement">HTMLVideoElement</a></code>, then the frame at the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#current-playback-position">current
  playback position</a> must be used as the source image, and the
  source image's dimensions must be the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#concept-video-intrinsic-width" title="concept-video-intrinsic-width">intrinsic width</a> and
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#concept-video-intrinsic-height" title="concept-video-intrinsic-height">intrinsic height</a>
  of the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#media-resource">media resource</a> (i.e. after any aspect-ratio
  correction has been applied).</p>
  <!-- createPattern() has an equivalent paragraph -->

  <p>Images are painted without affecting the current path, and are
  subject to <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#shadows" title="shadows">shadow effects</a>, <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-globalalpha" title="dom-context-2d-globalAlpha">global alpha</a>, the
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#clipping-region">clipping region</a>, and <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-globalcompositeoperation" title="dom-context-2d-globalCompositeOperation">global composition
  operators</a>.</p>

  </div>


  <h6 id="hit-regions"><span class="secno">4.8.11.1.14 </span>Hit regions</h6><div class="status LC"><p><strong>Ready for first implementations</strong></p><p class="idref"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-regions">#hit-regions</a></p><div class="implementations"><p class="IE NONE" title="Latest Internet Explorer beta: does not support this feature">Latest Internet Explorer beta: unknown</p><p class="Firefox NONE" title="Latest Firefox trunk nightly build: does not support this feature">Latest Firefox trunk nightly build: unknown</p><p class="Safari NONE" title="Latest WebKit or Chromium trunk build: does not support this feature">Latest WebKit or Chromium trunk build: unknown</p><p class="Opera NONE" title="Latest Opera beta or preview build: does not support this feature">Latest Opera beta or preview build: unknown</p><p class="Shims NONE" title="JavaScript libraries, plugins, etc: does not support this feature">JavaScript libraries, plugins, etc: unknown</p></div><p class="last-edit"><a>2012-03-26</a> <a>Hixie</a></p><p class="edit-link"><a href="http://www.whatwg.org/specs/web-apps/current-work/edit-section.html?section=hit-regions">Edit this information...</a></p></div>

  <p>Each <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element whose <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#primary-context">primary
  context</a> is a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasrenderingcontext2d">CanvasRenderingContext2D</a></code> object
  must have a <dfn id="hit-region-list">hit region list</dfn> associated with its
  bitmap.</p>

  <p>The <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region-list">hit region list</a> is a list of <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region" title="hit
  region">hit regions</a>.</p>

  <p>Each <dfn id="hit-region">hit region</dfn> consists of the following
  information:</p>

  <ul><li><p>A <dfn id="hit-region&#39;s-set-of-pixels" title="hit region&#39;s set of pixels">set of
   pixels</dfn> on the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element's bitmap for which
   this region is responsible.</p></li>

   <li><p>A <dfn id="hit-region&#39;s-bounding-circumference" title="hit region&#39;s bounding circumference">bounding
   circumference</dfn> on the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element's bitmap
   that surrounds the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-set-of-pixels">hit region's set of pixels</a> as they
   stood when it was created.</p></li>

   <li><p>Optionally, a non-empty string representing an <dfn id="hit-region&#39;s-id" title="hit region&#39;s ID">ID</dfn> for distinguishing the region
   from others.</p></li>

   <li><p>Optionally, a reference to another region that acts as the
   <dfn id="hit-region&#39;s-parent" title="hit region&#39;s parent">parent</dfn> for this
   one.</p></li>

   <li><p>A count of regions that have this one as their <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-parent" title="hit region&#39;s parent">parent</a>, known as the <dfn id="hit-region&#39;s-child-count">hit
   region's child count</dfn>.</p></li>

   <li><p>A <dfn id="hit-region&#39;s-cursor-specification" title="hit region&#39;s cursor specification">cursor
   specification</dfn>, in the form of either a CSS cursor value, or
   the string "<code title="">inherit</code>" meaning that the cursor
   of the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-parent">hit region's parent</a>, if any, or of the
   <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element, if not, is to be used
   instead.</p></li>

   <li>

    <p>Optionally, either a <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-control" title="hit region&#39;s
    control">control</a>, or an <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-unbacked-region-description" title="hit region&#39;s unbacked
    region description">unbacked region description</a>.</p>

    <p>A <dfn id="hit-region&#39;s-control" title="hit region&#39;s control">control</dfn> is just a
    reference to an <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#element">Element</a></code> node, to which, in certain
    conditions, the user agent will route events, and from which the
    user agent will determine the state of the hit region for the
    purposes of accessibility tools.</p>

    <p>An <dfn id="hit-region&#39;s-unbacked-region-description" title="hit region&#39;s unbacked region
    description">unbacked region description</dfn> consists of the
    following:</p>

    <ul class="brief"><li><p>Optionally, a <dfn id="hit-region&#39;s-label" title="hit region&#39;s
     label">label</dfn>.</p>

     </li><li><p>An <dfn id="hit-region&#39;s-aria-role" title="hit region&#39;s ARIA role">ARIA role</dfn>,
     which, if the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-unbacked-region-description" title="hit region&#39;s unbacked region
     description">unbacked region description</a> also has a label,
     could be the empty string.</p></li>

    </ul></li>

  </ul><dl class="domintro"><dt><var title="">context</var> . <code title="dom-context-2d-addHitRegion"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-addhitregion">addHitRegion</a></code>(<var title="">options</var>)</dt>

   <dd>

    <p>Adds a hit region to the canvas bitmap. The argument is an
    object with the following members:</p>

    <dl><dt><code title="dom-HitRegionOptions-path">path</code> (default null)

     </dt><dd>A <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">Path</a></code> object that describes the pixels that
     form part of the region. If this member is not provided or is set
     to null, the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#current-default-path">current default path</a> is used
     instead.</dd>
<!--
     <dt><code title="dom-HitRegionOptions-transform">transform</code> (default null)

     <dd>An <code>SVGMatrix</code> object that describes a
     transformation to apply to the path described by the <code
     title="dom-HitRegionOptions-path">path</code> member.</dd>
-->
     <dt><code title="dom-HitRegionOptions-id">id</code> (default empty string)

     </dt><dd>The ID to use for this region. This is used in
     <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#mouseevent">MouseEvent</a></code> events on the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> (<code title="dom-MouseEvent-region"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-mouseevent-region">event.region</a></code>) and as a way
     to reference this region in later calls to <code title="dom-context-2d-addHitRegion"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-addhitregion">addHitRegion()</a></code>.</dd>

     <dt><code title="dom-HitRegionOptions-parentID">parentID</code> (default null)

     </dt><dd>The ID of the parent region, for purposes of navigation by
     accessibility tools and for cursor fallback.</dd>

     <dt><code title="dom-HitRegionOptions-cursor">cursor</code> (default "<code title="">inherit</code>")

     </dt><dd>The cursor to use when the mouse is over this region. The
     value "<code title="">inherit</code>" means to use the cursor for
     the parent region (as specified by the <code title="dom-HitRegionOptions-parentID">parentID</code> member), if
     any, or to use the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element's cursor if the
     region has no parent.</dd>

     <dt><code title="dom-HitRegionOptions-control">control</code> (default null)

     </dt><dd>An element (that is a descendant of the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code>)
     to which events are to be routed, and which accessibility tools
     are to use as a surrogate for describing and interacting with
     this region.</dd>

     <dt><code title="dom-HitRegionOptions-label">label</code> (default null)

     </dt><dd>A text label for accessibility tools to use as a description
     of this region, if there is no control.</dd>

     <dt><code title="dom-HitRegionOptions-role">role</code> (default null)

     </dt><dd>An ARIA role for accessibility tools to use to determine how
     to represent this region, if there is no control.</dd>

    </dl><p>Hit regions can be used for a variety of purposes:</p>

    <ul><li>With an ID, they can make hit detection easier by having the
     user agent check which region the mouse is over and include the
     ID in the mouse events.</li>

     <li>With a control, they can make routing events to DOM elements
     automatic, allowing e.g. clicks on a canvas to automatically
     submit a form via a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-button-element.html#the-button-element">button</a></code> element.</li>

     <li>With a label, they can make it easier for users to explore a
     canvas without seeing it, e.g. by touch on a mobile device.</li>

     <li>With a cursor, they can make it easier for different regions
     of the canvas to have different cursors, with the user agent
     automatically switching between them.</li>

    </ul></dd>

   <dt><var title="">context</var> . <code title="dom-context-2d-removeHitRegion"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-removehitregion">removeHitRegion</a></code>(<var title="">options</var>)</dt>

   <dd>

    <p>Removes a hit region (and all its ancestors) from the canvas
    bitmap. The argument is the ID of a region added using <code title="dom-context-2d-addHitRegion"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-addhitregion">addHitRegion()</a></code>.</p>

    <p>The pixels that were covered by this region and its descendants
    are effectively cleared by this operation, leaving the regions
    non-interactive. In particular, regions that occupied the same
    pixels before the removed regions were added, overlapping them, do
    not resume their previous role.</p>

   </dd>

  </dl><div class="impl">

  <p>A <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region">hit region</a> <var title="">A</var> is an
  <dfn id="ancestor-region">ancestor region</dfn> of a <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region">hit region</a> <var title="">B</var> if <var title="">B</var> has a <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-parent" title="hit
  region&#39;s parent">parent</a> and its <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-parent" title="hit region&#39;s
  parent">parent</a> is either <var title="">A</var> or another
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region">hit region</a> for which <var title="">A</var> is an
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#ancestor-region">ancestor region</a>.</p>

  <p><dfn id="the-region-identified-by-the-id">The region identified by the ID</dfn> <var title="">ID</var> in a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element <var title="">ancestor</var> is the value returned by the following
  algorithm (which can return a <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region">hit region</a> or
  nothing):</p>

  <ol><li><p>If <var title="">ID</var> is null, return nothing and abort
   these steps.</p></li>

   <li><p>Let <var title="">list</var> be the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region-list">hit region
   list</a> associated with <var title="">ancestor</var>'s
   bitmap.</p></li>

   <li><p>If there is a <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region">hit region</a> in <var title="">list</var> whose <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-id" title="hit region&#39;s ID">ID</a>
   is a <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#case-sensitive">case-sensitive</a> match for <var title="">ID</var>,
   then return that <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region">hit region</a> and abort these
   steps.</p></li>

   <li><p>Otherwise, return nothing.</p></li>

  </ol><p><dfn id="the-region-representing-the-control">The region representing the control</dfn> <var title="">control</var> for a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element <var title="">ancestor</var> is the value returned by the following
  algorithm (which can return a <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region">hit region</a> or
  nothing):</p>

  <ol><li><p>If <var title="">control</var> is not a descendant of <var title="">ancestor</var>, then return nothing and abort these
   steps.</p></li>

   <li><p>Let <var title="">list</var> be the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region-list">hit region
   list</a> associated with <var title="">ancestor</var>'s
   bitmap.</p></li>

   <li><p>If there is a <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region">hit region</a> in <var title="">list</var> whose <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-control" title="hit region&#39;s
   control">control</a> is <var title="">control</var>, then
   return that <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region">hit region</a> and abort these
   steps.</p></li>

   <li><p>Otherwise, return nothing.</p></li>

  </ol><p><dfn id="the-control-represented-by-a-region">The control represented by a region</dfn> <var title="">region</var> for a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element <var title="">ancestor</var> is the value returned by the following
  algorithm (which can return an element or nothing):</p>

  <ol><li><p>If <var title="">region</var> has no <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-control" title="hit
   region&#39;s control">control</a>, return nothing and abort these
   steps.</p></li>

   <li><p>Let <var title="">control</var> be <var title="">region</var>'s <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-control" title="hit region&#39;s
   control">control</a>.</p></li>

   <li><p>If <var title="">control</var> is not a descendant of <var title="">ancestor</var>, then return nothing and abort these
   steps.</p></li>

   <li><p>Otherwise, return <var title="">control</var>.</p></li>

  </ol><p><dfn id="the-cursor-for-a-hit-region">The cursor for a hit region</dfn> <var title="">region</var> of a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element <var title="">ancestor</var> is the value returned by the following
  algorithm:</p>

  <ol><li><p><i>Loop</i>: If <var title="">region</var> has a <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-cursor-specification" title="hit region&#39;s cursor specification">cursor
   specification</a> other than "<code title="">inherit</code>",
   then return that <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-cursor-specification">hit region's cursor specification</a>
   and abort these steps.</p></li>

   <li><p>If <var title="">region</var> has a <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-parent" title="hit
   region&#39;s parent">parent</a>, then let <var title="">region</var> be that <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-parent">hit region's parent</a>,
   and return to the step labeled <i>loop</i>.</p></li>

   <li><p>Otherwise, return the used value of the 'cursor' property
   for the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element. <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/references.html#refsCSSUI">[CSSUI]</a></p></li>

  </ol><p><dfn id="the-region-for-a-pixel">The region for a pixel</dfn> <var title="">pixel</var> on a
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element <var title="">ancestor</var> is the
  value returned by the following algorithm (which can return a
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region">hit region</a> or nothing):</p>

  <ol><li><p>Let <var title="">list</var> be the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region-list">hit region
   list</a> associated with <var title="">ancestor</var>'s
   bitmap.</p></li>

   <li><p>If there is a <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region">hit region</a> in <var title="">list</var> whose <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-set-of-pixels" title="hit region&#39;s set of
   pixels">set of pixels</a> contains <var title="">pixel</var>,
   then return that <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region">hit region</a> and abort these
   steps.</p></li>

   <li><p>Otherwise, return nothing.</p></li>

  </ol><p>To <dfn id="clear-regions-that-cover-the-pixels">clear regions that cover the pixels</dfn> <var title="">pixels</var> on a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element <var title="">ancestor</var>, the user agent must run the following
  steps:</p>

  <ol><li><p>Let <var title="">list</var> be the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region-list">hit region
   list</a> associated with <var title="">ancestor</var>'s
   bitmap.</p></li>

   <li><p>Remove all pixels in <var title="">pixels</var> from the
   <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-set-of-pixels" title="hit region&#39;s set of pixels">set of pixels</a> of
   each <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region">hit region</a> in <var title="">list</var>.</p></li>

   <li><p><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#garbage-collect-the-regions">Garbage-collect the regions</a> of <var title="">ancestor</var>.</p></li>

  </ol><p>To <dfn id="garbage-collect-the-regions">garbage-collect the regions</dfn> of a
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element <var title="">ancestor</var>, the user
  agent must run the following steps:</p>

  <ol><li><p>Let <var title="">list</var> be the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region-list">hit region
   list</a> associated with <var title="">ancestor</var>'s
   bitmap.</p></li>

   <li><p><i>Loop</i>: Let <var title="">victim</var> be the first
   <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region">hit region</a> in <var title="">list</var> to have an
   empty <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-set-of-pixels" title="hit region&#39;s set of pixels">set of
   pixels</a> and a zero <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-child-count" title="hit region&#39;s child
   count">child count</a>, if any. If there is no such <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region">hit
   region</a>, abort these steps.</p></li>

   <li><p>If <var title="">victim</var> has a <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-parent" title="hit
   region&#39;s parent">parent</a>, then decrement that <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-child-count">hit
   region's child count</a> by one.</p></li>

   <li><p>Remove <var title="">victim</var> from <var title="">list</var>.</p></li>

   <li><p>Jump back to the step labeled <i>loop</i>.</p></li>

  </ol><p class="note">Adding a new region and calling <code title="dom-context-2d-clearRect"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-clearrect">clearRect()</a></code> are the two ways
  this clearing algorithm can be invoked. Resizing the canvas also
  clears the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region-list">hit region list</a> (since it clears the canvas
  back to its initial state).</p>

  <hr><p>When the <dfn id="dom-context-2d-addhitregion" title="dom-context-2d-addHitRegion"><code>addHitRegion()</code></dfn>
  method is invoked, the user agent must run the following steps:</p>

  <ol><li><p>Let <var title="">arguments</var> be the dictionary object
   provided as the method's argument.</p></li>

   <li><p>If the <var title="">arguments</var> object's <code title="dom-HitRegionOptions-path">path</code> member is not null,
   let <var title="">source path</var> be the <code title="dom-HitRegionOptions-path">path</code> member's value.
   Otherwise, let it be the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasrenderingcontext2d">CanvasRenderingContext2D</a></code>
   object's <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#current-default-path">current default path</a>.</p></li>
<!--
   <li><p>If the <var title="">arguments</var> object's <code
   title="dom-HitRegionOptions-path">path</code> member is null, but
   the <code title="dom-HitRegionOptions-transform">transform</code>
   member is not, then throw a <code>NotSupportedError</code>
   exception and abort these steps.</p></li>

   <li><p>Transform all the coordinates and lines in <var
   title="">source path</var> by the transform matrix given by the
   <var title="">arguments</var> object's <code
   title="dom-HitRegionOptions-transform">transform</code> member, if
   it is not null.</p></li>
-->
   <li><p>Transform all the coordinates and lines in <var title="">source path</var> by the current transform matrix, if the
   <var title="">arguments</var> object's <code title="dom-HitRegionOptions-path">path</code> member is not
   null.</p></li>

   <li><p>If the <var title="">arguments</var> object's <code title="dom-HitRegionOptions-id">id</code> member is the
   empty string, let it be null instead.</p></li>

   <li><p>If the <var title="">arguments</var> object's <code title="dom-HitRegionOptions-id">id</code> member is not null, then
   let <var title="">previous region for this ID</var> be <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-region-identified-by-the-id">the
   region identified by the ID</a> given by the <code title="dom-HitRegionOptions-id">id</code> member's value in this
   <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element, if any. If the <code title="dom-HitRegionOptions-id">id</code> member is null or no such
   region currently exists, let <var title="">previous region for this
   ID</var> be null.</p></li>

   <li><p>If the <var title="">arguments</var> object's <code title="dom-HitRegionOptions-parent">parent</code> member is the
   empty string, let it be null instead.</p></li>

   <li><p>If the <var title="">arguments</var> object's <code title="dom-HitRegionOptions-parent">parent</code> member is not
   null, then let <var title="">parent region</var> be <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-region-identified-by-the-id">the
   region identified by the ID</a> given by the <code title="dom-HitRegionOptions-parent">parent</code> member's value in
   this <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element, if any. If the <code title="dom-HitRegionOptions-parent">parent</code> member is null or
   no such region currently exists, let <var title="">parent
   region</var> be null.</p></li>

   <li><p>If the <var title="">arguments</var> object's <code title="dom-HitRegionOptions-label">label</code> member is the
   empty string, let it be null instead.</p></li>

   <li>

    <p>If any of the following conditions are met, throw a
    <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#notsupportederror">NotSupportedError</a></code> exception and abort these
    steps.</p>

    <ul class="brief"><!--
     <li>The <var title="">arguments</var> object's <code
     title="dom-HitRegionOptions-path">path</code> member is null, but
     its <code title="dom-HitRegionOptions-transform">transform</code>
     member is not.</li>
--><li>The <var title="">arguments</var> object's <code title="dom-HitRegionOptions-control">control</code> and <code title="dom-HitRegionOptions-label">label</code> members are both
     non-null.</li>

     <li>The <var title="">arguments</var> object's <code title="dom-HitRegionOptions-control">control</code> and <code title="dom-HitRegionOptions-role">role</code> members are both
     non-null.</li>

     <li>The <var title="">arguments</var> object's <code title="dom-HitRegionOptions-role">role</code> member's value is
     the empty string, and the <code title="dom-HitRegionOptions-label">label</code> member's value is
     either null or the empty string.</li>

     <li>The <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#path">path</a> <var title="">source path</var>
     describes a shape with no pixels.</li>

     <li>The <var title="">arguments</var> object's <code title="dom-HitRegionOptions-control">control</code> member is not
     null but is neither an <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/text-level-semantics.html#the-a-element">a</a></code> element that
     <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/rendering.html#represents">represents</a> a <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/links.html#hyperlink">hyperlink</a>, a
     <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-button-element.html#the-button-element">button</a></code> element, an <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-input-element.html#the-input-element">input</a></code> element whose
     <code title="attr-input-type"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-input-element.html#attr-input-type">type</a></code> attribute is in one of
     the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/states-of-the-type-attribute.html#checkbox-state-(type=checkbox)" title="attr-input-type-checkbox">Checkbox</a> or
     <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/states-of-the-type-attribute.html#radio-button-state-(type=radio)" title="attr-input-type-radio">Radio Button</a> states,
     nor an <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-input-element.html#the-input-element">input</a></code> element that is a <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/forms.html#concept-button" title="concept-button">button</a>.</li>

     <li>The <var title="">parent region</var> is not null but has a
     <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-control" title="hit region&#39;s control">control</a>.</li>

     <li>The <var title="">previous region for this ID</var> is the
     same <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region">hit region</a> as the <var title="">parent
     region</var>.</li>

     <li>The <var title="">previous region for this ID</var> is an
     <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#ancestor-region">ancestor region</a> of the <var title="">parent
     region</var>.</li>

    </ul></li>

   <li><p>If the <code title="dom-HitRegionOptions-parent">parent</code> member is not
   null but <var title="">parent region</var> is null, then throw a
   <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#notfounderror">NotFoundError</a></code> exception and abort these
   steps.</p></li>

   <li>

    <p>If any of the following conditions are met, throw a
    <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#syntaxerror">SyntaxError</a></code> exception and abort these
    steps.</p>

    <ul class="brief"><li>The <var title="">arguments</var> object's <code title="dom-HitRegionOptions-cursor">cursor</code> member is not
     null but is neither an <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#ascii-case-insensitive">ASCII case-insensitive</a> match
     for the string "<code title="">inherit</code>", nor a valid CSS
     'cursor' property value. <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/references.html#refsCSSUI">[CSSUI]</a></li>

     <li>The <var title="">arguments</var> object's <code title="dom-HitRegionOptions-role">role</code> member is not null
     but its value is not an <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/common-microsyntaxes.html#ordered-set-of-unique-space-separated-tokens">ordered set of unique
     space-separated tokens</a> whose tokens are all
     <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#case-sensitive">case-sensitive</a> matches for names of non-abstract
     WAI-ARIA roles. <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/references.html#refsARIA">[ARIA]</a></li>

    </ul></li>

   <li>

    <p>Let <var title="">region</var> be a newly created <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region">hit
    region</a>, with its information configured as follows:</p>

    <dl><dt><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-set-of-pixels">Hit region's set of pixels</a>

     </dt><dd><p>The pixels contained in <var title="">source path</var>.


     </p></dd><dt><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-bounding-circumference">Hit region's bounding circumference</a>

     </dt><dd><p>A user-agent-defined shape that wraps the pixels contained
     in <var title="">source path</var>. (In the simplest case, this
     can just be the bounding rectangle; this specification allows it
     to be any shape in order to allow other interfaces.)


     </p></dd><dt><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-id">Hit region's ID</a>

     </dt><dd><p>If the <var title="">arguments</var> object's <code title="dom-HitRegionOptions-id">id</code> member is not null: the
     value of the <code title="dom-HitRegionOptions-id">id</code>
     member. Otherwise, <var title="">region</var> has no <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-id" title="hit region&#39;s id">id</a>.


     </p></dd><dt><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-parent">Hit region's parent</a>

     </dt><dd><p>If <var title="">parent region</var> is not null: <var title="">parent region</var>. Otherwise, <var title="">region</var> has no <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-parent" title="hit region&#39;s
     parent">parent</a>.


     </p></dd><dt><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-child-count">Hit region's child count</a>

     </dt><dd><p>Initially zero.


     </p></dd><dt><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-cursor-specification">Hit region's cursor specification</a>

     </dt><dd><p>If <var title="">parent region</var> is not null: <var title="">parent region</var>. Otherwise, <var title="">region</var> has no <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-parent" title="hit region&#39;s
     parent">parent</a>.


     </p></dd><dt><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-control">Hit region's control</a>

     </dt><dd><p>If the <var title="">arguments</var> object's <code title="dom-HitRegionOptions-control">control</code> member is not
     null: the value of the <code title="dom-HitRegionOptions-control">control</code> member.
     Otherwise, <var title="">region</var> has no <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-control" title="hit
     region&#39;s control">control</a>.


     </p></dd><dt><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-label">Hit region's label</a>

     </dt><dd><p>If the <var title="">arguments</var> object's <code title="dom-HitRegionOptions-label">label</code> member is not
     null: the value of the <code title="dom-HitRegionOptions-label">label</code> member.
     Otherwise, <var title="">region</var> has no <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-label" title="hit
     region&#39;s label">label</a>.


     </p></dd><dt><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-aria-role">Hit region's ARIA role</a>

     </dt><dd><p>If the <var title="">arguments</var> object's <code title="dom-HitRegionOptions-role">role</code> member is not null:
     the value of the <code title="dom-HitRegionOptions-role">role</code> member (which might
     be the empty string). Otherwise, if the <var title="">arguments</var> object's <code title="dom-HitRegionOptions-label">label</code> member is not
     null: the empty string. Otherwise, <var title="">region</var> has
     no <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-aria-role" title="hit region&#39;s ARIA role">ARIA role</a>.


    </p></dd></dl></li>

   <li>

    <p>If the <var title="">arguments</var> object's <code title="dom-HitRegionOptions-cursor">cursor</code> member is not
    null, then act as if a CSS rule for the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code>
    element setting its 'cursor' property had been seen, whose value
    was the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-cursor-specification">hit region's cursor specification</a>.</p>

    <p class="note">For example, if the user agent prefetches cursor
    values, this would cause that to happen in response to an
    appropriately-formed <code title="dom-context-2d-addHitRegion"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-addhitregion">addHitRegion()</a></code>
    call.</p>

   </li>

   <li><p>If the <var title="">arguments</var> object's <code title="dom-HitRegionOptions-control">control</code> member is not
   null, then let <var title="">previous region for the control</var>
   be <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-region-representing-the-control">the region representing the control</a> given by the
   <code title="dom-HitRegionOptions-control">control</code> member's
   value for this <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element, if any. If the <code title="dom-HitRegionOptions-control">control</code> member is null
   or no such region currently exists, let <var title="">previous
   region for the control</var> be null.</p></li>

   <!-- the parent region can't have a control, because no region with
   a control can be a parent - we check for that above. Thus, it is
   safe to remove the previous region for the control without worrying
   that our parent is going to be affected.

   It's also safe to remove the previous region with this ID and all
   its descendants, as we know that our parent isn't part of that
   subtree. -->

   <li><p>If there is a <var title="">previous region with this
   control</var>, remove it from the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element's
   <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region-list">hit region list</a>; then, if it had a <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-parent" title="hit
   region&#39;s parent">parent</a> region, decrement that <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-child-count">hit
   region's child count</a> by one.</p></li> <!-- we garbage
   collect the regions below -->

   <li><p>If there is a <var title="">previous region with this
   ID</var>, remove it, and all <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region" title="hit region">hit
   regions</a> for which it is an <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#ancestor-region">ancestor region</a>,
   from the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element's <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region-list">hit region
   list</a>; then, if it had a <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-parent" title="hit region&#39;s
   parent">parent</a> region, decrement that <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-child-count">hit region's
   child count</a> by one.</p></li> <!-- we garbage collect the
   regions below -->

   <li><p>If there is a <var title="">parent region</var>, increment
   its <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-child-count">hit region's child count</a> by one.</p></li>

   <li><p><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#clear-regions-that-cover-the-pixels">Clear regions that cover the pixels</a> in <var title="">region</var>'s <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-set-of-pixels" title="hit region&#39;s set of
   pixels">set of pixels</a> on this <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code>
   element.</p></li> <!-- this is what garbage collects the earlier
   regions -->

   <li><p>Add <var title="">region</var> to the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code>
   element's <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region-list">hit region list</a>.</p></li>

  </ol><p>When the <dfn id="dom-context-2d-removehitregion" title="dom-context-2d-removeHitRegion"><code>removeHitRegion()</code></dfn>
  method is invoked, the user agent must run the following steps:</p>

  <ol><li><p>Let <var title="">region</var> be <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-region-identified-by-the-id">the region
   identified by the ID</a> given by the method's argument in this
   <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element, if any. If no such region currently
   exists, abort these steps.</p></li>

   <li><p>Remove <var title="">region</var>, and all <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region" title="hit
   region">hit regions</a> for which it is an <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#ancestor-region">ancestor
   region</a>, from the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element's <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region-list">hit
   region list</a>; then, if it had a <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-parent" title="hit region&#39;s
   parent">parent</a> region, decrement that <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-child-count">hit region's
   child count</a> by one.</p></li> <!-- we garbage collect the
   regions below -->

   <li><p><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#garbage-collect-the-regions">Garbage-collect the regions</a> of <var title="">ancestor</var>.</p></li>

  </ol></div>

  <hr><p>The <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#mouseevent">MouseEvent</a></code> interface is extended to support hit
  regions:</p>

  <pre class="idl">partial interface <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#mouseevent">MouseEvent</a> {
  readonly attribute DOMString? <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-mouseevent-region" title="dom-MouseEvent-region">region</a>;
};

partial dictionary <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#mouseeventinit">MouseEventInit</a> {
  DOMString? region;
};</pre>

  <dl class="domintro"><dt><var title="">event</var> . <code title="dom-MouseEvent-region"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-mouseevent-region">region</a></code></dt>

   <dd>

    <p>If the mouse was over a <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region">hit region</a>, then this returns the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-id">hit region's ID</a>, if it has one.</p>

    <p>Otherwise, returns null.</p>

   </dd>

  </dl><div class="impl">

  <p>The <dfn id="dom-mouseevent-region" title="dom-MouseEvent-region"><code>region</code></dfn>
  attribute on <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#mouseevent">MouseEvent</a></code> objects must return the value
  it was initialized to. When the object is created, this attribute
  must be initialized to null. It represents the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-id">hit region's
  ID</a> if the mouse was over a hit region when the event was
  fired.</p>

  <p>When a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#mouseevent">MouseEvent</a></code> is to be fired at a
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element by the user agent in response to a
  pointing device action, the user agent must instead follow these
  steps. If these steps say to <i>act as normal</i>, that means that
  the event must be fired as it would have had these requirements not
  been applied.</p>

  <ol><li><p>If the pointing device is not indicating a pixel on the
   <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code>, act as normal and abort these steps.</p></li>

   <li><p>Let <var title="">pixel</var> be the pixel indicated by the
   pointing device.</p></li>

   <li><p>Let <var title="">region</var> be the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region">hit
   region</a> that is <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-region-for-a-pixel" title="the region for a pixel">the
   region for the pixel</a> <var title="">pixel</var> on this
   <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element, if any.</p></li>

   <li><p>If there is no <var title="">region</var>, then act as
   normal and abort these steps.</p></li>

   <li><p>Let <var title="">id</var> be the <var title="">region</var>'s <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-id" title="hit region&#39;s ID">ID</a>, if
   any.</p></li>

   <li><p>If there is an <var title="">id</var>, then initialize the
   event object's <code title="dom-MouseEvent-region"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-mouseevent-region">region</a></code>
   attribute to <var title="">id</var>.</p></li>

   <li><p>Let <var title="">control</var> be the <var title="">region</var>'s <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-control" title="hit region&#39;s
   control">control</a>, if any.</p></li>

   <li><p>If there is a <var title="">control</var>, then target the
   event object at <var title="">control</var> instead of the
   <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element.</p></li>

   <li><p>Continue dispatching the event, but with the updated event
   object and target as given in the above steps.</p></li>

  </ol><hr><p>When a user's pointing device cursor is positioned over a
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element, user agents should render the pointing
  device cursor according to the cursor specification described by
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-cursor-for-a-hit-region" title="the cursor for a hit region">the cursor for the hit
  region</a> that is <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-region-for-a-pixel" title="the region for a pixel">the
  region for the pixel</a> that the pointing device designates.</p>

  <hr><p>User agents are encouraged to make use of the information present
  in a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element's <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region-list">hit region list</a> to
  improve the accessibility of <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> elements.</p>

  <p>Each <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region">hit region</a> should be handled in a fashion
  equivalent to a node in a virtual DOM tree rooted at the
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element. The hierarchy of this virtual DOM tree
  must match the hierarchy of the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region" title="hit region">hit
  regions</a>, as described by the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-parent" title="hit region&#39;s
  parent">parent</a> of each region. Regions without a <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-parent" title="hit region&#39;s parent">parent</a> must be treated as
  children of the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element for the purpose of this
  virtual DOM tree. For each node in such a DOM tree, the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-bounding-circumference">hit
  region's bounding circumference</a> gives the region of the
  screen to use when representing the node (if appropriate).</p>

  <p>The semantics of a <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region">hit region</a> for the purposes of
  this virtual DOM tree are those of the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-control">hit region's
  control</a>, if it has one, or else of a non-interactive element
  whose ARIA role, if any, is that given by the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-aria-role">hit region's
  ARIA role</a>, and whose textual representation, if any, is given
  by the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-label">hit region's label</a>.</p>

  <p>For the purposes of accessibility tools, when an element <var title="">C</var> is a descendant of a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element
  and there is <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-region-representing-the-control" title="the region representing the control">a
  region representing the control</a> <var title="">C</var> for that
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element, then the element's position relative to
  the document should be presented as if it was that region in the
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element's virtual DOM tree.</p>

  <p>The semantics of a <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region">hit region</a> for the purposes of
  this virtual DOM tree are those of the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-control">hit region's
  control</a>, if it has one, or else of a non-interactive element
  whose ARIA role, if any, is that given by the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-aria-role">hit region's
  ARIA role</a>, and whose textual representation, if any, is given
  by the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-label">hit region's label</a>.</p>

  <p class="note">Thus, for instance, a user agent on a touch-screen
  device could provide haptic feedback when the user croses over a
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-bounding-circumference">hit region's bounding circumference</a>, and then read the
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-label">hit region's label</a> to the user. Similarly, a desktop
  user agent with a virtual accessibility focus separate from the
  keyboard input focus could allow the user to navigate through the
  hit regions, using the virtual DOM tree described above to enable
  hierarchical navigation. When an interactive control inside the
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element is focused, if the control has a
  corresponding region, then that <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-region's-bounding-circumference">hit region's bounding
  circumference</a> could be used to determine what area of the
  display to magnify.</p>

  </div>


  <h6 id="pixel-manipulation"><span class="secno">4.8.11.1.15 </span><dfn>Pixel manipulation</dfn></h6><div class="status REC"><p><strong>Implemented and widely deployed</strong></p><p class="idref"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#pixel-manipulation">#pixel-manipulation</a></p><div class="implementations"><p class="IE NONE" title="Latest Internet Explorer beta: does not support this feature">Latest Internet Explorer beta: unknown</p><p class="Firefox BUG" title="Latest Firefox trunk nightly build: has nearly complete support for this feature, but does not yet pass all the relevant test cases">Latest Firefox trunk nightly build: complete but buggy support</p><p class="Safari BUG" title="Latest WebKit or Chromium trunk build: has nearly complete support for this feature, but does not yet pass all the relevant test cases">Latest WebKit or Chromium trunk build: complete but buggy support</p><p class="Opera BUG" title="Latest Opera beta or preview build: has nearly complete support for this feature, but does not yet pass all the relevant test cases">Latest Opera beta or preview build: complete but buggy support</p><p class="Shims NONE" title="JavaScript libraries, plugins, etc: does not support this feature">JavaScript libraries, plugins, etc: unknown</p></div><p class="last-edit"><a>2012-03-26</a> <a>Hixie</a></p><p class="edit-link"><a href="http://www.whatwg.org/specs/web-apps/current-work/edit-section.html?section=pixel-manipulation">Edit this information...</a></p></div>

  <dl class="domintro"><dt><var title="">imagedata</var> = <var title="">context</var> . <code title="dom-context-2d-createImageData"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-createimagedata">createImageData</a></code>(<var title="">sw</var>, <var title="">sh</var>)</dt>

   <dd>

    <p>Returns an <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#imagedata">ImageData</a></code> object with the given
    dimensions. All the pixels in the returned object are transparent
    black.</p>

   </dd>

   <dt><var title="">imagedata</var> = <var title="">context</var> . <code title="dom-context-2d-createImageData"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-createimagedata">createImageData</a></code>(<var title="">imagedata</var>)</dt>

   <dd>

    <p>Returns an <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#imagedata">ImageData</a></code> object with the same
    dimensions as the argument. All the pixels in the returned object
    are transparent black.</p>

   </dd>

   <dt><var title="">imagedata</var> = <var title="">context</var> . <code title="dom-context-2d-createImageDataHD"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-createimagedatahd">createImageDataHD</a></code>(<var title="">sw</var>, <var title="">sh</var>)</dt>

   <dd>

    <p>Returns an <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#imagedata">ImageData</a></code> object whose dimensions equal
    the dimensions given in the arguments, multiplied by the number of
    pixels in the canvas bitmap that correspond to each coordinate
    space unit. All the pixels in the returned object are transparent
    black.</p>

   </dd>

   <dt><var title="">imagedata</var> = <var title="">context</var> . <code title="dom-context-2d-getImageData"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-getimagedata">getImageData</a></code>(<var title="">sx</var>, <var title="">sy</var>, <var title="">sw</var>, <var title="">sh</var>)</dt>

   <dd>

    <p>Returns an <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#imagedata">ImageData</a></code> object containing the image
    data for the given rectangle of the canvas.</p>

    <p>Throws a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#notsupportederror">NotSupportedError</a></code> exception if any of the
    arguments are not finite. Throws an <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#indexsizeerror">IndexSizeError</a></code>
    exception if the either of the width or height arguments are
    zero.</p>

    <p>The data will be returned with one pixel of image data for each
    coordinate space unit on the canvas (ignoring transforms).</p>

   </dd>

   <dt><var title="">imagedata</var> = <var title="">context</var> . <code title="dom-context-2d-getImageDataHD"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-getimagedatahd">getImageDataHD</a></code>(<var title="">sx</var>, <var title="">sy</var>, <var title="">sw</var>, <var title="">sh</var>)</dt>

   <dd>

    <p>Returns an <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#imagedata">ImageData</a></code> object containing the image
    data for the given rectangle of the canvas.</p>

    <p>Throws a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#notsupportederror">NotSupportedError</a></code> exception if any of the
    arguments are not finite. Throws an <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#indexsizeerror">IndexSizeError</a></code>
    exception if the either of the width or height arguments are
    zero.</p>

    <p>The data will be returned at the same resolution as the canvas
    bitmap.</p>

   </dd>

   <dt><var title="">imagedata</var> . <code title="dom-imagedata-width"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-imagedata-width">width</a></code></dt>
   <dt><var title="">imagedata</var> . <code title="dom-imagedata-height"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-imagedata-height">height</a></code></dt>

   <dd>

    <p>Returns the actual dimensions of the data in the
    <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#imagedata">ImageData</a></code> object, in pixels. For objects returned by
    the non-HD variants of the methods in this API, this will
    correspond to the dimensions given to the methods. For the HD
    variants, the number of pixels might be different than the number
    of corresponding coordinate space units.</p>

   </dd>

   <dt><var title="">imagedata</var> . <code title="dom-imagedata-data"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-imagedata-data">data</a></code></dt>

   <dd>

    <p>Returns the one-dimensional array containing the data in RGBA order, as integers in the range 0 to 255.</p>

   </dd>

   <dt><var title="">context</var> . <code title="dom-context-2d-putImageData"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-putimagedata">putImageData</a></code>(<var title="">imagedata</var>, <var title="">dx</var>, <var title="">dy</var> [, <var title="">dirtyX</var>, <var title="">dirtyY</var>, <var title="">dirtyWidth</var>, <var title="">dirtyHeight</var> ])</dt>

   <dd>

    <p>Paints the data from the given <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#imagedata">ImageData</a></code> object
    onto the canvas. If a dirty rectangle is provided, only the pixels
    from that rectangle are painted.</p>

    <p>The <code title="dom-context-2d-globalAlpha"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-globalalpha">globalAlpha</a></code>
    and <code title="dom-context-2d-globalCompositeOperation"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-globalcompositeoperation">globalCompositeOperation</a></code>
    attributes, as well as the shadow attributes, are ignored for the
    purposes of this method call; pixels in the canvas are replaced
    wholesale, with no composition, alpha blending, no shadows,
    etc.</p>

    <p>Throws a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#notsupportederror">NotSupportedError</a></code> exception if any of the
    arguments are not finite.</p>

    <p>Each pixel in the image data is mapped to one coordinate space
    unit on the canvas.</p>

   </dd>

   <dt><var title="">context</var> . <code title="dom-context-2d-putImageDataHD"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-putimagedatahd">putImageDataHD</a></code>(<var title="">imagedata</var>, <var title="">dx</var>, <var title="">dy</var> [, <var title="">dirtyX</var>, <var title="">dirtyY</var>, <var title="">dirtyWidth</var>, <var title="">dirtyHeight</var> ])</dt>

   <dd>

    <p>Paints the data from the given <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#imagedata">ImageData</a></code> object
    onto the canvas, at the canvas bitmap's native resolution. If a
    dirty rectangle is provided, only the pixels from that rectangle
    are painted.</p>

    <p>The <code title="dom-context-2d-globalAlpha"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-globalalpha">globalAlpha</a></code>
    and <code title="dom-context-2d-globalCompositeOperation"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-globalcompositeoperation">globalCompositeOperation</a></code>
    attributes, as well as the shadow attributes, are ignored for the
    purposes of this method call; pixels in the canvas are replaced
    wholesale, with no composition, alpha blending, no shadows,
    etc.</p>

    <p>Throws a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#notsupportederror">NotSupportedError</a></code> exception if any of the
    arguments are not finite.</p>

   </dd>

  </dl><div class="impl">

  <p>The <code title="dom-context-2d-createImageData"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-createimagedata">createImageData()</a></code> and
  <code title="dom-context-2d-createImageDataHD"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-createimagedatahd">createImageDataHD()</a></code>
  methods are used to instantiate new blank <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#imagedata">ImageData</a></code>
  objects.</p>

  <p>When the <dfn id="dom-context-2d-createimagedata" title="dom-context-2d-createImageData"><code>createImageData()</code></dfn>
  method is invoked with two arguments <var title="">sw</var> and <var title="">sh</var>, it must return a new <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#imagedata">ImageData</a></code>
  object representing a rectangle with a width in equal to the
  absolute magnitude of <var title="">sw</var> and a height equal to
  the absolute magnitude of <var title="">sh</var>. When invoked with
  a single <var title="">imagedata</var> argument, it must return a
  new <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#imagedata">ImageData</a></code> object representing a rectangle with the
  same dimensions as the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#imagedata">ImageData</a></code> object passed as the
  argument. The <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#imagedata">ImageData</a></code> object returned must be filled
  with transparent black.</p>

  <p>When the <dfn id="dom-context-2d-createimagedatahd" title="dom-context-2d-createImageDataHD"><code>createImageDataHD()</code></dfn>
  method is invoked (with its two arguments <var title="">sw</var> and
  <var title="">sh</var>) it must return a new <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#imagedata">ImageData</a></code>
  object representing a rectangle with a width in equal to the
  absolute magnitude of <var title="">sw</var> multiplied by <var title="">scale</var> and a height equal to the absolute magnitude of
  <var title="">sh</var> multiplied by <var title="">scale</var>,
  where <var title="">scale</var> is the number of pixels in the
  canvas bitmap per coordinate space units. The <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#imagedata">ImageData</a></code>
  object returned must be filled with transparent black.</p>

  <p>The <dfn id="dom-context-2d-getimagedata" title="dom-context-2d-getImageData"><code>getImageData(<var title="">sx</var>, <var title="">sy</var>, <var title="">sw</var>,
  <var title="">sh</var>)</code></dfn> method must, if either the <var title="">sw</var> or <var title="">sh</var> arguments are zero,
  throw an <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#indexsizeerror">IndexSizeError</a></code> exception; otherwise,
  <!--ADD-TOPIC:Security-->
  if the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element's <i>origin-clean</i> flag is set
  to false, it must throw a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#securityerror">SecurityError</a></code> exception;
  <!--REMOVE-TOPIC:Security-->
  otherwise, it must return an <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#imagedata">ImageData</a></code> object with
  width <var title="">sw</var> and height <var title="">sh</var>
  representing the canvas bitmap for the area of the canvas denoted by
  the rectangle whose corners are the four points (<var title="">sx</var>, <var title="">sy</var>), (<span title=""><var title="">sx</var>+<var title="">sw</var></span>, <var title="">sy</var>), (<span title=""><var title="">sx</var>+<var title="">sw</var></span>, <span title=""><var title="">sy</var>+<var title="">sh</var></span>), (<var title="">sx</var>, <span title=""><var title="">sy</var>+<var title="">sh</var></span>), in
  canvas coordinate space units. If the canvas bitmap does not
  represent each coordinate space unit square using exactly one pixel,
  the value of each pixel in the returned abject must be derived from
  the value(s) of the pixel(s) in the canvas bitmap that correspond to
  the same coordinate. Pixels outside the canvas must be returned as
  transparent black. Pixels must be returned as non-premultiplied
  alpha values.</p>

  <p>The <dfn id="dom-context-2d-getimagedatahd" title="dom-context-2d-getImageDataHD"><code>getImageDataHD(<var title="">sx</var>, <var title="">sy</var>, <var title="">sw</var>,
  <var title="">sh</var>)</code></dfn> method must, if either the <var title="">sw</var> or <var title="">sh</var> arguments are zero,
  throw an <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#indexsizeerror">IndexSizeError</a></code> exception; otherwise,
  <!--ADD-TOPIC:Security-->
  if the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element's <i>origin-clean</i> flag is set
  to false, it must throw a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#securityerror">SecurityError</a></code> exception;
  <!--REMOVE-TOPIC:Security-->
  otherwise, it must return an <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#imagedata">ImageData</a></code> object with
  width <var title="">sw</var> multiplied by <var title="">scale</var>
  and height <var title="">sh</var> multiplied by <var title="">scale</var> representing the canvas bitmap data for the
  area of the canvas denoted by the rectangle whose corners are the
  four points (<var title="">sx</var>, <var title="">sy</var>), (<span title=""><var title="">sx</var>+<var title="">sw</var></span>, <var title="">sy</var>), (<span title=""><var title="">sx</var>+<var title="">sw</var></span>, <span title=""><var title="">sy</var>+<var title="">sh</var></span>), (<var title="">sx</var>, <span title=""><var title="">sy</var>+<var title="">sh</var></span>), in
  canvas coordinate space units. Pixels outside the canvas must be
  returned as transparent black. Pixels must be returned as
  non-premultiplied alpha values.</p>

  <p>New <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#imagedata">ImageData</a></code> objects must be initialized so that
  their <dfn id="dom-imagedata-width" title="dom-imagedata-width"><code>width</code></dfn>
  attribute is set to the number of pixels per row in the image data,
  their <dfn id="dom-imagedata-height" title="dom-imagedata-height"><code>height</code></dfn>
  attribute is set to the number of rows in the image data, and their
  <dfn id="dom-imagedata-data" title="dom-imagedata-data"><code>data</code></dfn> attribute is
  initialized to a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#uint8clampedarray">Uint8ClampedArray</a></code> object. The
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#uint8clampedarray">Uint8ClampedArray</a></code> object must use a <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvas-pixel-arraybuffer">Canvas Pixel
  <code>ArrayBuffer</code></a> for its storage, and must have a
  zero start offset and a length equal to the length of its storage,
  in bytes. The <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvas-pixel-arraybuffer">Canvas Pixel <code>ArrayBuffer</code></a>
  must contain the image data. At least one pixel's worth of image
  data must be returned. <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/references.html#refsTYPEDARRAY">[TYPEDARRAY]</a></p>

  <p>A <dfn id="canvas-pixel-arraybuffer">Canvas Pixel <code>ArrayBuffer</code></dfn> is an
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#arraybuffer">ArrayBuffer</a></code> that whose data is represented in
  left-to-right order, row by row top to bottom, starting with the top
  left, with each pixel's red, green, blue, and alpha components being
  given in that order for each pixel. Each component of each pixel
  represented in this array must be in the range 0..255, representing
  the 8 bit value for that component. The components must be assigned
  consecutive indices starting with 0 for the top left pixel's red
  component. <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/references.html#refsTYPEDARRAY">[TYPEDARRAY]</a></p>

  <p>The <dfn id="dom-context-2d-putimagedata" title="dom-context-2d-putImageData"><code>putImageData()</code></dfn>
  and <dfn id="dom-context-2d-putimagedatahd" title="dom-context-2d-putImageDataHD"><code>putImageDataHD()</code></dfn>
  methods write data from <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#imagedata">ImageData</a></code> structures back to
  the canvas. Their arguments are: <var title="">imagedata</var>, <var title="">dx</var>, <var title="">dy</var>, <var title="">dirtyX</var>, <var title="">dirtyY</var>, <var title="">dirtyWidth</var>, and <var title="">dirtyHeight</var>.</p>

  <p>When the last four arguments to these methods are omitted, they
  must be assumed to have the values 0, 0, the <code title="dom-imagedata-width"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-imagedata-width">width</a></code> member of the <var title="">imagedata</var> structure, and the <code title="dom-imagedata-height"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-imagedata-height">height</a></code> member of the <var title="">imagedata</var> structure, respectively.</p>

  <p>When invoked, these methods must act as follows:</p>

  <ol><li>

    <p>If <var title="">dirtyWidth</var> is negative, let <var title="">dirtyX</var> be <span title=""><var title="">dirtyX</var>+<var title="">dirtyWidth</var></span>, and let <var title="">dirtyWidth</var> be equal to the absolute magnitude of
    <var title="">dirtyWidth</var>.</p>

    <p>If <var title="">dirtyHeight</var> is negative, let <var title="">dirtyY</var> be <span title=""><var title="">dirtyY</var>+<var title="">dirtyHeight</var></span>, and let <var title="">dirtyHeight</var> be equal to the absolute magnitude of
    <var title="">dirtyHeight</var>.</p>

   </li>

   <li>

    <p>If <var title="">dirtyX</var> is negative, let <var title="">dirtyWidth</var> be <span title=""><var title="">dirtyWidth</var>+<var title="">dirtyX</var></span>, and
    let <var title="">dirtyX</var> be zero.</p>

    <p>If <var title="">dirtyY</var> is negative, let <var title="">dirtyHeight</var> be <span title=""><var title="">dirtyHeight</var>+<var title="">dirtyY</var></span>, and
    let <var title="">dirtyY</var> be zero.</p>

   </li>

   <li>

    <p>If <span title=""><var title="">dirtyX</var>+<var title="">dirtyWidth</var></span> is greater than the <code title="dom-imagedata-width"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-imagedata-width">width</a></code> attribute of the <var title="">imagedata</var> argument, let <var title="">dirtyWidth</var> be the value of that <code title="dom-imagedata-width"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-imagedata-width">width</a></code> attribute, minus the
    value of <var title="">dirtyX</var>.</p>

    <p>If <span title=""><var title="">dirtyY</var>+<var title="">dirtyHeight</var></span> is greater than the <code title="dom-imagedata-height"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-imagedata-height">height</a></code> attribute of the <var title="">imagedata</var> argument, let <var title="">dirtyHeight</var> be the value of that <code title="dom-imagedata-height"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-imagedata-height">height</a></code> attribute, minus the
    value of <var title="">dirtyY</var>.</p>

   </li>

   <li>

    <p>If, after those changes, either <var title="">dirtyWidth</var>
    or <var title="">dirtyHeight</var> is negative or zero, stop these
    steps without affecting the canvas.</p>

   </li>

   <li>

    <p>Run the appropriate steps from the following list:</p>

    <dl class="switch"><dt>If the method was <code title="dom-context-2d-putImageData"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-putimagedata">putImageData()</a></code></dt>

     <dd>

      <p>Draw the region of the image data in the horizontal rectangle
      whose top left corner is at (<var title="">dirtyX</var>,<var title="">dirtyY</var>) and whose bottom right corner is at
      (<span title=""><var title="">dirtyX</var>+<var title="">dirtyWidth</var></span>,<span title=""><var title="">dirtyY</var>+<var title="">dirtyHeight</var></span>)
      onto the canvas, aligned such that the top left of the rectangle
      is at coordinate (<var title="">dx</var>,<var title="">dy</var>).</p>

      <p>If the <code title="dom-context-2d-imageSmoothingEnabled"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-imagesmoothingenabled">imageSmoothingEnabled</a></code>
      attribute is set to true, then the user agent should attempt to
      apply a smoothing algorithm to the image data if the canvas does
      not have exactly one device pixel per coordinate space unit in
      the canvas bitmap.</p>

     </dd>

     <dt>If the method was <code title="dom-context-2d-putImageDataHD"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-putimagedatahd">putImageDataHD()</a></code></dt>

     <dd>

      <ol><li>

        <p>Let <var title="">dx<sub>device</sub></var> be the x-coordinate
        of the device pixel in the canvas bitmap corresponding to the <var title="">dx</var> coordinate in the canvas coordinate space.</p>

        <p>Let <var title="">dy<sub>device</sub></var> be the y-coordinate
        of the device pixel in the canvas bitmap corresponding to the <var title="">dy</var> coordinate in the canvas coordinate space.</p>

       </li>

       <li><p>For all integer values of <var title="">x</var>
       and <var title="">y</var> where <span title=""><var title="">dirtyX</var>&nbsp;≤&nbsp;<var title="">x</var>&nbsp;&lt;&nbsp;<span title=""><var title="">dirtyX</var>+<var title="">dirtyWidth</var></span></span>
       and <span title=""><var title="">dirtyY</var>&nbsp;≤&nbsp;<var title="">y</var>&nbsp;&lt;&nbsp;<span title=""><var title="">dirtyY</var>+<var title="">dirtyHeight</var></span></span>, copy the four channels of
       the pixel with coordinate (<var title="">x</var>, <var title="">y</var>) in the <var title="">imagedata</var> data
       structure to the pixel with coordinate (<span title=""><var title="">dx<sub>device</sub></var>+<var title="">x</var></span>,
       <span title=""><var title="">dy<sub>device</sub></var>+<var title="">y</var></span>) in the canvas bitmap of the
       canvas.</p></li>

      </ol></dd>

    </dl></li>

  </ol><p>The handling of pixel rounding when the specified coordinates do
  not exactly map to the device coordinate space is not defined by
  this specification, except that the following must result in no
  visible changes to the rendering:</p>

  <pre>context.putImageDataHD(context.getImageDataHD(x, y, w, h), p, q);</pre>

  <p>...for any value of <var title="">x</var>, <var title="">y</var>,
  <var title="">w</var>, and <var title="">h</var> and where <var title="">p</var> is the smaller of <var title="">x</var> and the sum
  of <var title="">x</var> and <var title="">w</var>, and <var title="">q</var> is the smaller of <var title="">y</var> and the sum
  of <var title="">y</var> and <var title="">h</var>; and except that
  the following two calls:</p>

  <pre>context.createImageData(w, h);
context.getImageData(0, 0, w, h);</pre>

  <p>...must return <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#imagedata">ImageData</a></code> objects with the same
  dimensions as each other, and the following two calls:</p><p>

  </p><pre>context.createImageDataHD(w, h);
context.getImageDataHD(0, 0, w, h);</pre>

  <p>...must also return <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#imagedata">ImageData</a></code> objects with the same
  dimensions as each other, for any value of <var title="">w</var> and
  <var title="">h</var> in both cases. In other words, while user
  agents may round the arguments of these methods so that they map to
  device pixel boundaries, any rounding performed must be performed
  consistently for all of the methods described in this section.</p>

  <p class="note">Due to the lossy nature of converting to and from
  premultiplied alpha color values, pixels that have just been set
  using <code title="dom-context-2d-putImageDataHD"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-putimagedatahd">putImageDataHD()</a></code> might
  be returned to an equivalent <code title="dom-context-2d-getImageDataHD"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-getimagedatahd">getImageDataHD()</a></code> as
  different values.</p>

  <p>The current path, <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#transformations" title="dom-context-2d-transformation">transformation matrix</a>,
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#shadows" title="shadows">shadow attributes</a>, <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-globalalpha" title="dom-context-2d-globalAlpha">global alpha</a>, the
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#clipping-region">clipping region</a>, and <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-globalcompositeoperation" title="dom-context-2d-globalCompositeOperation">global composition
  operator</a> must not affect the methods described in this
  section.</p>

  </div>

  <div class="example">

   <p>In the following example, the script generates an
   <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#imagedata">ImageData</a></code> object so that it can draw onto it.</p>

   <pre>// canvas is a reference to a &lt;canvas&gt; element
var context = canvas.getContext('2d');

// create a blank slate
var data = context.createImageDataHD(canvas.width, canvas.height);

// create some plasma
FillPlasma(data, 'green'); // green plasma

// add a cloud to the plasma
AddCloud(data, data.width/2, data.height/2); // put a cloud in the middle

// paint the plasma+cloud on the canvas
context.putImageDataHD(data, 0, 0);

// support methods
function FillPlasma(data, color) { ... }
function AddCloud(data, x, y) { ... }</pre>

  </div>

  <div class="example">

   <p>Here is an example of using <code title="dom-context-2d-getImageDataHD"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-getimagedatahd">getImageDataHD()</a></code> and
   <code title="dom-context-2d-putImageDataHD"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-putimagedatahd">putImageDataHD()</a></code>
   to implement an edge detection filter.</p>

   <pre>&lt;!DOCTYPE HTML&gt;
&lt;html&gt;
 &lt;head&gt;
  &lt;title&gt;Edge detection demo&lt;/title&gt;
  &lt;script&gt;
   var image = new Image();
   function init() {
     image.onload = demo;
     image.src = "image.jpeg";
   }
   function demo() {
     var canvas = document.getElementsByTagName('canvas')[0];
     var context = canvas.getContext('2d');

     // draw the image onto the canvas
     context.drawImage(image, 0, 0);

     // get the image data to manipulate
     var input = context.getImageDataHD(0, 0, canvas.width, canvas.height);

     // get an empty slate to put the data into
     var output = context.createImageDataHD(canvas.width, canvas.height);

     // alias some variables for convenience
     // notice that we are using input.width and input.height here
     // as they might not be the same as canvas.width and canvas.height
     // (in particular, they might be different on high-res displays)
     var w = input.width, h = input.height;
     var inputData = input.data;
     var outputData = output.data;

     // edge detection
     for (var y = 1; y &lt; h-1; y += 1) {
       for (var x = 1; x &lt; w-1; x += 1) {
         for (var c = 0; c &lt; 3; c += 1) {
           var i = (y*w + x)*4 + c;
           outputData[i] = 127 + -inputData[i - w*4 - 4] -   inputData[i - w*4] - inputData[i - w*4 + 4] +
                                 -inputData[i - 4]       + 8*inputData[i]       - inputData[i + 4] +
                                 -inputData[i + w*4 - 4] -   inputData[i + w*4] - inputData[i + w*4 + 4];
         }
         outputData[(y*w + x)*4 + 3] = 255; // alpha
       }
     }

     // put the image data back after manipulation
     context.putImageDataHD(output, 0, 0);
   }
  &lt;/script&gt;
 &lt;/head&gt;
 &lt;body onload="init()"&gt;
  &lt;canvas&gt;&lt;/canvas&gt;
 &lt;/body&gt;
&lt;/html&gt;</pre>

  </div>




  <h6 id="compositing"><span class="secno">4.8.11.1.16 </span>Compositing</h6><div class="status REC"><p><strong>Implemented and widely deployed</strong></p><p class="idref"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#compositing">#compositing</a></p><div class="implementations"><p class="IE NONE" title="Latest Internet Explorer beta: does not support this feature">Latest Internet Explorer beta: unknown</p><p class="Firefox BUG" title="Latest Firefox trunk nightly build: has nearly complete support for this feature, but does not yet pass all the relevant test cases">Latest Firefox trunk nightly build: complete but buggy support</p><p class="Safari BUG" title="Latest WebKit or Chromium trunk build: has nearly complete support for this feature, but does not yet pass all the relevant test cases">Latest WebKit or Chromium trunk build: complete but buggy support</p><p class="Opera BUG" title="Latest Opera beta or preview build: has nearly complete support for this feature, but does not yet pass all the relevant test cases">Latest Opera beta or preview build: complete but buggy support</p><p class="Shims NONE" title="JavaScript libraries, plugins, etc: does not support this feature">JavaScript libraries, plugins, etc: unknown</p></div><p class="last-edit"><a>2012-03-26</a> <a>Hixie</a></p><p class="edit-link"><a href="http://www.whatwg.org/specs/web-apps/current-work/edit-section.html?section=compositing">Edit this information...</a></p></div>

  <dl class="domintro"><dt><var title="">context</var> . <code title="dom-context-2d-globalAlpha"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-globalalpha">globalAlpha</a></code> [ = <var title="">value</var> ]</dt>

   <dd>

    <p>Returns the current alpha value applied to rendering operations.</p>

    <p>Can be set, to change the alpha value. Values outside of the
    range 0.0 .. 1.0 are ignored.</p>

   </dd>


   <dt><var title="">context</var> . <code title="dom-context-2d-globalCompositeOperation"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-globalcompositeoperation">globalCompositeOperation</a></code> [ = <var title="">value</var> ]</dt>

   <dd>

    <p>Returns the current composition operation, from the list below.</p>

    <p>Can be set, to change the composition operation. Unknown values
    are ignored.</p>

   </dd>

  </dl><div class="impl">

  <p>All drawing operations are affected by the global compositing
  attributes, <code title="dom-context-2d-globalAlpha"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-globalalpha">globalAlpha</a></code> and <code title="dom-context-2d-globalCompositeOperation"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-globalcompositeoperation">globalCompositeOperation</a></code>.</p>

  <!-- conformance criteria for painting are described in the "drawing
  model" section below -->

  <p>The <dfn id="dom-context-2d-globalalpha" title="dom-context-2d-globalAlpha"><code>globalAlpha</code></dfn>
  attribute gives an alpha value that is applied to shapes and images
  before they are composited onto the canvas. The value must be in the
  range from 0.0 (fully transparent) to 1.0 (no additional
  transparency). If an attempt is made to set the attribute to a value
  outside this range, including Infinity and Not-a-Number (NaN)
  values, the attribute must retain its previous value. When the
  context is created, the <code title="dom-context-2d-globalAlpha"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-globalalpha">globalAlpha</a></code> attribute must
  initially have the value 1.0.</p>

  <p>The <dfn id="dom-context-2d-globalcompositeoperation" title="dom-context-2d-globalCompositeOperation"><code>globalCompositeOperation</code></dfn>
  attribute sets how shapes and images are drawn onto the existing
  bitmap, once they have had <code title="dom-context-2d-globalAlpha"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-globalalpha">globalAlpha</a></code> and the
  current transformation matrix applied. It must be set to a value
  from the following list. In the descriptions below, the source
  image, <var title="">A</var>, is the shape or image being rendered,
  and the destination image, <var title="">B</var>, is the current
  state of the bitmap.</p>

  </div>

  <dl><dt><dfn id="gcop-source-atop" title="gcop-source-atop"><code>source-atop</code></dfn></dt>

   <dd><var title="">A</var> atop <var title="">B</var>. <span class="note">Display the
   source image wherever both images are opaque. Display the
   destination image wherever the destination image is opaque but the
   source image is transparent. Display transparency elsewhere.</span></dd>

   <dt><dfn id="gcop-source-in" title="gcop-source-in"><code>source-in</code></dfn></dt>

   <dd><var title="">A</var> in <var title="">B</var>. <span class="note">Display the
   source image wherever both the source image and destination image
   are opaque. Display transparency elsewhere.</span></dd>

   <dt><dfn id="gcop-source-out" title="gcop-source-out"><code>source-out</code></dfn></dt>

   <dd><var title="">A</var> out <var title="">B</var>. <span class="note">Display the
   source image wherever the source image is opaque and the
   destination image is transparent. Display transparency
   elsewhere.</span></dd>

   <dt><dfn id="gcop-source-over" title="gcop-source-over"><code>source-over</code></dfn> (default)</dt>

   <dd><var title="">A</var> over <var title="">B</var>. <span class="note">Display the
   source image wherever the source image is opaque. Display the
   destination image elsewhere.</span></dd>


   <dt><dfn id="gcop-destination-atop" title="gcop-destination-atop"><code>destination-atop</code></dfn></dt>

   <dd><var title="">B</var> atop <var title="">A</var>. <span class="note">Same as <code title="gcop-source-atop"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#gcop-source-atop">source-atop</a></code> but using the
   destination image instead of the source image and vice versa.</span></dd>

   <dt><dfn id="gcop-destination-in" title="gcop-destination-in"><code>destination-in</code></dfn></dt>

   <dd><var title="">B</var> in <var title="">A</var>. <span class="note">Same as <code title="gcop-source-in"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#gcop-source-in">source-in</a></code> but using the destination
   image instead of the source image and vice versa.</span></dd>

   <dt><dfn id="gcop-destination-out" title="gcop-destination-out"><code>destination-out</code></dfn></dt>

   <dd><var title="">B</var> out <var title="">A</var>. <span class="note">Same as <code title="gcop-source-out"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#gcop-source-out">source-out</a></code> but using the destination
   image instead of the source image and vice versa.</span></dd>

   <dt><dfn id="gcop-destination-over" title="gcop-destination-over"><code>destination-over</code></dfn></dt>

   <dd><var title="">B</var> over <var title="">A</var>. <span class="note">Same as <code title="gcop-source-over"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#gcop-source-over">source-over</a></code> but using the
   destination image instead of the source image and vice versa.</span></dd>


<!-- no clear definition of this operator (doesn't correspond to a PorterDuff operator)
   <dt><dfn title="gcop-darker"><code>darker</code></dfn></dt>

   <dd><span class="note">Display the sum of the source image and destination image,
   with color values approaching 0 as a limit.</span></dd>
-->

   <dt><dfn id="gcop-lighter" title="gcop-lighter"><code>lighter</code></dfn></dt>

   <dd><var title="">A</var> plus <var title="">B</var>. <span class="note">Display the
   sum of the source image and destination image, with color values
   approaching 255 (100%) as a limit.</span></dd>


   <dt><dfn id="gcop-copy" title="gcop-copy"><code>copy</code></dfn></dt>

   <dd><var title="">A</var> (<var title="">B</var> is
   ignored). <span class="note">Display the source image instead of the destination
   image.</span></dd>


   <dt><dfn id="gcop-xor" title="gcop-xor"><code>xor</code></dfn></dt>

   <dd><var title="">A</var> xor <var title="">B</var>. <span class="note">Exclusive OR
   of the source image and destination image.</span></dd>


   <dt class="impl"><code><var title="">vendorName</var>-<var title="">operationName</var></code></dt>

   <dd class="impl">Vendor-specific extensions to the list of
   composition operators should use this syntax.</dd>

  </dl><div class="impl">

  <p>The operators in the above list must be treated as described by
  the Porter-Duff operator given at the start of their description
  (e.g. <var title="">A</var> over <var title="">B</var>). They are to
  be applied as part of the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#drawing-model">drawing model</a>, at which point the
  <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#clipping-region">clipping region</a> is also applied. (Without a clipping
  region, these operators act on the whole bitmap with every
  operation.) <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/references.html#refsPORTERDUFF">[PORTERDUFF]</a></p>

  <p>These values are all case-sensitive — they must be used
  exactly as shown. User agents must not recognize values that are not
  a <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#case-sensitive">case-sensitive</a> match for one of the values given
  above.</p>

  <p>On setting, if the user agent does not recognize the specified
  value, it must be ignored, leaving the value of <code title="dom-context-2d-globalCompositeOperation"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-globalcompositeoperation">globalCompositeOperation</a></code>
  unaffected.</p>

  <p>When the context is created, the <code title="dom-context-2d-globalCompositeOperation"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-globalcompositeoperation">globalCompositeOperation</a></code>
  attribute must initially have the value
  <code>source-over</code>.</p>

  </div>



  <h6 id="image-smoothing"><span class="secno">4.8.11.1.17 </span>Image smoothing</h6>

  <dl class="domintro"><dt><var title="">context</var> . <code title="dom-context-2d-imageSmoothingEnabled"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-imagesmoothingenabled">imageSmoothingEnabled</a></code> [ = <var title="">value</var> ]</dt>

   <dd>

    <p>Returns whether pattern fills and the <code title="dom-context-2d-drawImage"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-drawimage">drawImage()</a></code> method will
    attempt to smooth images if they have to rescale them (as opposed
    to just rendering the images with "big pixels").</p>

    <p>Can be set, to change whether images are smoothed (true) or not
    (false).</p>

   </dd>

  </dl><div class="impl">

  <p>The <dfn id="dom-context-2d-imagesmoothingenabled" title="dom-context-2d-imageSmoothingEnabled"><code>imageSmoothingEnabled</code></dfn>
  attribute, on getting, must return the last value it was set to. On
  setting, it must be set to the new value. When the
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvasrenderingcontext2d">CanvasRenderingContext2D</a></code> object is created, the
  attribute must be set to true.</p>

  </div>


  <h6 id="shadows"><span class="secno">4.8.11.1.18 </span><dfn>Shadows</dfn></h6><div class="status REC"><p><strong>Implemented and widely deployed</strong></p><p class="idref"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#shadows">#shadows</a></p><div class="implementations"><p class="IE NONE" title="Latest Internet Explorer beta: does not support this feature">Latest Internet Explorer beta: unknown</p><p class="Firefox BUG" title="Latest Firefox trunk nightly build: has nearly complete support for this feature, but does not yet pass all the relevant test cases">Latest Firefox trunk nightly build: complete but buggy support</p><p class="Safari BUG" title="Latest WebKit or Chromium trunk build: has nearly complete support for this feature, but does not yet pass all the relevant test cases">Latest WebKit or Chromium trunk build: complete but buggy support</p><p class="Opera NONE" title="Latest Opera beta or preview build: does not support this feature">Latest Opera beta or preview build: unknown</p><p class="Shims NONE" title="JavaScript libraries, plugins, etc: does not support this feature">JavaScript libraries, plugins, etc: unknown</p></div><p class="last-edit"><a>2012-03-26</a> <a>Hixie</a></p><p class="edit-link"><a href="http://www.whatwg.org/specs/web-apps/current-work/edit-section.html?section=shadows">Edit this information...</a></p></div>

  <p>All drawing operations are affected by the four global shadow
  attributes.</p>

  <dl class="domintro"><dt><var title="">context</var> . <code title="dom-context-2d-shadowColor"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-shadowcolor">shadowColor</a></code> [ = <var title="">value</var> ]</dt>

   <dd>

    <p>Returns the current shadow color.</p>

    <p>Can be set, to change the shadow color. Values that cannot be parsed as CSS colors are ignored.</p>

   </dd>

   <dt><var title="">context</var> . <code title="dom-context-2d-shadowOffsetX"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-shadowoffsetx">shadowOffsetX</a></code> [ = <var title="">value</var> ]</dt>
   <dt><var title="">context</var> . <code title="dom-context-2d-shadowOffsetY"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-shadowoffsety">shadowOffsetY</a></code> [ = <var title="">value</var> ]</dt>

   <dd>

    <p>Returns the current shadow offset.</p>

    <p>Can be set, to change the shadow offset. Values that are not finite numbers are ignored.</p>

   </dd>

   <dt><var title="">context</var> . <code title="dom-context-2d-shadowBlur"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-shadowblur">shadowBlur</a></code> [ = <var title="">value</var> ]</dt>

   <dd>

    <p>Returns the current level of blur applied to shadows.</p>

    <p>Can be set, to change the blur level. Values that are not finite numbers greater than or equal to zero are ignored.</p>

   </dd>

  </dl><div class="impl">

  <p>The <dfn id="dom-context-2d-shadowcolor" title="dom-context-2d-shadowColor"><code>shadowColor</code></dfn>
  attribute sets the color of the shadow.</p>

  <p>When the context is created, the <code title="dom-context-2d-shadowColor"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-shadowcolor">shadowColor</a></code> attribute
  initially must be fully-transparent black.</p>

  <p>On getting, the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#serialization-of-a-color" title="serialization of a
  color">serialization of the color</a> must be returned.</p>

  <p>On setting, the new value must be <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#parsed-as-a-css-color-value">parsed as a CSS
  &lt;color&gt; value</a> and the color assigned. If the value
  cannot be parsed as a CSS &lt;color&gt; value then it must be
  ignored, and the attribute must retain its previous value. <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/references.html#refsCSSCOLOR">[CSSCOLOR]</a></p>

  <p>The <dfn id="dom-context-2d-shadowoffsetx" title="dom-context-2d-shadowOffsetX"><code>shadowOffsetX</code></dfn>
  and <dfn id="dom-context-2d-shadowoffsety" title="dom-context-2d-shadowOffsetY"><code>shadowOffsetY</code></dfn>
  attributes specify the distance that the shadow will be offset in
  the positive horizontal and positive vertical distance
  respectively. Their values are in coordinate space units. They are
  not affected by the current transformation matrix.</p>

  <p>When the context is created, the shadow offset attributes must
  initially have the value <code>0</code>.</p>

  <p>On getting, they must return their current value. On setting, the
  attribute being set must be set to the new value, except if the
  value is infinite or NaN, in which case the new value must be
  ignored.</p>

  <p>The <dfn id="dom-context-2d-shadowblur" title="dom-context-2d-shadowBlur"><code>shadowBlur</code></dfn>
  attribute specifies the level of the blurring effect. (The units do
  not map to coordinate space units, and are not affected by the
  current transformation matrix.)</p>

  <p>When the context is created, the <code title="dom-context-2d-shadowBlur"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-shadowblur">shadowBlur</a></code> attribute must
  initially have the value <code>0</code>.</p>

  <p>On getting, the attribute must return its current value. On
  setting the attribute must be set to the new value, except if the
  value is negative, infinite or NaN, in which case the new value must
  be ignored.</p>

  <p><dfn id="when-shadows-are-drawn" title="when shadows are drawn">Shadows are only drawn
  if</dfn> the opacity component of the alpha component of the color
  of <code title="dom-context-2d-shadowColor"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-shadowcolor">shadowColor</a></code> is
  non-zero and either the <code title="dom-context-2d-shadowBlur"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-shadowblur">shadowBlur</a></code> is non-zero, or
  the <code title="dom-context-2d-shadowOffsetX"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-shadowoffsetx">shadowOffsetX</a></code>
  is non-zero, or the <code title="dom-context-2d-shadowOffsetY"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-shadowoffsety">shadowOffsetY</a></code> is
  non-zero.</p>

  <p class="critical">It is likely that this will change: browser
  vendors have indicated an interest in changing the processing model
  for shadows such that they only draw when the composition operator
  is "source-over" (the default). <a href="http://lists.whatwg.org/htdig.cgi/whatwg-whatwg.org/2011-May/thread.html#31457">Read
  more...</a></p>

  <p><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#when-shadows-are-drawn">When shadows are drawn</a>, they must be rendered as follows:</p>

  <ol><li> <p>Let <var title="">A</var> be an infinite transparent black
   bitmap on which the source image for which a shadow is being
   created has been rendered.</p> </li>

   <li> <p>Let <var title="">B</var> be an infinite transparent black
   bitmap, with a coordinate space and an origin identical to <var title="">A</var>.</p> </li>

   <li> <p>Copy the alpha channel of <var title="">A</var> to <var title="">B</var>, offset by <code title="dom-context-2d-shadowOffsetX"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-shadowoffsetx">shadowOffsetX</a></code> in the
   positive <var title="">x</var> direction, and <code title="dom-context-2d-shadowOffsetY"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-shadowoffsety">shadowOffsetY</a></code> in the
   positive <var title="">y</var> direction.</p> </li>

   <li> <p>If <code title="dom-context-2d-shadowBlur"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-shadowblur">shadowBlur</a></code> is greater than
   0:</p>

    <ol><li> <p>Let <var title="">σ</var> be half the value of
     <code title="dom-context-2d-shadowBlur"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-shadowblur">shadowBlur</a></code>.</p></li>

     <li> <p>Perform a 2D Gaussian Blur on <var title="">B</var>,
     using <var title="">σ</var> as the standard deviation.</p>
     <!-- wish i could find a reference for this --> </li>

    </ol><p>User agents may limit values of <var title="">σ</var> to
    an implementation-specific maximum value to avoid exceeding
    hardware limitations during the Gaussian blur operation.</p>

   </li>

   <li> <p>Set the red, green, and blue components of every pixel in
   <var title="">B</var> to the red, green, and blue components
   (respectively) of the color of <code title="dom-context-2d-shadowColor"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-shadowcolor">shadowColor</a></code>.</p> </li>

   <li> <p>Multiply the alpha component of every pixel in <var title="">B</var> by the alpha component of the color of <code title="dom-context-2d-shadowColor"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-shadowcolor">shadowColor</a></code>.</p> </li>

   <li> <p>The shadow is in the bitmap <var title="">B</var>, and is
   rendered as part of the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#drawing-model">drawing model</a> described below.</p> </li>

  </ol></div>

  <p>If the current composition operation is <code title="gcop-copy"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#gcop-copy">copy</a></code>, shadows effectively won't render
  (since the shape will overwrite the shadow).</p>



  <div class="impl">

  <h6 id="drawing-model"><span class="secno">4.8.11.1.19 </span><dfn>Drawing model</dfn></h6><div class="status REC"><p><strong>Implemented and widely deployed</strong></p><p class="idref"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#drawing-model">#drawing-model</a></p><div class="implementations"><p class="IE NONE" title="Latest Internet Explorer beta: does not support this feature">Latest Internet Explorer beta: unknown</p><p class="Firefox NONE" title="Latest Firefox trunk nightly build: does not support this feature">Latest Firefox trunk nightly build: unknown</p><p class="Safari NONE" title="Latest WebKit or Chromium trunk build: does not support this feature">Latest WebKit or Chromium trunk build: unknown</p><p class="Opera NONE" title="Latest Opera beta or preview build: does not support this feature">Latest Opera beta or preview build: unknown</p><p class="Shims NONE" title="JavaScript libraries, plugins, etc: does not support this feature">JavaScript libraries, plugins, etc: unknown</p></div><p class="last-edit"><a>2012-03-26</a> <a>Hixie</a></p><p class="edit-link"><a href="http://www.whatwg.org/specs/web-apps/current-work/edit-section.html?section=drawing-model">Edit this information...</a></p></div>

  <p>When a shape or image is painted, user agents must follow these
  steps, in the order given (or act as if they do):</p>

  <ol><li><p>Render the shape or image onto an infinite transparent black
   bitmap, creating image <var title="">A</var>, as described in the
   previous sections. For shapes, the current fill, stroke, and line
   styles must be honored, and the stroke must itself also be
   subjected to the current transformation matrix.</p></li>

   <li><p><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#when-shadows-are-drawn">When shadows are drawn</a>, render the shadow from
   image <var title="">A</var>, using the current shadow styles,
   creating image <var title="">B</var>.</p></li>

   <li><p><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#when-shadows-are-drawn">When shadows are drawn</a>, multiply the alpha
   component of every pixel in <var title="">B</var> by <code title="dom-context-2d-globalAlpha"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-globalalpha">globalAlpha</a></code>.</p></li>

   <li><p><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#when-shadows-are-drawn">When shadows are drawn</a>, composite <var title="">B</var> within the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#clipping-region">clipping region</a> over the
   current canvas bitmap using the current composition
   operator.</p></li>

   <li><p>Multiply the alpha component of every pixel in <var title="">A</var> by <code title="dom-context-2d-globalAlpha"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-globalalpha">globalAlpha</a></code>.</p></li>

   <li><p>Composite <var title="">A</var> within the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#clipping-region">clipping
   region</a> over the current canvas bitmap using the current
   composition operator.</p></li>

  </ol></div>


  <h6 id="best-practices"><span class="secno">4.8.11.1.20 </span>Best practices</h6><div class="status CR"><p><strong>Awaiting implementation feedback</strong></p><p class="idref"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#best-practices">#best-practices</a></p><div class="implementations"><p class="IE NONE" title="Latest Internet Explorer beta: does not support this feature">Latest Internet Explorer beta: unknown</p><p class="Firefox NONE" title="Latest Firefox trunk nightly build: does not support this feature">Latest Firefox trunk nightly build: unknown</p><p class="Safari NONE" title="Latest WebKit or Chromium trunk build: does not support this feature">Latest WebKit or Chromium trunk build: unknown</p><p class="Opera NONE" title="Latest Opera beta or preview build: does not support this feature">Latest Opera beta or preview build: unknown</p><p class="Shims NONE" title="JavaScript libraries, plugins, etc: does not support this feature">JavaScript libraries, plugins, etc: unknown</p></div><p class="last-edit"><a>2011-09-08</a> <a>Hixie</a></p><p class="edit-link"><a href="http://www.whatwg.org/specs/web-apps/current-work/edit-section.html?section=best-practices">Edit this information...</a></p></div>

  <p><i>This section is non-normative.</i></p>

  <p>When a canvas is interactive, authors should include focusable
  elements in the element's fallback content corresponding to each
  focusable part of the canvas, as in the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#drawCustomFocusRingExample">example above</a>.</p>

  <p>To indicate which focusable part of the canvas is currently
  focused, authors should use the <code title="dom-context-2d-drawSystemFocusRing"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-drawsystemfocusring">drawSystemFocusRing()</a></code>
  method, passing it the element for which a ring is being drawn. This
  method only draws the focus ring if the element is focused, so that
  it can simply be called whenever drawing the element, without
  checking whether the element is focused or not first.</p>

  <p>Authors should avoid implementing text editing controls using the
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element. Doing so has a large number of
  disadvantages:</p>

  <ul><li>Mouse placement of the caret has to be reimplemented.</li>

   <li>Keyboard movement of the caret has to be reimplemented (possibly across lines, for multiline text input).</li>

   <li>Scrolling of the text field has to be implemented (horizontally for long lines, vertically for multiline input).</li>

   <li>Native features such as copy-and-paste have to be reimplemented.</li>

   <li>Native features such as spell-checking have to be reimplemented.</li>

   <li>Native features such as drag-and-drop have to be reimplemented.</li>

   <li>Native features such as page-wide text search have to be reimplemented.</li>

   <li>Native features specific to the user, for example custom text
   services, have to be reimplemented. This is close to impossible
   since each user might have different services installed, and there
   is an unbounded set of possible such services.</li>

   <li>Bidirectional text editing has to be reimplemented.</li>

   <li>For multiline text editing, line wrapping has to be implemented for all relevant languages.</li>

   <li>Text selection has to be reimplemented.</li>

   <li>Dragging of bidirectional text selections has to be reimplemented.</li>

   <li>Platform-native keyboard shortcuts have to be reimplemented.</li>

   <li>Platform-native input method editors (IMEs) have to be reimplemented.</li>

   <li>Undo and redo functionality has to be reimplemented.</li>

   <li>Accessibility features such as magnification following the
   caret or selection have to be reimplemented.</li>

  </ul><p>This is a huge amount of work, and authors are most strongly
  encouraged to avoid doing any of it by instead using the
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-input-element.html#the-input-element">input</a></code> element, the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-button-element.html#the-textarea-element">textarea</a></code> element, or
  the <code title="attr-contenteditable"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/editing.html#attr-contenteditable">contenteditable</a></code>
  attribute.</p>


  <h6 id="examples"><span class="secno">4.8.11.1.21 </span>Examples</h6><div class="status LC"><p><strong>Ready for first implementations</strong></p><p class="idref"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#examples">#examples</a></p><div class="implementations"><p class="IE NONE" title="Latest Internet Explorer beta: does not support this feature">Latest Internet Explorer beta: unknown</p><p class="Firefox NONE" title="Latest Firefox trunk nightly build: does not support this feature">Latest Firefox trunk nightly build: unknown</p><p class="Safari NONE" title="Latest WebKit or Chromium trunk build: does not support this feature">Latest WebKit or Chromium trunk build: unknown</p><p class="Opera NONE" title="Latest Opera beta or preview build: does not support this feature">Latest Opera beta or preview build: unknown</p><p class="Shims NONE" title="JavaScript libraries, plugins, etc: does not support this feature">JavaScript libraries, plugins, etc: unknown</p></div><p class="last-edit"><a>2009-10-23</a> <a>Hixie</a></p><p class="edit-link"><a href="http://www.whatwg.org/specs/web-apps/current-work/edit-section.html?section=examples">Edit this information...</a></p></div>

  <p><i>This section is non-normative.</i></p>

  <div class="example">

  <p>Here is an example of a script that uses canvas to draw <a href="data:text/html;charset=utf-8;base64,PCFET0NUWVBFIEhUTUw%2BDQo8aHRtbCBsYW5nPSJlbiI%2BDQogPGhlYWQ%2BDQogIDx0aXRsZT5QcmV0dHkgR2xvd2luZyBMaW5lczwvdGl0bGU%2BDQogPC9oZWFkPg0KIDxib2R5Pg0KPGNhbnZhcyB3aWR0aD0iODAwIiBoZWlnaHQ9IjQ1MCI%2BPC9jYW52YXM%2BDQo8c2NyaXB0Pg0KDQogdmFyIGNvbnRleHQgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnY2FudmFzJylbMF0uZ2V0Q29udGV4dCgnMmQnKTsNCg0KIHZhciBsYXN0WCA9IGNvbnRleHQuY2FudmFzLndpZHRoICogTWF0aC5yYW5kb20oKTsNCiB2YXIgbGFzdFkgPSBjb250ZXh0LmNhbnZhcy5oZWlnaHQgKiBNYXRoLnJhbmRvbSgpOw0KIHZhciBodWUgPSAwOw0KIGZ1bmN0aW9uIGxpbmUoKSB7DQogICBjb250ZXh0LnNhdmUoKTsNCiAgIGNvbnRleHQudHJhbnNsYXRlKGNvbnRleHQuY2FudmFzLndpZHRoLzIsIGNvbnRleHQuY2FudmFzLmhlaWdodC8yKTsNCiAgIGNvbnRleHQuc2NhbGUoMC45LCAwLjkpOw0KICAgY29udGV4dC50cmFuc2xhdGUoLWNvbnRleHQuY2FudmFzLndpZHRoLzIsIC1jb250ZXh0LmNhbnZhcy5oZWlnaHQvMik7DQogICBjb250ZXh0LmJlZ2luUGF0aCgpOw0KICAgY29udGV4dC5saW5lV2lkdGggPSA1ICsgTWF0aC5yYW5kb20oKSAqIDEwOw0KICAgY29udGV4dC5tb3ZlVG8obGFzdFgsIGxhc3RZKTsNCiAgIGxhc3RYID0gY29udGV4dC5jYW52YXMud2lkdGggKiBNYXRoLnJhbmRvbSgpOw0KICAgbGFzdFkgPSBjb250ZXh0LmNhbnZhcy5oZWlnaHQgKiBNYXRoLnJhbmRvbSgpOw0KICAgY29udGV4dC5iZXppZXJDdXJ2ZVRvKGNvbnRleHQuY2FudmFzLndpZHRoICogTWF0aC5yYW5kb20oKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0LmNhbnZhcy5oZWlnaHQgKiBNYXRoLnJhbmRvbSgpLA0KICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQuY2FudmFzLndpZHRoICogTWF0aC5yYW5kb20oKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0LmNhbnZhcy5oZWlnaHQgKiBNYXRoLnJhbmRvbSgpLA0KICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RYLCBsYXN0WSk7DQoNCiAgIGh1ZSA9IGh1ZSArIDEwICogTWF0aC5yYW5kb20oKTsNCiAgIGNvbnRleHQuc3Ryb2tlU3R5bGUgPSAnaHNsKCcgKyBodWUgKyAnLCA1MCUsIDUwJSknOw0KICAgY29udGV4dC5zaGFkb3dDb2xvciA9ICd3aGl0ZSc7DQogICBjb250ZXh0LnNoYWRvd0JsdXIgPSAxMDsNCiAgIGNvbnRleHQuc3Ryb2tlKCk7DQogICBjb250ZXh0LnJlc3RvcmUoKTsNCiB9DQogc2V0SW50ZXJ2YWwobGluZSwgNTApOw0KDQogZnVuY3Rpb24gYmxhbmsoKSB7DQogICBjb250ZXh0LmZpbGxTdHlsZSA9ICdyZ2JhKDAsMCwwLDAuMSknOw0KICAgY29udGV4dC5maWxsUmVjdCgwLCAwLCBjb250ZXh0LmNhbnZhcy53aWR0aCwgY29udGV4dC5jYW52YXMuaGVpZ2h0KTsNCiB9DQogc2V0SW50ZXJ2YWwoYmxhbmssIDQwKTsNCg0KPC9zY3JpcHQ%2BDQogPC9ib2R5Pg0KPC9odG1sPg0K">pretty glowing lines</a>.</p>

  <pre>&lt;canvas width="800" height="450"&gt;&lt;/canvas&gt;
&lt;script&gt;

 var context = document.getElementsByTagName('canvas')[0].getContext('2d');

 var lastX = context.canvas.width * Math.random();
 var lastY = context.canvas.height * Math.random();
 var hue = 0;
 function line() {
   context.save();
   context.translate(context.canvas.width/2, context.canvas.height/2);
   context.scale(0.9, 0.9);
   context.translate(-context.canvas.width/2, -context.canvas.height/2);
   context.beginPath();
   context.lineWidth = 5 + Math.random() * 10;
   context.moveTo(lastX, lastY);
   lastX = context.canvas.width * Math.random();
   lastY = context.canvas.height * Math.random();
   context.bezierCurveTo(context.canvas.width * Math.random(),
                         context.canvas.height * Math.random(),
                         context.canvas.width * Math.random(),
                         context.canvas.height * Math.random(),
                         lastX, lastY);

   hue = hue + 10 * Math.random();
   context.strokeStyle = 'hsl(' + hue + ', 50%, 50%)';
   context.shadowColor = 'white';
   context.shadowBlur = 10;
   context.stroke();
   context.restore();
 }
 setInterval(line, 50);

 function blank() {
   context.fillStyle = 'rgba(0,0,0,0.1)';
   context.fillRect(0, 0, context.canvas.width, context.canvas.height);
 }
 setInterval(blank, 40);

&lt;/script&gt;</pre>

  </div>

  

  </div><!--data-component-->

  <!--2DCONTEXT-->

  <div class="impl">

  <h5 id="color-spaces-and-color-correction"><span class="secno">4.8.11.2 </span>Color spaces and color correction</h5><div class="status LC"><p><strong>Ready for first implementations</strong></p><p class="idref"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#color-spaces-and-color-correction">#color-spaces-and-color-correction</a></p><div class="implementations"><p class="IE NONE" title="Latest Internet Explorer beta: does not support this feature">Latest Internet Explorer beta: unknown</p><p class="Firefox NONE" title="Latest Firefox trunk nightly build: does not support this feature">Latest Firefox trunk nightly build: unknown</p><p class="Safari NONE" title="Latest WebKit or Chromium trunk build: does not support this feature">Latest WebKit or Chromium trunk build: unknown</p><p class="Opera NONE" title="Latest Opera beta or preview build: does not support this feature">Latest Opera beta or preview build: unknown</p><p class="Shims NONE" title="JavaScript libraries, plugins, etc: does not support this feature">JavaScript libraries, plugins, etc: unknown</p></div><p class="last-edit"><a>2009-10-23</a> <a>Hixie</a></p><p class="edit-link"><a href="http://www.whatwg.org/specs/web-apps/current-work/edit-section.html?section=color-spaces-and-color-correction">Edit this information...</a></p></div>

  <p>The <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> APIs must perform color correction at
  only two points: when rendering images with their own gamma
  correction and color space information onto the canvas, to convert
  the image to the color space used by the canvas (e.g. using the 2D
  Context's <code title="dom-context-2d-drawImage"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-drawimage">drawImage()</a></code>
  method with an <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/embedded-content-1.html#htmlimageelement">HTMLImageElement</a></code> object), and when
  rendering the actual canvas bitmap to the output device.</p>

  <p class="note">Thus, in the 2D context, colors used to draw shapes
  onto the canvas will exactly match colors obtained through the <code title="dom-context-2d-getImageDataHD"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-getimagedatahd">getImageDataHD()</a></code>
  method.</p>

  <p>The <code title="dom-canvas-toDataURL"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-canvas-todataurl">toDataURL()</a></code> method
  must not include color space information in the resource returned.
  Where the output format allows it, the color of pixels in resources
  created by <code title="dom-canvas-toDataURL"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-canvas-todataurl">toDataURLHD()</a></code>
  must match those returned by the <code title="dom-context-2d-getImageDataHD"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-getimagedatahd">getImageDataHD()</a></code>
  method.</p>

  <p>In user agents that support CSS, the color space used by a
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element must match the color space used for
  processing any colors for that element in CSS.</p>

  <p>The gamma correction and color space information of images must
  be handled in such a way that an image rendered directly using an
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/embedded-content-1.html#the-img-element">img</a></code> element would use the same colors as one painted on
  a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element that is then itself
  rendered. Furthermore, the rendering of images that have no color
  correction information (such as those returned by the <code title="dom-canvas-toDataURL"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-canvas-todataurl">toDataURL()</a></code> method) must be
  rendered with no color correction.</p>

  <p class="note">Thus, in the 2D context, calling the <code title="dom-context-2d-drawImage"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-drawimage">drawImage()</a></code> method to render
  the output of the <code title="dom-canvas-toDataURL"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-canvas-todataurl">toDataURL()</a></code> method to the
  canvas, given the appropriate dimensions, has no visible effect.</p>

  </div>


<!--ADD-TOPIC:Security-->
  <div class="impl">

  <h5 id="security-with-canvas-elements"><span class="secno">4.8.11.3 </span>Security with <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> elements</h5><div class="status REC"><p><strong>Implemented and widely deployed</strong></p><p class="idref"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#security-with-canvas-elements">#security-with-canvas-elements</a></p><div class="implementations"><p class="IE NONE" title="Latest Internet Explorer beta: does not support this feature">Latest Internet Explorer beta: unknown</p><p class="Firefox NONE" title="Latest Firefox trunk nightly build: does not support this feature">Latest Firefox trunk nightly build: unknown</p><p class="Safari NONE" title="Latest WebKit or Chromium trunk build: does not support this feature">Latest WebKit or Chromium trunk build: unknown</p><p class="Opera NONE" title="Latest Opera beta or preview build: does not support this feature">Latest Opera beta or preview build: unknown</p><p class="Shims NONE" title="JavaScript libraries, plugins, etc: does not support this feature">JavaScript libraries, plugins, etc: unknown</p></div><p class="last-edit"><a>2012-03-26</a> <a>Hixie</a></p><p class="edit-link"><a href="http://www.whatwg.org/specs/web-apps/current-work/edit-section.html?section=security-with-canvas-elements">Edit this information...</a></p></div>

  <p><strong>Information leakage</strong> can occur if scripts from
  one <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/origin-0.html#origin">origin</a> can access information (e.g. read pixels)
  from images from another origin (one that isn't the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/origin-0.html#same-origin" title="same origin">same</a>).</p>

  <p>To mitigate this, <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> elements are defined to
  have a flag indicating whether they are <i>origin-clean</i>. All
  <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> elements must start with their
  <i>origin-clean</i> set to true. The flag must be set to false if
  any of the following actions occur:</p>

  <ul><li><p>The element's 2D context's <code title="dom-context-2d-drawImage"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-drawimage">drawImage()</a></code> method is
   called with an <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/embedded-content-1.html#htmlimageelement">HTMLImageElement</a></code> or an
   <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#htmlvideoelement">HTMLVideoElement</a></code> whose <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/origin-0.html#origin">origin</a> is not the
   <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/origin-0.html#same-origin" title="same origin">same</a> as that of the
   <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/dom.html#document">Document</a></code> object that owns the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code>
   element.</p></li>

   <li><p>The element's 2D context's <code title="dom-context-2d-drawImage"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-drawimage">drawImage()</a></code> method is
   called with an <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#htmlcanvaselement">HTMLCanvasElement</a></code> whose
   <i>origin-clean</i> flag is false.</p></li>

   <li><p>The element's 2D context's <code title="dom-context-2d-fillStyle"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-fillstyle">fillStyle</a></code> attribute is set
   to a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvaspattern">CanvasPattern</a></code> object that was created from an
   <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/embedded-content-1.html#htmlimageelement">HTMLImageElement</a></code> or an <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#htmlvideoelement">HTMLVideoElement</a></code>
   whose <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/origin-0.html#origin">origin</a> was not the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/origin-0.html#same-origin" title="same
   origin">same</a> as that of the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/dom.html#document">Document</a></code> object
   that owns the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element when the pattern was
   created.</p></li>

   <li><p>The element's 2D context's <code title="dom-context-2d-fillStyle"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-fillstyle">fillStyle</a></code> attribute is set
   to a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvaspattern">CanvasPattern</a></code> object that was created from an
   <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#htmlcanvaselement">HTMLCanvasElement</a></code> whose <i>origin-clean</i> flag was
   false when the pattern was created.</p></li>

   <li><p>The element's 2D context's <code title="dom-context-2d-strokeStyle"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-strokestyle">strokeStyle</a></code> attribute is
   set to a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvaspattern">CanvasPattern</a></code> object that was created from an
   <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/embedded-content-1.html#htmlimageelement">HTMLImageElement</a></code> or an <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#htmlvideoelement">HTMLVideoElement</a></code>
   whose <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/origin-0.html#origin">origin</a> was not the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/origin-0.html#same-origin" title="same
   origin">same</a> as that of the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/dom.html#document">Document</a></code> object
   that owns the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code> element when the pattern was
   created.</p></li>

   <li><p>The element's 2D context's <code title="dom-context-2d-strokeStyle"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-strokestyle">strokeStyle</a></code> attribute is
   set to a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#canvaspattern">CanvasPattern</a></code> object that was created from an
   <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#htmlcanvaselement">HTMLCanvasElement</a></code> whose <i>origin-clean</i> flag was
   false when the pattern was created.</p></li>

   <li><p>The element's 2D context's <code title="dom-context-2d-fillText"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-filltext">fillText()</a></code> or <code title="dom-context-2d-fillText"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-filltext">strokeText()</a></code> methods are
   invoked and consider using a font that has an <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/origin-0.html#origin">origin</a>
   that is not the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/origin-0.html#same-origin" title="same origin">same</a> as that of
   the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/dom.html#document">Document</a></code> object that owns the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">canvas</a></code>
   element. (The font doesn't even have to be used; all that matters
   is whether the font was considered for any of the glyphs
   drawn.)</p></li> <!-- because fonts could consider sensitive
   material, I guess; and because that sensitivity could extend to
   whether or not a particular glyph is in the font in the first
   place. -->

  </ul><p>The <code title="dom-canvas-toDataURL"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-canvas-todataurl">toDataURL()</a></code>, <code title="dom-canvas-toDataURLHD"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-canvas-todataurlhd">toDataURLHD()</a></code>, <code title="dom-canvas-toBlob"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-canvas-toblob">toBlob()</a></code>, <code title="dom-context-2d-getImageData"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-getimagedata">getImageData()</a></code>, and <code title="dom-context-2d-getImageDataHD"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-getimagedatahd">getImageDataHD()</a></code>
  methods check the flag and will throw a <code><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#securityerror">SecurityError</a></code>
  exception rather than leak cross-origin data.</p>

  <p class="note">Even resetting the canvas state by changing its
  <code title="attr-canvas-width"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#attr-canvas-width">width</a></code> or <code title="attr-canvas-height"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#attr-canvas-height">height</a></code> attributes doesn't reset
  the <i>origin-clean</i> flag.</p>

  </div>
<!--REMOVE-TOPIC:Security-->


<!--TOPIC:HTML-->
  <div id="configUI"><p id="updatesUI"><label><input type="checkbox" id="updatesEnabled"> Watch for updates</label></p><p class="loginUI"><a href="http://www.whatwg.org/specs/web-apps/current-work/status-documentation.html">Specification annotation system</a>: <input type="button" value="Login..."> <span title=""></span></p><p class="subUI"><input type="button" value="Edit Subscriptions..."></p></div><p id="updatesStatus"></p><script src="./4.8.11 The canvas element — HTML Standard_files/reviewer.js"></script><script src="./4.8.11 The canvas element — HTML Standard_files/updater.js"></script><script src="./4.8.11 The canvas element — HTML Standard_files/dfn.js"></script><script src="./4.8.11 The canvas element — HTML Standard_files/status.js"></script><div id="reviewer" class="on"><input value="➡" id="reviewShowHide" type="button" onclick="toggleReviewMode()"> <span id="reviewSection">Section "head" selected. Comment:</span> <input size="60" id="reviewCommentText" onkeydown="if (event.keyCode == 13) { submitReviewComment(this, this.nextSibling.nextSibling) }"> <input value="Submit Review Comment" type="button" onclick="submitReviewComment(this.previousSibling.previousSibling, this)"> <input value="Help" type="button" onclick="showReviewHelp()"></div><div class="status REC current" hidden=""><p><strong>Implemented and widely deployed</strong></p><p class="idref"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element">#the-canvas-element</a></p><p>Tests: 4 — <a href="http://www.whatwg.org/specs/web-apps/current-work/show-tests.html?section=the-canvas-element">View...</a></p><p>Demos: 1 — <a href="http://www.whatwg.org/specs/web-apps/current-work/show-demos.html?section=the-canvas-element">View...</a></p><div class="implementations"><p class="IE NONE" title="Latest Internet Explorer beta: does not support this feature">Latest Internet Explorer beta: unknown</p><p class="Firefox BUG" title="Latest Firefox trunk nightly build: has nearly complete support for this feature, but does not yet pass all the relevant test cases">Latest Firefox trunk nightly build: complete but buggy support</p><p class="Safari BUG" title="Latest WebKit or Chromium trunk build: has nearly complete support for this feature, but does not yet pass all the relevant test cases">Latest WebKit or Chromium trunk build: complete but buggy support</p><p class="Opera BUG" title="Latest Opera beta or preview build: has nearly complete support for this feature, but does not yet pass all the relevant test cases">Latest Opera beta or preview build: complete but buggy support</p><p class="Shims PARTIAL" title="JavaScript libraries, plugins, etc: has partial support for this feature, but might have bugs and certainly doesn&#39;t support all aspects of this feature">JavaScript libraries, plugins, etc: incomplete support</p></div><p class="last-edit"><a>2012-07-17</a> <a>Ms2ger</a></p><p class="edit-link"><a href="http://www.whatwg.org/specs/web-apps/current-work/edit-section.html?section=the-canvas-element">Edit this information...</a></p></div></body></html>